<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Springboot é¡¹ç›®æ­å»º | Binb&#39;s Blog</title>
<meta name="keywords" content="Spring Boot">
<meta name="description" content="æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½• é¡¹ç›®åˆ†çš„æ¨¡å—ä¸ºï¼š lab-adminé¡¹ç›®æ ¸å¿ƒæ¨¡å— lab-commoné¡¹ç›®é€šç”¨å·¥å…·æ¨¡å— 1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹ ä¸€ã€">
<meta name="author" content="chance7bin">
<link rel="canonical" href="https://chance7bin.github.io/posts/note/springboot-%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.be81eec981a615a87a88f121642d7eebde74d033438693944db2fd6b827284ff.css" integrity="" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.acb54fd32bbc1982428b8850317e45d076b95012730a5936667e6bc21777692a.js" integrity=""
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg">
<link rel="apple-touch-icon" href="https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg">
<link rel="mask-icon" href="https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Springboot é¡¹ç›®æ­å»º" />
<meta property="og:description" content="æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½• é¡¹ç›®åˆ†çš„æ¨¡å—ä¸ºï¼š lab-adminé¡¹ç›®æ ¸å¿ƒæ¨¡å— lab-commoné¡¹ç›®é€šç”¨å·¥å…·æ¨¡å— 1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹ ä¸€ã€" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://chance7bin.github.io/posts/note/springboot-%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-22T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-11-22T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Springboot é¡¹ç›®æ­å»º"/>
<meta name="twitter:description" content="æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½• é¡¹ç›®åˆ†çš„æ¨¡å—ä¸ºï¼š lab-adminé¡¹ç›®æ ¸å¿ƒæ¨¡å— lab-commoné¡¹ç›®é€šç”¨å·¥å…·æ¨¡å— 1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹ ä¸€ã€"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "ğŸ“š æ–‡ç« ",
      "item": "https://chance7bin.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "ğŸ‘¨ğŸ»â€ğŸ’» æˆ‘çš„ç¬”è®°",
      "item": "https://chance7bin.github.io/posts/note/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Springboot é¡¹ç›®æ­å»º",
      "item": "https://chance7bin.github.io/posts/note/springboot-%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Springboot é¡¹ç›®æ­å»º",
  "name": "Springboot é¡¹ç›®æ­å»º",
  "description": "æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½• é¡¹ç›®åˆ†çš„æ¨¡å—ä¸ºï¼š lab-adminé¡¹ç›®æ ¸å¿ƒæ¨¡å— lab-commoné¡¹ç›®é€šç”¨å·¥å…·æ¨¡å— 1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹ ä¸€ã€",
  "keywords": [
    "Spring Boot"
  ],
  "articleBody": "æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½• é¡¹ç›®åˆ†çš„æ¨¡å—ä¸ºï¼š\nlab-adminé¡¹ç›®æ ¸å¿ƒæ¨¡å— lab-commoné¡¹ç›®é€šç”¨å·¥å…·æ¨¡å— 1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹ ä¸€ã€æ–°å»ºä¸€ä¸ªMavenå·¥ç¨‹\näºŒã€å¡«å†™é¡¹ç›®ä¿¡æ¯\nä¸‰ã€åˆ é™¤ä¸€äº›æ–°å»ºMavenå·¥ç¨‹çš„ä¸éœ€è¦çš„æ–‡ä»¶ï¼ˆsrcæ–‡ä»¶å¤¹ï¼‰\nå››ã€åœ¨è¯¥å·¥ç¨‹ä¸‹æ–°å»ºå­Module\näº”ã€å¡«å†™å­Moduleä¿¡æ¯(ä¹Ÿæ˜¯ä¸€ä¸ªMavenå·¥ç¨‹)\næˆæœï¼š\n(å¯¹åº”pom.xmlä¼šè‡ªåŠ¨å†™å¥½å­çˆ¶å¯¹åº”å…³ç³»)\nå…­ã€é‡å¤ç¬¬äº”æ­¥ï¼Œå®Œæˆå…¶ä»–å­Moduleåˆ›å»º\né™¤äº†Moduleåä¸åŒï¼Œå…¶ä»–æ“ä½œéƒ½ä¸€æ ·ã€‚\n2. ç¼–å†™pom.xmlæ–‡ä»¶ çˆ¶çº§pomæ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e ",
  "wordCount" : "24762",
  "inLanguage": "zh",
  "datePublished": "2022-11-22T00:00:00Z",
  "dateModified": "2022-11-22T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "chance7bin"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://chance7bin.github.io/posts/note/springboot-%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Binb's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://chance7bin.github.io/" accesskey="h" title="Binb&#39;s Blog (Alt + H)">
                <img src="https://chance7bin.github.io/img/%E7%BE%8E%E9%98%9F.jpg" alt="" aria-label="logo"
                    height="35">Binb&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://chance7bin.github.io/search" title="ğŸ”æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span>ğŸ”æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://chance7bin.github.io/" title="ğŸ  ä¸»é¡µ">
                    <span>ğŸ  ä¸»é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://chance7bin.github.io/archives/" title="â±ï¸ æ—¶é—´è½´">
                    <span>â±ï¸ æ—¶é—´è½´</span>
                </a>
            </li>
            <li>
                <a href="https://chance7bin.github.io/posts" title="ğŸ“š æ–‡ç« ">
                    <span>ğŸ“š æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://chance7bin.github.io/tags" title="ğŸ”– æ ‡ç­¾">
                    <span>ğŸ”– æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/chance7bin" title="GitHub">
                    <span>GitHub</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://chance7bin.github.io/">ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://chance7bin.github.io/posts/">ğŸ“š æ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://chance7bin.github.io/posts/note/">ğŸ‘¨ğŸ»â€ğŸ’» æˆ‘çš„ç¬”è®°</a></div>
    <h1 class="post-title">
      Springboot é¡¹ç›®æ­å»º
    </h1>
    <div class="post-meta">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">


<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2022-11-22
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>24762å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>50åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>chance7bin
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://chance7bin.github.io/tags/spring-boot/" style="color: var(--secondary)!important;">Spring Boot</a>
            </span>
        </span>
    </span>

    
</span>


      
      
      
      
      
      
      
          
          
          
              
              
              
              
          
      
    </div>
  </header>
   <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">ç›®å½•</span>
            </summary>

            <div class="inner"><ul><ul>
                    <li>
                        <a href="#%e6%96%b0%e5%bb%ba%e5%b7%a5%e7%a8%8b%e5%92%8c%e7%a1%ae%e5%ae%9a%e5%b7%a5%e7%a8%8b%e7%9b%ae%e5%bd%95" aria-label="æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½•">æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½•</a><ul>
                            
                    <li>
                        <a href="#1-%e6%96%b0%e5%bb%ba%e5%b7%a5%e7%a8%8b%e5%8f%8a%e5%a4%9amodule%e5%ad%90%e5%b7%a5%e7%a8%8b" aria-label="1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹">1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹</a></li>
                    <li>
                        <a href="#2-%e7%bc%96%e5%86%99pomxml%e6%96%87%e4%bb%b6" aria-label="2. ç¼–å†™pom.xmlæ–‡ä»¶">2. ç¼–å†™pom.xmlæ–‡ä»¶</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%88%9d%e5%a7%8b%e5%8c%96admin%e6%a8%a1%e5%9d%97" aria-label="åˆå§‹åŒ–adminæ¨¡å—">åˆå§‹åŒ–adminæ¨¡å—</a><ul>
                            
                    <li>
                        <a href="#1-%e6%b7%bb%e5%8a%a0%e4%be%9d%e8%b5%96" aria-label="1. æ·»åŠ ä¾èµ–">1. æ·»åŠ ä¾èµ–</a></li>
                    <li>
                        <a href="#2-%e5%87%86%e5%a4%87%e6%95%b0%e6%8d%ae%e5%ba%93%e8%a1%a8" aria-label="2. å‡†å¤‡æ•°æ®åº“è¡¨">2. å‡†å¤‡æ•°æ®åº“è¡¨</a></li>
                    <li>
                        <a href="#3-%e6%95%b4%e5%90%88mybatis%e7%ad%89%e5%88%9d%e5%a7%8b%e5%8c%96%e9%85%8d%e7%bd%ae" aria-label="3. æ•´åˆmybatisç­‰åˆå§‹åŒ–é…ç½®">3. æ•´åˆmybatisç­‰åˆå§‹åŒ–é…ç½®</a></li>
                    <li>
                        <a href="#4-%e5%88%9b%e5%bb%ba%e5%90%84%e5%b1%82%e6%b5%8b%e8%af%95" aria-label="4. åˆ›å»ºå„å±‚æµ‹è¯•">4. åˆ›å»ºå„å±‚æµ‹è¯•</a></li>
                    <li>
                        <a href="#5-%e5%90%af%e5%8a%a8%e6%97%a5%e5%bf%97" aria-label="5. å¯åŠ¨æ—¥å¿—">5. å¯åŠ¨æ—¥å¿—</a></li>
                    <li>
                        <a href="#6-%e8%af%bb%e5%8f%96%e9%a1%b9%e7%9b%ae%e7%9b%b8%e5%85%b3%e9%85%8d%e7%bd%ae" aria-label="6. è¯»å–é¡¹ç›®ç›¸å…³é…ç½®">6. è¯»å–é¡¹ç›®ç›¸å…³é…ç½®</a></li>
                    <li>
                        <a href="#7-%e7%9b%b4%e6%8e%a5%e6%8b%b7%e8%b4%9dlab-common%e6%95%b4%e4%b8%aa%e6%a8%a1%e5%9d%97%e5%b9%b6%e5%9c%a8admin%e4%b8%ad%e5%bc%95%e5%85%a5" aria-label="7. ç›´æ¥æ‹·è´lab-commonæ•´ä¸ªæ¨¡å—å¹¶åœ¨adminä¸­å¼•å…¥">7. ç›´æ¥æ‹·è´lab-commonæ•´ä¸ªæ¨¡å—å¹¶åœ¨adminä¸­å¼•å…¥</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%ba%bf%e7%a8%8b%e9%85%8d%e7%bd%ae" aria-label="çº¿ç¨‹é…ç½®">çº¿ç¨‹é…ç½®</a></li>
                    <li>
                        <a href="#%e8%b7%a8%e5%9f%9f%e7%99%bb%e5%bd%95%e9%aa%8c%e8%af%81%e5%85%a8%e5%b1%80%e5%bc%82%e5%b8%b8%e9%85%8d%e7%bd%ae" aria-label="è·¨åŸŸã€ç™»å½•éªŒè¯ã€å…¨å±€å¼‚å¸¸é…ç½®">è·¨åŸŸã€ç™»å½•éªŒè¯ã€å…¨å±€å¼‚å¸¸é…ç½®</a></li>
                    <li>
                        <a href="#%e6%95%b4%e5%90%88%e6%97%a5%e5%bf%97%e5%ae%9e%e7%8e%b0" aria-label="æ•´åˆæ—¥å¿—å®ç°">æ•´åˆæ—¥å¿—å®ç°</a><ul>
                            
                    <li>
                        <a href="#1-%e6%b7%bb%e5%8a%a0%e4%be%9d%e8%b5%96-1" aria-label="1. æ·»åŠ ä¾èµ–">1. æ·»åŠ ä¾èµ–</a></li>
                    <li>
                        <a href="#2-%e5%88%9b%e5%bb%ba%e6%95%b0%e6%8d%ae%e5%ba%93%e8%a1%a8" aria-label="2. åˆ›å»ºæ•°æ®åº“è¡¨">2. åˆ›å»ºæ•°æ®åº“è¡¨</a></li>
                    <li>
                        <a href="#3-%e8%87%aa%e5%ae%9a%e4%b9%89%e6%b3%a8%e8%a7%a3log%e5%8f%8a%e7%9b%b8%e5%85%b3%e6%9e%9a%e4%b8%be" aria-label="3. è‡ªå®šä¹‰æ³¨è§£@LogåŠç›¸å…³æšä¸¾">3. è‡ªå®šä¹‰æ³¨è§£@LogåŠç›¸å…³æšä¸¾</a></li>
                    <li>
                        <a href="#4-aop%e5%88%87%e9%9d%a2%e5%a4%84%e7%90%86%e8%af%b7%e6%b1%82%e6%93%8d%e4%bd%9c%e6%97%a5%e5%bf%97" aria-label="4. AOPåˆ‡é¢å¤„ç†è¯·æ±‚æ“ä½œæ—¥å¿—">4. AOPåˆ‡é¢å¤„ç†è¯·æ±‚æ“ä½œæ—¥å¿—</a></li>
                    <li>
                        <a href="#5-aop%e4%bb%a3%e7%90%86%e9%85%8d%e7%bd%ae" aria-label="5. aopä»£ç†é…ç½®">5. aopä»£ç†é…ç½®</a></li>
                    <li>
                        <a href="#5-log4j2%e7%9a%84%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6" aria-label="5. log4j2çš„é…ç½®æ–‡ä»¶">5. log4j2çš„é…ç½®æ–‡ä»¶</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%95%b4%e5%90%88redis%e7%bc%93%e5%ad%98" aria-label="æ•´åˆRedisç¼“å­˜">æ•´åˆRedisç¼“å­˜</a><ul>
                            
                    <li>
                        <a href="#1-%e6%b7%bb%e5%8a%a0%e4%be%9d%e8%b5%96-2" aria-label="1. æ·»åŠ ä¾èµ–">1. æ·»åŠ ä¾èµ–</a></li>
                    <li>
                        <a href="#2-redis%e6%95%b0%e6%8d%ae%e5%ba%93%e8%bf%9e%e6%8e%a5%e4%bf%a1%e6%81%af%e9%85%8d%e7%bd%ae" aria-label="2. Redisæ•°æ®åº“è¿æ¥ä¿¡æ¯é…ç½®">2. Redisæ•°æ®åº“è¿æ¥ä¿¡æ¯é…ç½®</a></li>
                    <li>
                        <a href="#3-%e5%9c%a8redisconfig%e4%b8%ad%e8%87%aa%e5%ae%9a%e4%b9%89redistemplate%e8%a7%a3%e5%86%b3%e5%ba%8f%e5%88%97%e5%8c%96%e9%97%ae%e9%a2%98" aria-label="3. åœ¨RedisConfigä¸­è‡ªå®šä¹‰RedisTemplateè§£å†³åºåˆ—åŒ–é—®é¢˜">3. åœ¨RedisConfigä¸­è‡ªå®šä¹‰RedisTemplateè§£å†³åºåˆ—åŒ–é—®é¢˜</a></li>
                    <li>
                        <a href="#4-%e5%b0%81%e8%a3%85redisutils----redis%e5%b8%b8%e7%94%a8%e5%91%bd%e4%bb%a4%e5%b7%a5%e5%85%b7%e7%b1%bb" aria-label="4. å°è£…RedisUtils &amp;ndash; Rediså¸¸ç”¨å‘½ä»¤å·¥å…·ç±»">4. å°è£…RedisUtils &ndash; Rediså¸¸ç”¨å‘½ä»¤å·¥å…·ç±»</a></li>
                    <li>
                        <a href="#5redis%e6%b5%8b%e8%af%95%e4%bd%bf%e7%94%a8" aria-label="5.Redisæµ‹è¯•ä½¿ç”¨">5.Redisæµ‹è¯•ä½¿ç”¨</a></li>
                    <li>
                        <a href="#6-mybatis%e4%bd%bf%e7%94%a8redis%e5%81%9a%e4%ba%8c%e7%ba%a7%e7%bc%93%e5%ad%98" aria-label="6. Mybatisä½¿ç”¨RedisåšäºŒçº§ç¼“å­˜">6. Mybatisä½¿ç”¨RedisåšäºŒçº§ç¼“å­˜</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%9b%bd%e9%99%85%e5%8c%96%e6%b6%88%e6%81%af%e5%a4%84%e7%90%86" aria-label="å›½é™…åŒ–æ¶ˆæ¯å¤„ç†">å›½é™…åŒ–æ¶ˆæ¯å¤„ç†</a><ul>
                            
                    <li>
                        <a href="#1-%e8%ae%be%e7%bd%ae%e9%a1%b9%e7%9b%ae%e6%96%87%e4%bb%b6%e7%bc%96%e7%a0%81" aria-label="1. è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç ">1. è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç </a></li>
                    <li>
                        <a href="#2-%e6%96%b0%e5%bb%ba%e4%b8%80%e4%b8%aaresourse-bundle" aria-label="2. æ–°å»ºä¸€ä¸ªResourse Bundle">2. æ–°å»ºä¸€ä¸ªResourse Bundle</a></li>
                    <li>
                        <a href="#2-%e5%9b%bd%e9%99%85%e5%8c%96%e5%b7%a5%e5%85%b7%e7%b1%bb" aria-label="2. å›½é™…åŒ–å·¥å…·ç±»">2. å›½é™…åŒ–å·¥å…·ç±»</a></li>
                    <li>
                        <a href="#4-%e6%b5%8b%e8%af%95%e4%bd%bf%e7%94%a8" aria-label="4. æµ‹è¯•ä½¿ç”¨">4. æµ‹è¯•ä½¿ç”¨</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%bb%9f%e4%b8%80%e5%af%b9%e8%b1%a1%e8%bf%94%e5%9b%9e%e5%92%8c%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" aria-label="ç»Ÿä¸€å¯¹è±¡è¿”å›å’Œå¼‚å¸¸å¤„ç†">ç»Ÿä¸€å¯¹è±¡è¿”å›å’Œå¼‚å¸¸å¤„ç†</a><ul>
                            
                    <li>
                        <a href="#1-%e5%ae%9a%e4%b9%89%e7%bb%9f%e4%b8%80%e8%bf%94%e5%9b%9e%e5%af%b9%e8%b1%a1" aria-label="1. å®šä¹‰ç»Ÿä¸€è¿”å›å¯¹è±¡">1. å®šä¹‰ç»Ÿä¸€è¿”å›å¯¹è±¡</a></li>
                    <li>
                        <a href="#2-%e8%87%aa%e5%ae%9a%e4%b9%89%e5%bc%82%e5%b8%b8%e7%b1%bb%e5%8f%8a%e9%94%99%e8%af%af%e7%a0%81%e8%a7%84%e8%8c%83" aria-label="2. è‡ªå®šä¹‰å¼‚å¸¸ç±»åŠé”™è¯¯ç è§„èŒƒ">2. è‡ªå®šä¹‰å¼‚å¸¸ç±»åŠé”™è¯¯ç è§„èŒƒ</a></li>
                    <li>
                        <a href="#3-%e5%85%a8%e5%b1%80%e5%bc%82%e5%b8%b8%e5%a4%84%e7%90%86" aria-label="3. å…¨å±€å¼‚å¸¸å¤„ç†">3. å…¨å±€å¼‚å¸¸å¤„ç†</a></li>
                    <li>
                        <a href="#4-%e5%bc%82%e5%b8%b8%e6%b5%8b%e8%af%95" aria-label="4. å¼‚å¸¸æµ‹è¯•">4. å¼‚å¸¸æµ‹è¯•</a></li></ul>
                    </li>
                    <li>
                        <a href="#mybatias%e5%88%86%e9%a1%b5%e6%94%af%e6%8c%81" aria-label="Mybatiasåˆ†é¡µæ”¯æŒ">Mybatiasåˆ†é¡µæ”¯æŒ</a><ul>
                            
                    <li>
                        <a href="#1-%e5%bc%95%e5%85%a5%e4%be%9d%e8%b5%96" aria-label="1. å¼•å…¥ä¾èµ–">1. å¼•å…¥ä¾èµ–</a></li>
                    <li>
                        <a href="#2-%e9%85%8d%e7%bd%aeyml" aria-label="2. é…ç½®yml">2. é…ç½®yml</a></li>
                    <li>
                        <a href="#3-%e5%b0%81%e8%a3%85%e5%88%86%e9%a1%b5%e7%9b%b8%e5%85%b3%e5%b7%a5%e5%85%b7" aria-label="3. å°è£…åˆ†é¡µç›¸å…³å·¥å…·">3. å°è£…åˆ†é¡µç›¸å…³å·¥å…·</a><ul>
                            
                    <li>
                        <a href="#31-basecontroller" aria-label="3.1 BaseController">3.1 BaseController</a></li>
                    <li>
                        <a href="#32-tabledatainfo" aria-label="3.2 TableDataInfo">3.2 TableDataInfo</a></li>
                    <li>
                        <a href="#33-%e6%95%b0%e6%8d%ae%e4%bc%a0%e8%be%93%e7%b1%bbpagedto" aria-label="3.3 æ•°æ®ä¼ è¾“ç±»PageDTO">3.3 æ•°æ®ä¼ è¾“ç±»PageDTO</a></li></ul>
                    </li>
                    <li>
                        <a href="#4-%e6%b5%8b%e8%af%95" aria-label="4. æµ‹è¯•">4. æµ‹è¯•</a></li></ul>
                    </li>
                    <li>
                        <a href="#swagger%e9%9b%86%e6%88%90" aria-label="Swaggeré›†æˆ">Swaggeré›†æˆ</a><ul>
                            
                    <li>
                        <a href="#1pom%e4%be%9d%e8%b5%96" aria-label="1.pomä¾èµ–">1.pomä¾èµ–</a></li>
                    <li>
                        <a href="#2swagger-config" aria-label="2.swagger config">2.swagger config</a></li>
                    <li>
                        <a href="#3%e4%bd%bf%e7%94%a8" aria-label="3.ä½¿ç”¨">3.ä½¿ç”¨</a></li>
                    <li>
                        <a href="#4%e9%9b%86%e6%88%90knife4j" aria-label="4.é›†æˆKnife4j">4.é›†æˆKnife4j</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e5%8f%82%e6%95%b0%e9%85%8d%e7%bd%ae" aria-label="å‚æ•°é…ç½®">å‚æ•°é…ç½®</a><ul>
                            
                    <li>
                        <a href="#1%e5%88%9b%e5%bb%ba%e6%95%b0%e6%8d%ae%e5%ba%93%e8%a1%a8" aria-label="1.åˆ›å»ºæ•°æ®åº“è¡¨">1.åˆ›å»ºæ•°æ®åº“è¡¨</a></li>
                    <li>
                        <a href="#2%e5%88%9d%e5%a7%8b%e5%8c%96%e5%8f%82%e6%95%b0" aria-label="2.åˆå§‹åŒ–å‚æ•°">2.åˆå§‹åŒ–å‚æ•°</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e7%99%bb%e5%bd%95%e5%92%8c%e6%8e%88%e6%9d%83" aria-label="ç™»å½•å’Œæˆæƒ">ç™»å½•å’Œæˆæƒ</a><ul>
                            
                    <li>
                        <a href="#%e7%99%bb%e5%bd%95%e5%ae%9e%e7%8e%b0" aria-label="ç™»å½•å®ç°">ç™»å½•å®ç°</a><ul>
                            
                    <li>
                        <a href="#1%e5%bc%95%e5%85%a5-spring-security-%e6%a8%a1%e5%9d%97" aria-label="1.å¼•å…¥ Spring Security æ¨¡å—">1.å¼•å…¥ Spring Security æ¨¡å—</a></li>
                    <li>
                        <a href="#2%e7%bc%96%e5%86%99-spring-security-%e9%85%8d%e7%bd%ae%e7%b1%bb" aria-label="2.ç¼–å†™ Spring Security é…ç½®ç±»">2.ç¼–å†™ Spring Security é…ç½®ç±»</a></li>
                    <li>
                        <a href="#3%e9%85%8d%e7%bd%ae%e7%b1%bb%e7%9b%b8%e5%85%b3%e6%a8%a1%e5%9d%97" aria-label="3.é…ç½®ç±»ç›¸å…³æ¨¡å—">3.é…ç½®ç±»ç›¸å…³æ¨¡å—</a></li>
                    <li>
                        <a href="#4%e7%99%bb%e5%bd%95%e6%a8%a1%e5%9d%97" aria-label="4.ç™»å½•æ¨¡å—">4.ç™»å½•æ¨¡å—</a></li>
                    <li>
                        <a href="#5%e7%99%bb%e5%87%ba%e6%a8%a1%e5%9d%97" aria-label="5.ç™»å‡ºæ¨¡å—">5.ç™»å‡ºæ¨¡å—</a></li>
                    <li>
                        <a href="#6%e6%b3%a8%e5%86%8c%e6%a8%a1%e5%9d%97" aria-label="6.æ³¨å†Œæ¨¡å—">6.æ³¨å†Œæ¨¡å—</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e6%8e%88%e6%9d%83%e5%ae%9e%e7%8e%b0" aria-label="æˆæƒå®ç°">æˆæƒå®ç°</a><ul>
                            
                    <li>
                        <a href="#1%e5%88%9b%e5%bb%ba%e6%95%b0%e6%8d%ae%e5%ba%93%e8%a1%a8-1" aria-label="1.åˆ›å»ºæ•°æ®åº“è¡¨">1.åˆ›å»ºæ•°æ®åº“è¡¨</a></li>
                    <li>
                        <a href="#2%e6%9d%83%e9%99%90%e8%bf%87%e6%bb%a4%e5%99%a8" aria-label="2.æƒé™è¿‡æ»¤å™¨">2.æƒé™è¿‡æ»¤å™¨</a></li>
                    <li>
                        <a href="#3%e7%99%bb%e5%bd%95%e6%97%b6%e6%9d%83%e9%99%90%e8%b5%8b%e5%80%bc" aria-label="3.ç™»å½•æ—¶æƒé™èµ‹å€¼">3.ç™»å½•æ—¶æƒé™èµ‹å€¼</a></li>
                    <li>
                        <a href="#4%e6%9d%83%e9%99%90%e6%9f%a5%e8%af%a2mapper" aria-label="4.æƒé™æŸ¥è¯¢Mapper">4.æƒé™æŸ¥è¯¢Mapper</a></li>
                    <li>
                        <a href="#5%e8%87%aa%e5%ae%9a%e4%b9%89%e6%9d%83%e9%99%90%e6%96%b9%e6%b3%95" aria-label="5.è‡ªå®šä¹‰æƒé™æ–¹æ³•">5.è‡ªå®šä¹‰æƒé™æ–¹æ³•</a></li>
                    <li>
                        <a href="#6%e6%8e%a5%e5%8f%a3%e5%ae%9e%e7%8e%b0" aria-label="6.æ¥å£å®ç°">6.æ¥å£å®ç°</a></li></ul>
                    </li></ul>
                    </li>
                    <li>
                        <a href="#%e5%8f%82%e6%95%b0%e6%a0%a1%e9%aa%8c" aria-label="å‚æ•°æ ¡éªŒ">å‚æ•°æ ¡éªŒ</a><ul>
                            
                    <li>
                        <a href="#%e5%8f%82%e6%95%b0%e6%b3%a8%e8%a7%a3%e8%af%b4%e6%98%8e" aria-label="å‚æ•°æ³¨è§£è¯´æ˜">å‚æ•°æ³¨è§£è¯´æ˜</a></li>
                    <li>
                        <a href="#1pomxml" aria-label="1.pom.xml">1.pom.xml</a></li>
                    <li>
                        <a href="#2%e6%a0%a1%e9%aa%8c%e6%b3%a8%e8%a7%a3" aria-label="2.æ ¡éªŒæ³¨è§£">2.æ ¡éªŒæ³¨è§£</a></li>
                    <li>
                        <a href="#3%e5%bc%82%e5%b8%b8%e6%8d%95%e8%8e%b7" aria-label="3.å¼‚å¸¸æ•è·">3.å¼‚å¸¸æ•è·</a></li>
                    <li>
                        <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e6%b3%a8%e8%a7%a3%e6%a0%a1%e9%aa%8c" aria-label="è‡ªå®šä¹‰æ³¨è§£æ ¡éªŒ">è‡ªå®šä¹‰æ³¨è§£æ ¡éªŒ</a></li>
                    <li>
                        <a href="#%e9%98%b2%e9%87%8d%e5%a4%8d%e6%8f%90%e4%ba%a4" aria-label="é˜²é‡å¤æäº¤">é˜²é‡å¤æäº¤</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e8%8f%9c%e5%8d%95%e6%8e%a7%e5%88%b6" aria-label="èœå•æ§åˆ¶">èœå•æ§åˆ¶</a><ul>
                            
                    <li>
                        <a href="#%e6%95%b0%e6%8d%ae%e5%ba%93" aria-label="æ•°æ®åº“">æ•°æ®åº“</a></li></ul>
                    </li></ul>
                        
                    <li>
                        <a href="#%e5%be%ae%e6%9c%8d%e5%8a%a1" aria-label="å¾®æœåŠ¡">å¾®æœåŠ¡</a><ul>
                            
                    <li>
                        <a href="#1%e6%b7%bb%e5%8a%a0%e4%be%9d%e8%b5%96" aria-label="1.æ·»åŠ ä¾èµ–">1.æ·»åŠ ä¾èµ–</a></li>
                    <li>
                        <a href="#2%e9%a1%b9%e7%9b%ae%e9%85%8d%e7%bd%ae" aria-label="2.é¡¹ç›®é…ç½®">2.é¡¹ç›®é…ç½®</a><ul>
                            
                    <li>
                        <a href="#%e6%8b%b7%e8%b4%9d%e9%a1%b9%e7%9b%ae%e5%9f%ba%e7%a1%80%e6%a1%86%e6%9e%b6%e6%96%87%e4%bb%b6%e5%8f%8a%e6%96%87%e4%bb%b6%e5%a4%b9" aria-label="æ‹·è´é¡¹ç›®åŸºç¡€æ¡†æ¶æ–‡ä»¶åŠæ–‡ä»¶å¤¹">æ‹·è´é¡¹ç›®åŸºç¡€æ¡†æ¶æ–‡ä»¶åŠæ–‡ä»¶å¤¹</a></li>
                    <li>
                        <a href="#%e7%ba%bf%e7%a8%8b%e8%b7%a8%e5%9f%9f%e5%85%a8%e5%b1%80%e5%bc%82%e5%b8%b8%e9%85%8d%e7%bd%ae" aria-label="çº¿ç¨‹ã€è·¨åŸŸã€å…¨å±€å¼‚å¸¸é…ç½®">çº¿ç¨‹ã€è·¨åŸŸã€å…¨å±€å¼‚å¸¸é…ç½®</a></li>
                    <li>
                        <a href="#%e6%97%a5%e5%bf%97%e9%85%8d%e7%bd%ae" aria-label="æ—¥å¿—é…ç½®">æ—¥å¿—é…ç½®</a></li>
                    <li>
                        <a href="#%e6%95%b4%e5%90%88mybatis" aria-label="æ•´åˆmybatis">æ•´åˆmybatis</a></li>
                    <li>
                        <a href="#swagger%e9%9b%86%e6%88%90-1" aria-label="Swaggeré›†æˆ">Swaggeré›†æˆ</a></li></ul>
                    </li>
                    <li>
                        <a href="#3%e4%bd%bf%e7%94%a8nacos" aria-label="3.ä½¿ç”¨nacos">3.ä½¿ç”¨nacos</a></li>
                    <li>
                        <a href="#4%e4%bd%bf%e7%94%a8feign" aria-label="4.ä½¿ç”¨feign">4.ä½¿ç”¨feign</a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 && 
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;   
    }
</script>
  <div class="post-content"><h2 id="æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½•">æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½•<a hidden class="anchor" aria-hidden="true" href="#æ–°å»ºå·¥ç¨‹å’Œç¡®å®šå·¥ç¨‹ç›®å½•">#</a></h2>
<p><strong>é¡¹ç›®åˆ†çš„æ¨¡å—ä¸ºï¼š</strong></p>
<ul>
<li><code>lab-admin</code>é¡¹ç›®æ ¸å¿ƒæ¨¡å—</li>
<li><code>lab-common</code>é¡¹ç›®é€šç”¨å·¥å…·æ¨¡å—</li>
</ul>
<h3 id="1-æ–°å»ºå·¥ç¨‹åŠå¤šmoduleå­å·¥ç¨‹">1. æ–°å»ºå·¥ç¨‹åŠå¤šModuleå­å·¥ç¨‹<a hidden class="anchor" aria-hidden="true" href="#1-æ–°å»ºå·¥ç¨‹åŠå¤šmoduleå­å·¥ç¨‹">#</a></h3>
<p><strong>ä¸€ã€æ–°å»ºä¸€ä¸ªMavenå·¥ç¨‹</strong></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348023.png" alt="image-20220823210533909" style="zoom:67%;" /> 
<p><strong>äºŒã€å¡«å†™é¡¹ç›®ä¿¡æ¯</strong></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348022.png" alt="image-20220823210653240" style="zoom:67%;" /> 
<p><strong>ä¸‰ã€åˆ é™¤ä¸€äº›æ–°å»ºMavenå·¥ç¨‹çš„ä¸éœ€è¦çš„æ–‡ä»¶ï¼ˆ<code>srcæ–‡ä»¶å¤¹</code>ï¼‰</strong></p>
<p><strong>å››ã€åœ¨è¯¥å·¥ç¨‹ä¸‹æ–°å»ºå­Module</strong></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348031.png" alt="image-20220823210942582" style="zoom:67%;" />  
<p><strong>äº”ã€å¡«å†™å­Moduleä¿¡æ¯(ä¹Ÿæ˜¯ä¸€ä¸ªMavenå·¥ç¨‹)</strong></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348033.png" alt="image-20220823211018102" style="zoom:67%;" />  
<p>æˆæœï¼š</p>
<p>(å¯¹åº”pom.xmlä¼šè‡ªåŠ¨å†™å¥½å­çˆ¶å¯¹åº”å…³ç³»)</p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348034.png" alt="image-20220823211104847" style="zoom: 67%;" />  
<p><strong>å…­ã€é‡å¤ç¬¬äº”æ­¥ï¼Œå®Œæˆå…¶ä»–å­Moduleåˆ›å»º</strong></p>
<p>é™¤äº†Moduleåä¸åŒï¼Œå…¶ä»–æ“ä½œéƒ½ä¸€æ ·ã€‚</p>
<h3 id="2-ç¼–å†™pomxmlæ–‡ä»¶">2. ç¼–å†™pom.xmlæ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#2-ç¼–å†™pomxmlæ–‡ä»¶">#</a></h3>
<p><strong>çˆ¶çº§pomæ–‡ä»¶</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.opengms<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>opengms<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;description&gt;</span>OpenGMS å®éªŒå®¤<span class="nt">&lt;/description&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;modules&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;module&gt;</span>lab-admin<span class="nt">&lt;/module&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;module&gt;</span>lab-common<span class="nt">&lt;/module&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/modules&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven.compiler.source&gt;</span>8<span class="nt">&lt;/maven.compiler.source&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven.compiler.target&gt;</span>8<span class="nt">&lt;/maven.compiler.target&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;lab.version&gt;</span>1.0.0<span class="nt">&lt;/lab.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;project.reporting.outputEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.reporting.outputEncoding&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven-jar-plugin.version&gt;</span>3.1.1<span class="nt">&lt;/maven-jar-plugin.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;druid.version&gt;</span>1.2.11<span class="nt">&lt;/druid.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;bitwalker.version&gt;</span>1.21<span class="nt">&lt;/bitwalker.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;swagger.version&gt;</span>3.0.0<span class="nt">&lt;/swagger.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;kaptcha.version&gt;</span>2.3.2<span class="nt">&lt;/kaptcha.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;mybatis-spring-boot.version&gt;</span>2.2.2<span class="nt">&lt;/mybatis-spring-boot.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;pagehelper.boot.version&gt;</span>1.4.3<span class="nt">&lt;/pagehelper.boot.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;fastjson.version&gt;</span>2.0.9<span class="nt">&lt;/fastjson.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;oshi.version&gt;</span>6.2.1<span class="nt">&lt;/oshi.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;commons.io.version&gt;</span>2.11.0<span class="nt">&lt;/commons.io.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;commons.fileupload.version&gt;</span>1.4<span class="nt">&lt;/commons.fileupload.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;commons.collections.version&gt;</span>3.2.2<span class="nt">&lt;/commons.collections.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;poi.version&gt;</span>4.1.2<span class="nt">&lt;/poi.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;velocity.version&gt;</span>2.3<span class="nt">&lt;/velocity.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;jwt.version&gt;</span>0.9.1<span class="nt">&lt;/jwt.version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- ä¾èµ–å£°æ˜ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- SpringBootçš„ä¾èµ–é…ç½®--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>2.5.14<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- SpringBooté›†æˆmybatisæ¡†æ¶ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- pagehelperä¾èµ–åŒ…å«äº†mybatisçš„ä¾èµ– --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--    &lt;version&gt;${mybatis-spring-boot.version}&lt;/version&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${pagehelper.boot.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- é˜¿é‡ŒJSONè§£æå™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.alibaba.fastjson2<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>fastjson2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${fastjson.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- ioå¸¸ç”¨å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>commons-io<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>commons-io<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${commons.io.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- æ–‡ä»¶ä¸Šä¼ å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>commons-fileupload<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>commons-fileupload<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${commons.fileupload.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- excelå·¥å…· --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.apache.poi<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>poi-ooxml<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${poi.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- Tokenç”Ÿæˆä¸è§£æ--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>io.jsonwebtoken<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>jjwt<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${jwt.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- è§£æå®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨ç­‰ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>eu.bitwalker<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>UserAgentUtils<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${bitwalker.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- é˜¿é‡Œæ•°æ®åº“è¿æ¥æ±  --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.alibaba<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>druid-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${druid.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- éªŒè¯ç  --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.github.penggle<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>kaptcha<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${kaptcha.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- è·å–ç³»ç»Ÿä¿¡æ¯ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.github.oshi<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>oshi-core<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${oshi.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--ç¼–è¯‘åŠæ‰“åŒ…é¡¹ç›®é…ç½®--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>3.1<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;source&gt;</span>${java.version}<span class="nt">&lt;/source&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;target&gt;</span>${java.version}<span class="nt">&lt;/target&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;encoding&gt;</span>${project.build.sourceEncoding}<span class="nt">&lt;/encoding&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- ä¸æ‰§è¡Œå•å…ƒæµ‹è¯•ï¼Œä½†ä¼šç¼–è¯‘æµ‹è¯•ç±»å¹¶åœ¨target/test-classesç›®å½•ä¸‹ç”Ÿæˆç›¸åº”çš„class --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>maven-surefire-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>2.22.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;skipTests&gt;</span>true<span class="nt">&lt;/skipTests&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/build&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--ä¾èµ–ä¸‹è½½é•œåƒæº--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;repositories&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;repository&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;id&gt;</span>public<span class="nt">&lt;/id&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;name&gt;</span>aliyun nexus<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;url&gt;</span>https://maven.aliyun.com/repository/public<span class="nt">&lt;/url&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;releases&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;enabled&gt;</span>true<span class="nt">&lt;/enabled&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/releases&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/repository&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/repositories&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--æ’ä»¶é•œåƒæº--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;pluginRepositories&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;pluginRepository&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;id&gt;</span>public<span class="nt">&lt;/id&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;name&gt;</span>aliyun nexus<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;url&gt;</span>https://maven.aliyun.com/repository/public<span class="nt">&lt;/url&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;releases&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;enabled&gt;</span>true<span class="nt">&lt;/enabled&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/releases&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;snapshots&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;enabled&gt;</span>false<span class="nt">&lt;/enabled&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/snapshots&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/pluginRepository&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/pluginRepositories&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/project&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>æ³¨æ„ç‚¹ï¼š</strong></p>
<p>**ä¸€ã€**Mavenä¸­çš„<code>&lt;dependencyManagement&gt;</code>å…ƒç´ æä¾›äº†ä¸€ç§ç®¡ç†ä¾èµ–ç‰ˆæœ¬å·çš„æ–¹å¼ã€‚åœ¨<code>&lt;dependencyManagement&gt;</code>å…ƒç´ ä¸­å£°æ˜æ‰€ä¾èµ–çš„jaråŒ…çš„ç‰ˆæœ¬å·ç­‰ä¿¡æ¯ï¼Œé‚£ä¹ˆæ‰€æœ‰å­é¡¹ç›®å†æ¬¡å¼•å…¥æ­¤ä¾èµ–jaråŒ…æ—¶åˆ™æ— éœ€æ˜¾å¼çš„åˆ—å‡ºç‰ˆæœ¬å·ã€‚Mavenä¼šæ²¿ç€çˆ¶å­å±‚çº§å‘ä¸Šå¯»æ‰¾æ‹¥æœ‰<code>&lt;dependencyManagement&gt;</code>å…ƒç´ çš„é¡¹ç›®ï¼Œç„¶åä½¿ç”¨å®ƒæŒ‡å®šçš„ç‰ˆæœ¬å·ã€‚</p>
<p>**äºŒã€**å…³äº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£é‡Šï¼š</p>
<p>è¿™æ ·<code>&lt;dependencies&gt;</code>é‡Œé¢çš„ä¾èµ–å¦‚æœæ²¡æœ‰ç‰ˆæœ¬ä¿¡æ¯ï¼Œå°±å¯ä»¥å‚è€ƒå¼•å…¥çš„pomæ–‡ä»¶çš„<code>&lt;dependencyManagement&gt;</code>é‡Œé¢çš„ç‰ˆæœ¬ä¿¡æ¯ã€‚å°±åƒmavenç»§æ‰¿æ–¹æ³•ä¼¼çš„ï¼Œåœ¨çˆ¶pomçš„&lt; dependencyManagement&gt;é‡Œï¼Œæ”¾å…¥ç‰ˆæœ¬ä¿¡æ¯ï¼Œåœ¨è‹¥å¹²å­pomé‡Œéƒ½çœå»ç‰ˆæœ¬ä¿¡æ¯äº†ã€‚å­ pomåªéœ€åˆ°çˆ¶pomçš„<code>&lt;dependencyManagement&gt;</code>é‡Œï¼Œæ‰¾åˆ°ç›¸åº”çš„artifactIdå’ŒgroupIdçš„ç‰ˆæœ¬ä¿¡æ¯å³å¯ã€‚</p>
<p>**ä¸‰ã€**å…³äº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è§£é‡Šï¼š</p>
<p>é…ç½®<code>&lt;packaging&gt;pom&lt;/packaging&gt;</code>çš„æ„æ€æ˜¯ä½¿ç”¨mavenåˆ†æ¨¡å—ç®¡ç†ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªçˆ¶çº§é¡¹ç›®ï¼Œpomæ–‡ä»¶ä¸€ä¸ªé‡è¦çš„å±æ€§å°±æ˜¯packagingï¼ˆæ‰“åŒ…ç±»å‹ï¼‰ï¼Œä¸€èˆ¬æ¥è¯´æ‰€æœ‰çš„çˆ¶çº§é¡¹ç›®çš„packagingéƒ½ä¸ºpomï¼Œpackagingé»˜è®¤ç±»å‹jarç±»å‹ï¼Œå¦‚æœä¸åšé…ç½®ï¼Œmavenä¼šå°†è¯¥é¡¹ç›®æ‰“æˆjaråŒ…ã€‚</p>
<p>å…¶ä»–å¯å¡«å€¼ï¼š</p>
<p>pom &mdash;&mdash;&mdash;&gt; çˆ¶ç±»å‹éƒ½ä¸ºpomç±»å‹</p>
<p>jar &mdash;&mdash;&mdash;&gt; å†…éƒ¨è°ƒç”¨æˆ–è€…æ˜¯ä½œæœåŠ¡ä½¿ç”¨</p>
<p>war &mdash;&mdash;&mdash;&gt; éœ€è¦éƒ¨ç½²çš„é¡¹ç›®</p>
<p>**å››ã€**Mavenä¸­optionalå’Œscopeå…ƒç´ çš„ä½¿ç”¨</p>
<p>è§£é‡Šï¼šhttps://developer.aliyun.com/article/844335</p>
</blockquote>
<p><strong>lab-adminçš„pomæ–‡ä»¶</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;parent&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>opengms<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.opengms<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/parent&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>lab-admin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;description&gt;</span>
</span></span><span class="line"><span class="cl">        ç®¡ç†æ¨¡å—
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/description&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven.compiler.source&gt;</span>8<span class="nt">&lt;/maven.compiler.source&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven.compiler.target&gt;</span>8<span class="nt">&lt;/maven.compiler.target&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- spring-boot-devtools --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;optional&gt;true&lt;/optional&gt; &amp;lt;!&amp;ndash; è¡¨ç¤ºä¾èµ–ä¸ä¼šä¼ é€’ &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- SpringBoot Webå®¹å™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--ä»¥ä¸‹æ˜¯æ’é™¤çš„ç»„ä»¶--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!--æ’é™¤é»˜è®¤è‡ªå¸¦çš„logç»„ä»¶--&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-logging<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--log4j2æ—¥å¿—ç›¸å…³ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-log4j2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- SpringBoot ymlé…ç½®æ–‡ä»¶ç¼–å†™æ™ºèƒ½æç¤º --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-configuration-processor<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--mysqlé©±åŠ¨ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--è‡ªåŠ¨ç”Ÿæˆå®ä½“ç±»get/setæ–¹æ³•--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--é¡¹ç›®commoné€šç”¨å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.opengms<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>lab-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- SpringBoot æ‹¦æˆªå™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-aop<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- é˜¿é‡Œæ•°æ®åº“è¿æ¥æ±  --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;com.alibaba&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- éªŒè¯ç  --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;com.github.penggle&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;kaptcha&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;exclusions&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &lt;exclusion&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--            &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &lt;/exclusion&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;/exclusions&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- è·å–ç³»ç»Ÿä¿¡æ¯ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;com.github.oshi&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;oshi-core&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>2.1.1.RELEASE<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;fork&gt;</span>true<span class="nt">&lt;/fork&gt;</span> <span class="c">&lt;!-- å¦‚æœæ²¡æœ‰è¯¥é…ç½®ï¼Œdevtoolsä¸ä¼šç”Ÿæ•ˆ --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;executions&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;execution&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="c">&lt;!--æ‰“æˆå¯æ‰§è¡Œçš„è¿è¡ŒåŒ…ï¼ˆ.jar .warï¼‰--&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;goals&gt;</span>
</span></span><span class="line"><span class="cl">                            <span class="nt">&lt;goal&gt;</span>repackage<span class="nt">&lt;/goal&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;/goals&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;/execution&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/executions&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>maven-war-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>3.1.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;failOnMissingWebXml&gt;</span>false<span class="nt">&lt;/failOnMissingWebXml&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;warName&gt;</span>${project.artifactId}<span class="nt">&lt;/warName&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;finalName&gt;</span>${project.artifactId}<span class="nt">&lt;/finalName&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/build&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/project&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>lab-commonçš„pomæ–‡ä»¶</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;parent&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>opengms<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.opengms<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/parent&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>lab-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;description&gt;</span>
</span></span><span class="line"><span class="cl">        commoné€šç”¨å·¥å…·
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/description&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven.compiler.source&gt;</span>8<span class="nt">&lt;/maven.compiler.source&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;maven.compiler.target&gt;</span>8<span class="nt">&lt;/maven.compiler.target&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- Springæ¡†æ¶åŸºæœ¬çš„æ ¸å¿ƒå·¥å…· --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-context-support<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- SpringWebæ¨¡å— --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- spring security å®‰å…¨è®¤è¯ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- è‡ªå®šä¹‰éªŒè¯æ³¨è§£ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--å¸¸ç”¨å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.commons<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>commons-lang3<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- JSONå·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- é˜¿é‡ŒJSONè§£æå™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.alibaba.fastjson2<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>fastjson2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- ioå¸¸ç”¨å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;commons-io&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;commons-io&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- æ–‡ä»¶ä¸Šä¼ å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;commons-fileupload&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;commons-fileupload&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- excelå·¥å…· --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.apache.poi&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- ymlè§£æå™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.yaml&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;snakeyaml&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">         <span class="c">&lt;!--Tokenç”Ÿæˆä¸è§£æ--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>io.jsonwebtoken<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jjwt<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- Jaxb --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- redis ç¼“å­˜æ“ä½œ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- pool å¯¹è±¡æ±  --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- è§£æå®¢æˆ·ç«¯æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨ç­‰ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;groupId&gt;eu.bitwalker&lt;/groupId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;artifactId&gt;UserAgentUtils&lt;/artifactId&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/dependency&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- servletåŒ… --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>javax.servlet<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>javax.servlet-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/project&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="åˆå§‹åŒ–adminæ¨¡å—">åˆå§‹åŒ–adminæ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#åˆå§‹åŒ–adminæ¨¡å—">#</a></h2>
<h3 id="1-æ·»åŠ ä¾èµ–">1. æ·»åŠ ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1-æ·»åŠ ä¾èµ–">#</a></h3>
<p><strong>ä¸Šä¸€èŠ‚å·²æ·»åŠ </strong></p>
<p>**çˆ¶é¡¹ç›®ï¼š**å¼•å…¥<code>pagehelper-spring-boot-starter</code>ï¼ˆåé¢åˆ†é¡µå®ç°ä½¿ç”¨çš„åˆ†é¡µæ’ä»¶ï¼‰ï¼Œå¹¶è§„å®šç‰ˆæœ¬å·ã€‚</p>
<p><code>pagehelper-spring-boot-starter</code>å†…å«ä¾èµ–ï¼š(ä¸»è¦æ˜¯æœ‰æ•´åˆ<code>mybatis</code>çš„é©±åŠ¨<code>mybatis-spring-boot-starter</code>ï¼Œå¼•å…¥å®ƒå°±å¯ä»¥ä¸ç”¨å†å£°æ˜å¼•å…¥<code>mybatis</code>é©±åŠ¨)ï¼Œå¦‚ä¸‹å›¾ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>${pagehelper.boot.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>lab-admin</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--mysqlé©±åŠ¨ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-å‡†å¤‡æ•°æ®åº“è¡¨">2. å‡†å¤‡æ•°æ®åº“è¡¨<a hidden class="anchor" aria-hidden="true" href="#2-å‡†å¤‡æ•°æ®åº“è¡¨">#</a></h3>
<p>å»ºåº“ï¼š</p>
<p><img loading="lazy" src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348038.png" alt="image-20220823214621095"  />
</p>
<p>å»ºè¡¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ç”¨æˆ·ä¿¡æ¯è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_user</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_user</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">           </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">      </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="w">    </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_name</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w">     </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·å&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_type</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">      </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;00&#39;</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·ç±»å‹ï¼ˆ00ç³»ç»Ÿç”¨æˆ·ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">email</span><span class="w">             </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·é‚®ç®±&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">phonenumber</span><span class="w">       </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ‰‹æœºå·ç &#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">sex</span><span class="w">               </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w">                </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·æ€§åˆ«ï¼ˆ0ç”· 1å¥³ 2æœªçŸ¥ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">avatar</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å¤´åƒåœ°å€&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">password</span><span class="w">          </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å¯†ç &#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">login_ip</span><span class="w">          </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æœ€åç™»å½•IP&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">login_date</span><span class="w">        </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æœ€åç™»å½•æ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_by</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºè€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_time</span><span class="w">       </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºæ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_by</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°è€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_time</span><span class="w">       </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°æ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">remark</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="k">null</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å¤‡æ³¨&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="n">auto_increment</span><span class="o">=</span><span class="mi">100</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·ä¿¡æ¯è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">sys_user</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">user_name</span><span class="p">,</span><span class="w"> </span><span class="n">email</span><span class="p">,</span><span class="w"> </span><span class="n">phonenumber</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;é˜¿å½¬&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;7b@163.com&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;15888888888&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-æ•´åˆmybatisç­‰åˆå§‹åŒ–é…ç½®">3. æ•´åˆmybatisç­‰åˆå§‹åŒ–é…ç½®<a hidden class="anchor" aria-hidden="true" href="#3-æ•´åˆmybatisç­‰åˆå§‹åŒ–é…ç½®">#</a></h3>
<p><code>application.yml</code>é…ç½®æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># é¡¹ç›®ç›¸å…³é…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">lab</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># åç§°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">OpenGMS-Lab</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># ç‰ˆæœ¬</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">1.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># ç‰ˆæƒå¹´ä»½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">copyrightYear</span><span class="p">:</span><span class="w"> </span><span class="m">2022</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æ–‡ä»¶è·¯å¾„ ç¤ºä¾‹ï¼ˆ Windowsé…ç½®E:/opengms-lab/uploadPathï¼ŒLinuxé…ç½® /home/opengms-lab/uploadPathï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  profile: E:/opengms-lab/uploadPath</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># éªŒè¯ç ç±»å‹ math æ•°ç»„è®¡ç®— char å­—ç¬¦éªŒè¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">captchaType</span><span class="p">:</span><span class="w"> </span><span class="l">math</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># å¼€å‘ç¯å¢ƒé…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æœåŠ¡å™¨çš„HTTPç«¯å£ï¼Œé»˜è®¤ä¸º8080</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8888</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="l">dev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">datasource</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">lab_datasource</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">jdbc:mysql://127.0.0.1:3306/opengms_lab?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">driver-class-name</span><span class="p">:</span><span class="w"> </span><span class="l">com.mysql.cj.jdbc.Driver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="m">123456</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># MyBatisé…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">mybatis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æœç´¢æŒ‡å®šåŒ…åˆ«å</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">typeAliasesPackage</span><span class="p">:</span><span class="w"> </span><span class="l">org.opengms.**.entity.po</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># é…ç½®mapperçš„æ‰«æï¼Œæ‰¾åˆ°æ‰€æœ‰çš„mapper.xmlæ˜ å°„æ–‡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mapperLocations</span><span class="p">:</span><span class="w"> </span><span class="l">classpath*:mapper/**/*Mapper.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># åŠ è½½å…¨å±€çš„é…ç½®æ–‡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">configLocation</span><span class="p">:</span><span class="w"> </span><span class="l">classpath:mybatis/mybatis-config.xml</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>application-dev.yml</code>é…ç½®æ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">lab</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="l">E:/opengms-lab/uploadPath</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>mybatilsé…ç½®æ–‡ä»¶</strong></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348315.png" alt="image-20220823214347217" style="zoom:67%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">&#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- å…¨å±€å‚æ•° --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;settings&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- ä½¿å…¨å±€çš„æ˜ å°„å™¨å¯ç”¨æˆ–ç¦ç”¨ç¼“å­˜ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span>             <span class="na">value=</span><span class="s">&#34;true&#34;</span>   <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- å…è®¸JDBC æ”¯æŒè‡ªåŠ¨ç”Ÿæˆä¸»é”® --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;useGeneratedKeys&#34;</span>         <span class="na">value=</span><span class="s">&#34;true&#34;</span>   <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- é…ç½®é»˜è®¤çš„æ‰§è¡Œå™¨.SIMPLEå°±æ˜¯æ™®é€šæ‰§è¡Œå™¨;REUSEæ‰§è¡Œå™¨ä¼šé‡ç”¨é¢„å¤„ç†è¯­å¥(prepared statements);BATCHæ‰§è¡Œå™¨å°†é‡ç”¨è¯­å¥å¹¶æ‰§è¡Œæ‰¹é‡æ›´æ–° --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;defaultExecutorType&#34;</span>      <span class="na">value=</span><span class="s">&#34;SIMPLE&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!-- æŒ‡å®š MyBatis æ‰€ç”¨æ—¥å¿—çš„å…·ä½“å®ç° --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span>                  <span class="na">value=</span><span class="s">&#34;SLF4J&#34;</span>  <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- ä½¿ç”¨é©¼å³°å‘½åæ³•è½¬æ¢å­—æ®µ --&gt;</span>
</span></span><span class="line"><span class="cl">		 <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;/settings&gt;</span>
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>1.<code>default-executor-type</code>è¯¦è§£ï¼šhttps://blog.csdn.net/fengshuiyue/article/details/89222654</p>
<p>2.<code>use-generated-keys</code>è¯¦è§£ï¼šhttps://blog.csdn.net/u012060033/article/details/79948353</p>
<p>å°±æ˜¯</p>
<p>3.<code>cache-enabled</code>è¯¦è§£ï¼šhttps://blog.csdn.net/canot/article/details/51491732</p>
<p>ç¼“å­˜æš‚æ—¶æ²¡ç”¨åˆ°ï¼Œåé¢æ•´åˆredisåç”¨redisåšç¼“å­˜ã€‚</p>
</blockquote>
<h3 id="4-åˆ›å»ºå„å±‚æµ‹è¯•">4. åˆ›å»ºå„å±‚æµ‹è¯•<a hidden class="anchor" aria-hidden="true" href="#4-åˆ›å»ºå„å±‚æµ‹è¯•">#</a></h3>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348331.png" alt="image-20220823215724350" style="zoom:67%;" />   
<p>ä¸€ã€<code>User</code>å®ä½“ç±»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Data</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç”¨æˆ·ID */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Long</span> <span class="n">userId</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç”¨æˆ·å */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">userName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç”¨æˆ·é‚®ç®± */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">email</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ‰‹æœºå·ç  */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">phonenumber</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>äºŒã€controllerå±‚</p>
<p><code>UserController</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RestController</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/user&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserController</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="n">IUserService</span> <span class="n">userService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;/{userId}&#34;</span> <span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">User</span> <span class="nf">selectUserById</span><span class="o">(</span><span class="nd">@PathVariable</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="s">&#34;userId&#34;</span><span class="o">)</span> <span class="n">Long</span> <span class="n">userId</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Long userId = 101L;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">userService</span><span class="o">.</span><span class="na">selectUserById</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‰ã€serviceå±‚</p>
<p><code>IUserService</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IUserService</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">User</span> <span class="nf">selectUserById</span><span class="o">(</span><span class="n">Long</span> <span class="n">userId</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>UserServiceImpl</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserServiceImpl</span> <span class="kd">implements</span> <span class="n">IUserService</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">UserMapper</span> <span class="n">userMapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">User</span> <span class="nf">selectUserById</span><span class="o">(</span><span class="n">Long</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">selectUserById</span><span class="o">(</span><span class="n">userId</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å››ã€daoå±‚</p>
<p><code>UserMapper</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Mapper</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">User</span> <span class="nf">selectUserById</span><span class="o">(</span><span class="n">Long</span> <span class="n">userId</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>UserMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE mapper
</span></span></span><span class="line"><span class="cl"><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;org.opengms.admin.mapper.UserMapper&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;resultMap</span> <span class="na">type=</span><span class="s">&#34;User&#34;</span> <span class="na">id=</span><span class="s">&#34;UserResult&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;userId&#34;</span>       <span class="na">column=</span><span class="s">&#34;user_id&#34;</span>      <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;userName&#34;</span>     <span class="na">column=</span><span class="s">&#34;user_name&#34;</span>    <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;email&#34;</span>        <span class="na">column=</span><span class="s">&#34;email&#34;</span>        <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;phonenumber&#34;</span>  <span class="na">column=</span><span class="s">&#34;phonenumber&#34;</span>  <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/resultMap&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectUserById&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;Long&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserResult&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        select user_id, user_name, email, phonenumber from sys_user as u
</span></span><span class="line"><span class="cl">        where u.user_id = #{userId}
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/select&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mapper&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5-å¯åŠ¨æ—¥å¿—">5. å¯åŠ¨æ—¥å¿—<a hidden class="anchor" aria-hidden="true" href="#5-å¯åŠ¨æ—¥å¿—">#</a></h3>
<p><code>banner.txt</code></p>
<p><a href="https://www.bootschool.net/ascii">https://www.bootschool.net/ascii</a></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348349.png" alt="image-20221116223804408" style="zoom:50%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Application Version: ${lab.version}
</span></span><span class="line"><span class="cl">Spring Boot Version: ${spring-boot.version}
</span></span><span class="line"><span class="cl">////////////////////////////////////////////////////////////////////
</span></span><span class="line"><span class="cl">//                          _ooOoo_                               //
</span></span><span class="line"><span class="cl">//                         o8888888o                              //
</span></span><span class="line"><span class="cl">//                         88&#34; . &#34;88                              //
</span></span><span class="line"><span class="cl">//                         (| ^_^ |)                              //
</span></span><span class="line"><span class="cl">//                         O\  =  /O                              //
</span></span><span class="line"><span class="cl">//                      ____/`---&#39;\____                           //
</span></span><span class="line"><span class="cl">//                    .&#39;  \\|     |//  `.                         //
</span></span><span class="line"><span class="cl">//                   /  \\|||  :  |||//  \                        //
</span></span><span class="line"><span class="cl">//                  /  _||||| -:- |||||-  \                       //
</span></span><span class="line"><span class="cl">//                  |   | \\\  -  /// |   |                       //
</span></span><span class="line"><span class="cl">//                  | \_|  &#39;&#39;\---/&#39;&#39;  |   |                       //
</span></span><span class="line"><span class="cl">//                  \  .-\__  `-`  ___/-. /                       //
</span></span><span class="line"><span class="cl">//                ___`. .&#39;  /--.--\  `. . ___                     //
</span></span><span class="line"><span class="cl">//              .&#34;&#34; &#39;&lt;  `.___\_&lt;|&gt;_/___.&#39;  &gt;&#39;&#34;&#34;.                  //
</span></span><span class="line"><span class="cl">//            | | :  `- \`.;`\ _ /`;.`/ - ` : | |                 //
</span></span><span class="line"><span class="cl">//            \  \ `-.   \_ __\ /__ _/   .-` /  /                 //
</span></span><span class="line"><span class="cl">//      ========`-.____`-.___\_____/___.-`____.-&#39;========         //
</span></span><span class="line"><span class="cl">//                           `=---=&#39;                              //
</span></span><span class="line"><span class="cl">//      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^        //
</span></span><span class="line"><span class="cl">//             ä½›ç¥–ä¿ä½‘       æ°¸ä¸å®•æœº      æ°¸æ— BUG               //
</span></span><span class="line"><span class="cl">////////////////////////////////////////////////////////////////////
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   ____                    _____ __  __  _____   _           _
</span></span><span class="line"><span class="cl">  / __ \                  / ____|  \/  |/ ____| | |         | |
</span></span><span class="line"><span class="cl"> | |  | |_ __   ___ _ __ | |  __| \  / | (___   | |     __ _| |__
</span></span><span class="line"><span class="cl"> | |  | | &#39;_ \ / _ \ &#39;_ \| | |_ | |\/| |\___ \  | |    / _` | &#39;_ \
</span></span><span class="line"><span class="cl"> | |__| | |_) |  __/ | | | |__| | |  | |____) | | |___| (_| | |_) |
</span></span><span class="line"><span class="cl">  \____/| .__/ \___|_| |_|\_____|_|  |_|_____/  |______\__,_|_.__/
</span></span><span class="line"><span class="cl">        | |
</span></span><span class="line"><span class="cl">        |_|
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="6-è¯»å–é¡¹ç›®ç›¸å…³é…ç½®">6. è¯»å–é¡¹ç›®ç›¸å…³é…ç½®<a hidden class="anchor" aria-hidden="true" href="#6-è¯»å–é¡¹ç›®ç›¸å…³é…ç½®">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ConfigurationProperties</span><span class="o">(</span><span class="n">prefix</span> <span class="o">=</span> <span class="s">&#34;lab&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LabConfig</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/** é¡¹ç›®åç§° */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç‰ˆæœ¬ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">version</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç‰ˆæƒå¹´ä»½ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">copyrightYear</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ä¸Šä¼ è·¯å¾„ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">profile</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** éªŒè¯ç ç±»å‹ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="n">captchaType</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="7-ç›´æ¥æ‹·è´lab-commonæ•´ä¸ªæ¨¡å—å¹¶åœ¨adminä¸­å¼•å…¥">7. ç›´æ¥æ‹·è´lab-commonæ•´ä¸ªæ¨¡å—å¹¶åœ¨adminä¸­å¼•å…¥<a hidden class="anchor" aria-hidden="true" href="#7-ç›´æ¥æ‹·è´lab-commonæ•´ä¸ªæ¨¡å—å¹¶åœ¨adminä¸­å¼•å…¥">#</a></h3>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348363.png" alt="image-20220823220442050" style="zoom: 80%;" /> 
<p>lab-adminçš„pomæ–‡ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!--é¡¹ç›®commoné€šç”¨å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.opengms<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>lab-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="çº¿ç¨‹é…ç½®">çº¿ç¨‹é…ç½®<a hidden class="anchor" aria-hidden="true" href="#çº¿ç¨‹é…ç½®">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableScheduling</span>  <span class="c1">//åŒæ­¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@EnableAsync</span>  <span class="c1">//å¼‚æ­¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ScheduleConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">TaskExecutor</span> <span class="nf">taskExecutor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ThreadPoolTaskExecutor</span> <span class="n">executor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadPoolTaskExecutor</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®æ ¸å¿ƒçº¿ç¨‹æ•° æ ¸å¿ƒçº¿ç¨‹æ•°çº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setCorePoolSize</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®æœ€å¤§çº¿ç¨‹æ•° å½“é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setMaxPoolSize</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®é˜Ÿåˆ—å®¹é‡ å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä¿¡ä»»å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setQueueCapacity</span><span class="o">(</span><span class="mi">200</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®çº¿ç¨‹æ´»è·ƒæ—¶é—´ï¼ˆç§’ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setKeepAliveSeconds</span><span class="o">(</span><span class="mi">60</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®é»˜è®¤çº¿ç¨‹åç§°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setThreadNamePrefix</span><span class="o">(</span><span class="s">&#34;AsyncThread-&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®æ‹’ç»ç­–ç•¥ å½“æœ€å¤§æ± è¢«å¡«æ»¡æ—¶ï¼Œæ­¤ç­–ç•¥ä¸ºæˆ‘ä»¬æä¾›å¯ä¼¸ç¼©é˜Ÿåˆ—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setRejectedExecutionHandler</span><span class="o">(</span><span class="k">new</span> <span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="na">CallerRunsPolicy</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸåå†å…³é—­çº¿ç¨‹æ± 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setWaitForTasksToCompleteOnShutdown</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">executor</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="è·¨åŸŸç™»å½•éªŒè¯å…¨å±€å¼‚å¸¸é…ç½®">è·¨åŸŸã€ç™»å½•éªŒè¯ã€å…¨å±€å¼‚å¸¸é…ç½®<a hidden class="anchor" aria-hidden="true" href="#è·¨åŸŸç™»å½•éªŒè¯å…¨å±€å¼‚å¸¸é…ç½®">#</a></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//è§£å†³è·¨åŸŸé—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addCorsMappings</span><span class="o">(</span><span class="n">CorsRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">registry</span><span class="o">.</span><span class="na">addMapping</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">);</span> <span class="c1">//å…è®¸è¿œç«¯è®¿é—®çš„åŸŸå
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// .allowedOrigins(&#34;http://localhost:8099&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//å…è®¸è¯·æ±‚çš„æ–¹æ³•(&#34;POST&#34;, &#34;GET&#34;, &#34;PUT&#34;, &#34;OPTIONS&#34;, &#34;DELETE&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// .allowedMethods(&#34;*&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//å…è®¸è¯·æ±‚å¤´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// .allowedHeaders(&#34;*&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//ç™»å½•è¯·æ±‚é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addInterceptors</span><span class="o">(</span><span class="n">InterceptorRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * kn4j åœ¨æƒ³æ–‡æ¡£ç›¸å…³çš„èµ„æº  éœ€è¦æ”¾å¼€
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span><span class="o">[]</span>  <span class="n">swaggerPatterns</span> <span class="o">=</span>  <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/swagger-resources/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/webjars/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/v2/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/swagger-ui.html/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/doc.html/**&#34;</span> <span class="o">};</span>
</span></span><span class="line"><span class="cl">        <span class="n">registry</span><span class="o">.</span><span class="na">addInterceptor</span><span class="o">(</span><span class="n">authenticationInterceptor</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">excludePathPatterns</span><span class="o">(</span><span class="n">swaggerPatterns</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">addPathPatterns</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">);</span>    <span class="c1">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰ @LoginRequired æ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">AuthenticationInterceptor</span> <span class="nf">authenticationInterceptor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">AuthenticationInterceptor</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="æ•´åˆæ—¥å¿—å®ç°">æ•´åˆæ—¥å¿—å®ç°<a hidden class="anchor" aria-hidden="true" href="#æ•´åˆæ—¥å¿—å®ç°">#</a></h2>
<blockquote>
<p><strong>æ•´ä½“æ€è·¯ï¼šSLF4j+log4j2+Aop</strong></p>
</blockquote>
<h3 id="1-æ·»åŠ ä¾èµ–-1">1. æ·»åŠ ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1-æ·»åŠ ä¾èµ–-1">#</a></h3>
<p><strong>lab-admin</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!-- SpringBoot Webå®¹å™¨ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--ä»¥ä¸‹æ˜¯æ’é™¤çš„ç»„ä»¶--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--æ’é™¤é»˜è®¤è‡ªå¸¦çš„logç»„ä»¶--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-logging<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--log4j2æ—¥å¿—ç›¸å…³ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-log4j2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- SpringBoot æ‹¦æˆªå™¨ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-aop<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-åˆ›å»ºæ•°æ®åº“è¡¨">2. åˆ›å»ºæ•°æ®åº“è¡¨<a hidden class="anchor" aria-hidden="true" href="#2-åˆ›å»ºæ•°æ®åº“è¡¨">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- æ“ä½œæ—¥å¿—è®°å½•
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_oper_log</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_oper_log</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_id</span><span class="w">           </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">      </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="w">    </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ—¥å¿—ä¸»é”®&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">title</span><span class="w">             </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ¨¡å—æ ‡é¢˜&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">business_type</span><span class="w">     </span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w">          </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ä¸šåŠ¡ç±»å‹ï¼ˆ0å…¶å®ƒ 1æ–°å¢ 2ä¿®æ”¹ 3åˆ é™¤ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">method</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ–¹æ³•åç§°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">request_method</span><span class="w">    </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è¯·æ±‚æ–¹å¼&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">operator_type</span><span class="w">     </span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">          </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ“ä½œç±»åˆ«ï¼ˆ0å…¶å®ƒ 1åå°ç”¨æˆ· 2æ‰‹æœºç«¯ç”¨æˆ·ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_name</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ“ä½œäººå‘˜&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_url</span><span class="w">          </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è¯·æ±‚URL&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_ip</span><span class="w">           </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ä¸»æœºåœ°å€&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_location</span><span class="w">     </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ“ä½œåœ°ç‚¹&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_param</span><span class="w">        </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span><span class="w">   </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è¯·æ±‚å‚æ•°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">json_result</span><span class="w">       </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span><span class="w">   </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è¿”å›å‚æ•°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">status</span><span class="w">            </span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">          </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ“ä½œçŠ¶æ€ï¼ˆ0æ­£å¸¸ 1å¼‚å¸¸ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">error_msg</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span><span class="w">   </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;é”™è¯¯æ¶ˆæ¯&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">oper_time</span><span class="w">         </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ“ä½œæ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">oper_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="n">auto_increment</span><span class="o">=</span><span class="mi">100</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;æ“ä½œæ—¥å¿—è®°å½•&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-è‡ªå®šä¹‰æ³¨è§£logåŠç›¸å…³æšä¸¾">3. è‡ªå®šä¹‰æ³¨è§£@LogåŠç›¸å…³æšä¸¾<a hidden class="anchor" aria-hidden="true" href="#3-è‡ªå®šä¹‰æ³¨è§£logåŠç›¸å…³æšä¸¾">#</a></h3>
<p>ä¸€ã€<code>Log</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Target</span><span class="o">({</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">METHOD</span> <span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Documented</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Log</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ¨¡å— 
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="nf">title</span><span class="o">()</span> <span class="k">default</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åŠŸèƒ½
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">BusinessType</span> <span class="nf">businessType</span><span class="o">()</span> <span class="k">default</span> <span class="n">BusinessType</span><span class="o">.</span><span class="na">OTHER</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ“ä½œäººç±»åˆ«
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">OperatorType</span> <span class="nf">operatorType</span><span class="o">()</span> <span class="k">default</span> <span class="n">OperatorType</span><span class="o">.</span><span class="na">MANAGE</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ˜¯å¦ä¿å­˜è¯·æ±‚çš„å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kt">boolean</span> <span class="nf">isSaveRequestData</span><span class="o">()</span> <span class="k">default</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ˜¯å¦ä¿å­˜å“åº”çš„å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kt">boolean</span> <span class="nf">isSaveResponseData</span><span class="o">()</span> <span class="k">default</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>äºŒã€<code>BusinessType</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">BusinessType</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å…¶å®ƒ
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">OTHER</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ–°å¢
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">INSERT</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä¿®æ”¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">UPDATE</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆ é™¤
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">DELETE</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æˆæƒ
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">GRANT</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å¯¼å‡º
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">EXPORT</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å¯¼å…¥
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">IMPORT</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å¼ºé€€
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">FORCE</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ç”Ÿæˆä»£ç 
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">GENCODE</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ¸…ç©ºæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">CLEAN</span><span class="o">,</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸‰ã€<code>OperatorType</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">enum</span> <span class="n">OperatorType</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å…¶å®ƒ
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">OTHER</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åå°ç”¨æˆ·
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">MANAGE</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ‰‹æœºç«¯ç”¨æˆ·
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="n">MOBILE</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-aopåˆ‡é¢å¤„ç†è¯·æ±‚æ“ä½œæ—¥å¿—">4. AOPåˆ‡é¢å¤„ç†è¯·æ±‚æ“ä½œæ—¥å¿—<a hidden class="anchor" aria-hidden="true" href="#4-aopåˆ‡é¢å¤„ç†è¯·æ±‚æ“ä½œæ—¥å¿—">#</a></h3>
<p>æ ¸å¿ƒçš„<code>LogAspect</code>åˆ‡é¢å¤„ç†ç±»ä¸­çš„ä¿å­˜Logå…·ä½“å¤„ç†æ–¹æ³•<code>handleLog</code>ä¸»è¦é€»è¾‘ï¼š</p>
<ol>
<li>è·å¾—æ³¨è§£</li>
<li>ä»ç¼“å­˜è·å–å½“å‰çš„ç”¨æˆ·ä¿¡æ¯(æš‚ç¼ºï¼Œå…ˆæ¨¡æ‹Ÿä¸€ä¸ª)</li>
<li>è·å–è¯·æ±‚å„é¡¹éœ€è¦è®°å½•çš„åŸºæœ¬ä¿¡æ¯</li>
<li>åˆ¤æ–­è¯·æ±‚æ˜¯å¦æœ‰å¼‚å¸¸</li>
<li>ä¿å­˜åˆ°æ•°æ®åº“</li>
<li>æ‰“å°åˆ°æ§åˆ¶å°</li>
</ol>
<p>ä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼Œè¯¦ç»†ä»£ç è§<code>LogAspect</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * å¤„ç†å®Œè¯·æ±‚åæ‰§è¡Œ
</span></span></span><span class="line"><span class="cl"><span class="cm"> *
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param joinPoint åˆ‡ç‚¹
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@AfterReturning</span><span class="o">(</span><span class="n">pointcut</span> <span class="o">=</span> <span class="s">&#34;@annotation(controllerLog)&#34;</span><span class="o">,</span> <span class="n">returning</span> <span class="o">=</span> <span class="s">&#34;jsonResult&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">doAfterReturning</span><span class="o">(</span><span class="n">JoinPoint</span> <span class="n">joinPoint</span><span class="o">,</span> <span class="n">Log</span> <span class="n">controllerLog</span><span class="o">,</span> <span class="n">Object</span> <span class="n">jsonResult</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">handleLog</span><span class="o">(</span><span class="n">joinPoint</span><span class="o">,</span> <span class="n">controllerLog</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">jsonResult</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="5-aopä»£ç†é…ç½®">5. aopä»£ç†é…ç½®<a hidden class="anchor" aria-hidden="true" href="#5-aopä»£ç†é…ç½®">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¡¨ç¤ºé€šè¿‡aopæ¡†æ¶æš´éœ²è¯¥ä»£ç†å¯¹è±¡,AopContextèƒ½å¤Ÿè®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@EnableAspectJAutoProxy</span><span class="o">(</span><span class="n">exposeProxy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApplicationConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/u013720069/article/details/112025020">æ³¨è§£@EnableAspectJAutoProxy(exposeProxy = true) exposeProxy çš„ç”¨æ³•</a></p>
</blockquote>
<h3 id="5-log4j2çš„é…ç½®æ–‡ä»¶">5. log4j2çš„é…ç½®æ–‡ä»¶<a hidden class="anchor" aria-hidden="true" href="#5-log4j2çš„é…ç½®æ–‡ä»¶">#</a></h3>
<blockquote>
<p>æ—¥å¿—çš„é…ç½®ä¸»è¦ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­</p>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/Zereao/article/details/83718332">SpringBoot é…ç½®æ§åˆ¶å°å½©è‰²æ—¥å¿—è¾“å‡º</a></p>
</blockquote>
<p>é…ç½®æ–‡ä»¶ä½ç½®ï¼š</p>
<p><img loading="lazy" src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348494.png" alt="image-20220823221600695"  />
</p>
<p><code>application.yml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#æ—¥å¿—é…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">logging</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">level</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">org.opengms</span><span class="p">:</span><span class="w"> </span><span class="l">debug</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">org.springframework</span><span class="p">:</span><span class="w"> </span><span class="l">warn</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><code>application-prod.yml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">lab</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profile</span><span class="p">:</span><span class="w"> </span><span class="l">/home/opengms-lab/uploadPath</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#æ—¥å¿—é…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">logging</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">config</span><span class="p">:</span><span class="w"> </span><span class="l">classpath:log4j2-config.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">file</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l">/home/opengms-lab/logs</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/lixifun/article/details/119859703">log4j2 é…ç½®æ–‡ä»¶è¯»å– application.yml çš„æ—¥å¿—è·¯å¾„å˜é‡</a></p>
</blockquote>
<p><code>log4j2-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--
</span></span></span><span class="line"><span class="cl"><span class="c">    6ä¸ªä¼˜å…ˆçº§ä»é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼šOFFã€FATALã€ERRORã€WARNã€INFOã€DEBUGã€TRACEã€ ALLã€‚
</span></span></span><span class="line"><span class="cl"><span class="c">    å¦‚æœè®¾ç½®ä¼˜å…ˆçº§ä¸ºWARNï¼Œé‚£ä¹ˆOFFã€FATALã€ERRORã€WARN 4ä¸ªçº§åˆ«çš„logèƒ½æ­£å¸¸è¾“å‡º
</span></span></span><span class="line"><span class="cl"><span class="c">    è®¾ç½®ä¸ºOFF è¡¨ç¤ºä¸è®°å½•log4j2æœ¬èº«çš„æ—¥å¿—ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="c"> --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- statusï¼šç”¨æ¥æŒ‡å®šlog4jæœ¬èº«çš„æ‰“å°æ—¥å¿—çº§åˆ«,monitorInterval:æŒ‡å®šlog4jè‡ªåŠ¨é‡æ–°é…ç½®çš„ç›‘æµ‹é—´éš”æ—¶é—´ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;Configuration</span> <span class="na">status=</span><span class="s">&#34;fatal&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Properties&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- æ—¥å¿—è¾“å‡ºæ ¼å¼ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;property name=&#34;LOG_PATTERN&#34; value=&#34;%d{yyyy-MM-dd HH:mm:ss.SSS} %5p ${PID:-} [%15.15t] %-40.40logger{39} : %m%n&#34; /&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;LOG_PATTERN&#34;</span> <span class="na">value=</span><span class="s">&#34;%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight{%5level} %style{%pid}{yellow} --- [%15.15t] %style{%-40.40logger{39}}{blue} : %msg%n%style{%throwable}{red}&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- ${sys:LOG_PATH} è¯»å–çš„å°±æ˜¯ application.yml ä¸­çš„ logging.file.path çš„å€¼ --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;baseDir&#34;</span> <span class="na">value=</span><span class="s">&#34;${sys:LOG_PATH}&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Appenders&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;Console</span> <span class="na">name=</span><span class="s">&#34;Console&#34;</span> <span class="na">target=</span><span class="s">&#34;SYSTEM_OUT&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--æ§åˆ¶å°åªè¾“å‡ºlevelåŠä»¥ä¸Šçº§åˆ«çš„ä¿¡æ¯ï¼ˆonMatchï¼‰ï¼Œå…¶ä»–çš„ç›´æ¥æ‹’ç»ï¼ˆonMismatchï¼‰ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;ThresholdFilter</span> <span class="na">level=</span><span class="s">&#34;debug&#34;</span> <span class="na">onMatch=</span><span class="s">&#34;ACCEPT&#34;</span>
</span></span><span class="line"><span class="cl">                             <span class="na">onMismatch=</span><span class="s">&#34;DENY&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">&#34;${LOG_PATTERN}&#34;</span> <span class="na">disableAnsi=</span><span class="s">&#34;false&#34;</span> <span class="na">noConsoleNoAnsi=</span><span class="s">&#34;false&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--&lt;PatternLayout--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--        pattern=&#34;%d{yyyy-MM-dd HH:mm:ss.SSS} %highlight{%5level} %style{%pid}{yellow} -&amp;#45;&amp;#45; [%15.15t] %style{%-40.40logger{39}}{blue} : %msg%n%style{%throwable}{red}&#34;--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--        disableAnsi=&#34;false&#34; noConsoleNoAnsi=&#34;false&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/Console&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--debugçº§åˆ«æ—¥å¿—æ–‡ä»¶è¾“å‡º--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;RollingFile name=&#34;debug_appender&#34; fileName=&#34;${baseDir}/debug.log&#34;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--             filePattern=&#34;${baseDir}/debug_%i.log.%d{yyyy-MM-dd}&#34;&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &amp;lt;!&amp;ndash; è¿‡æ»¤å™¨ &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;Filters&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &amp;lt;!&amp;ndash; é™åˆ¶æ—¥å¿—çº§åˆ«åœ¨debugåŠä»¥ä¸Šåœ¨infoä»¥ä¸‹ &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &lt;ThresholdFilter level=&#34;debug&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &lt;ThresholdFilter level=&#34;info&#34; onMatch=&#34;DENY&#34; onMismatch=&#34;NEUTRAL&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;/Filters&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &amp;lt;!&amp;ndash; æ—¥å¿—æ ¼å¼ &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;PatternLayout pattern=&#34;${LOG_PATTERN}&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &amp;lt;!&amp;ndash; ç­–ç•¥ &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;Policies&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &amp;lt;!&amp;ndash; æ¯éš”ä¸€å¤©è½¬å­˜ &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &lt;TimeBasedTriggeringPolicy interval=&#34;1&#34; modulate=&#34;true&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &amp;lt;!&amp;ndash; æ–‡ä»¶å¤§å° &amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--        &lt;SizeBasedTriggeringPolicy size=&#34;100 MB&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;/Policies&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &amp;lt;!&amp;ndash; DefaultRolloverStrategyå±æ€§å¦‚ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹7ä¸ªæ–‡ä»¶å¼€å§‹è¦†ç›–&amp;ndash;&amp;gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;DefaultRolloverStrategy max=&#34;15&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/RollingFile&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- infoçº§åˆ«æ—¥å¿—æ–‡ä»¶è¾“å‡º --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;RollingFile</span> <span class="na">name=</span><span class="s">&#34;info_appender&#34;</span> <span class="na">fileName=</span><span class="s">&#34;${baseDir}/info.log&#34;</span>
</span></span><span class="line"><span class="cl">                     <span class="na">filePattern=</span><span class="s">&#34;${baseDir}/info_%i.log.%d{yyyy-MM-dd}&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- è¿‡æ»¤å™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;Filters&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- é™åˆ¶æ—¥å¿—çº§åˆ«åœ¨infoåŠä»¥ä¸Šåœ¨errorä»¥ä¸‹ --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;ThresholdFilter</span> <span class="na">level=</span><span class="s">&#34;info&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;ThresholdFilter</span> <span class="na">level=</span><span class="s">&#34;error&#34;</span> <span class="na">onMatch=</span><span class="s">&#34;DENY&#34;</span> <span class="na">onMismatch=</span><span class="s">&#34;NEUTRAL&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/Filters&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- æ—¥å¿—æ ¼å¼ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">&#34;${LOG_PATTERN}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- ç­–ç•¥ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;Policies&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- æ¯éš”ä¸€å¤©è½¬å­˜ --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;TimeBasedTriggeringPolicy</span> <span class="na">interval=</span><span class="s">&#34;1&#34;</span> <span class="na">modulate=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- æ–‡ä»¶å¤§å° --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;SizeBasedTriggeringPolicy</span> <span class="na">size=</span><span class="s">&#34;100 MB&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/Policies&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- DefaultRolloverStrategyå±æ€§å¦‚ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹7ä¸ªæ–‡ä»¶å¼€å§‹è¦†ç›–--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;DefaultRolloverStrategy</span> <span class="na">max=</span><span class="s">&#34;15&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/RollingFile&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- errorçº§åˆ«æ—¥å¿—æ–‡ä»¶è¾“å‡º --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;RollingFile</span> <span class="na">name=</span><span class="s">&#34;error_appender&#34;</span> <span class="na">fileName=</span><span class="s">&#34;${baseDir}/error.log&#34;</span>
</span></span><span class="line"><span class="cl">                     <span class="na">filePattern=</span><span class="s">&#34;${baseDir}/error_%i.log.%d{yyyy-MM-dd}&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- è¿‡æ»¤å™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;Filters&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- é™åˆ¶æ—¥å¿—çº§åˆ«åœ¨erroråŠä»¥ä¸Š --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;ThresholdFilter</span> <span class="na">level=</span><span class="s">&#34;error&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/Filters&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- æ—¥å¿—æ ¼å¼ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;PatternLayout</span> <span class="na">pattern=</span><span class="s">&#34;${LOG_PATTERN}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;Policies&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- æ¯éš”ä¸€å¤©è½¬å­˜ --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;TimeBasedTriggeringPolicy</span> <span class="na">interval=</span><span class="s">&#34;1&#34;</span> <span class="na">modulate=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="c">&lt;!-- æ–‡ä»¶å¤§å° --&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;SizeBasedTriggeringPolicy</span> <span class="na">size=</span><span class="s">&#34;100 MB&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/Policies&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!-- DefaultRolloverStrategyå±æ€§å¦‚ä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹7ä¸ªæ–‡ä»¶å¼€å§‹è¦†ç›–--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;DefaultRolloverStrategy</span> <span class="na">max=</span><span class="s">&#34;15&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/RollingFile&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Appenders&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--LoggerèŠ‚ç‚¹ç”¨æ¥å•ç‹¬æŒ‡å®šæ—¥å¿—çš„å½¢å¼ï¼Œæ¯”å¦‚è¦ä¸ºæŒ‡å®šåŒ…ä¸‹çš„classæŒ‡å®šä¸åŒçš„æ—¥å¿—çº§åˆ«ç­‰ã€‚--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--ç„¶åå®šä¹‰loggersï¼Œåªæœ‰å®šä¹‰äº†loggerå¹¶å¼•å…¥çš„appenderï¼Œappenderæ‰ä¼šç”Ÿæ•ˆ--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--ç›‘æ§ç³»ç»Ÿä¿¡æ¯--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--è‹¥æ˜¯additivityè®¾ä¸ºfalseï¼Œåˆ™ å­Logger åªä¼šåœ¨è‡ªå·±çš„appenderé‡Œè¾“å‡ºï¼Œè€Œä¸ä¼šåœ¨ çˆ¶Logger çš„appenderé‡Œè¾“å‡ºã€‚--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;Loggers&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--è¿‡æ»¤æ‰springå’Œmybatisçš„ä¸€äº›æ— ç”¨çš„DEBUGä¿¡æ¯--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;org.mybatis&#34;</span> <span class="na">level=</span><span class="s">&#34;info&#34;</span> <span class="na">additivity=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;Console&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/logger&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;Logger</span> <span class="na">name=</span><span class="s">&#34;org.springframework&#34;</span> <span class="na">level=</span><span class="s">&#34;WARN&#34;</span> <span class="na">additivity=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;Console&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/Logger&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--pagehelperæ—¥å¿—è¾“å‡ºé™åˆ¶--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;Logger name=&#34;com.github.pagehelper&#34; level=&#34;info&#34; additivity=&#34;false&#34;&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;AppenderRef ref=&#34;Console&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;/Logger&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- è®¾ç½®com.zaxxer.hikariåŒ…ä¸‹çš„æ—¥å¿—åªæ‰“å°WARNåŠä»¥ä¸Šçº§åˆ«çš„æ—¥å¿— --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;com.zaxxer.hikari&#34;</span> <span class="na">level=</span><span class="s">&#34;WARN&#34;</span> <span class="na">additivity=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&#34;Console&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/logger&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- è®¾ç½®org.hibernate.validatoråŒ…ä¸‹çš„æ—¥å¿—åªæ‰“å°WARNåŠä»¥ä¸Šçº§åˆ«çš„æ—¥å¿— --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;logger</span> <span class="na">name=</span><span class="s">&#34;org.hibernate.validator&#34;</span> <span class="na">level=</span><span class="s">&#34;WARN&#34;</span> <span class="na">additivity=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;appender-ref</span> <span class="na">ref=</span><span class="s">&#34;Console&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/logger&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- è®¾ç½®org.apacheåŒ…ä¸‹çš„æ—¥å¿—åªæ‰“å°WARNåŠä»¥ä¸Šçº§åˆ«çš„æ—¥å¿— --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;logger name=&#34;org.apache&#34; level=&#34;WARN&#34; additivity=&#34;false&#34;&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--      &lt;appender-ref ref=&#34;Console&#34;/&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--    &lt;/logger&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;Root</span> <span class="na">level=</span><span class="s">&#34;info&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;Console&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;debug_appender&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;info_appender&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;AppenderRef</span> <span class="na">ref=</span><span class="s">&#34;error_appender&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/Root&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/Loggers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/Configuration&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/wangpaiblog/article/details/122315204">log4j2.xml çš„æ ‡ç­¾ loggers ä¸­ root çš„å±æ€§ level æŒ‡çš„æ˜¯ä»€ä¹ˆ</a></p>
</blockquote>
<h2 id="æ•´åˆredisç¼“å­˜">æ•´åˆRedisç¼“å­˜<a hidden class="anchor" aria-hidden="true" href="#æ•´åˆredisç¼“å­˜">#</a></h2>
<h3 id="1-æ·»åŠ ä¾èµ–-2">1. æ·»åŠ ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1-æ·»åŠ ä¾èµ–-2">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!--redis ç¼“å­˜æ“ä½œ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--pool å¯¹è±¡æ±  --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- spring2.0é›†æˆredisæ‰€éœ€common-pool2 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.apache.commons<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>commons-pool2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-redisæ•°æ®åº“è¿æ¥ä¿¡æ¯é…ç½®">2. Redisæ•°æ®åº“è¿æ¥ä¿¡æ¯é…ç½®<a hidden class="anchor" aria-hidden="true" href="#2-redisæ•°æ®åº“è¿æ¥ä¿¡æ¯é…ç½®">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># Redisé»˜è®¤æƒ…å†µä¸‹æœ‰16ä¸ªåˆ†ç‰‡ï¼Œè¿™é‡Œé…ç½®å…·ä½“ä½¿ç”¨çš„åˆ†ç‰‡ï¼Œé»˜è®¤æ˜¯0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">database</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l">localhost</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">6379</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># è¿æ¥å¯†ç ï¼ˆé»˜è®¤ä¸ºç©ºï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c"># è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l">50ms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">lettuce</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">pool</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># è¿æ¥æ± æœ€å¤§è¿æ¥æ•°ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ é»˜è®¤ 8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max-active</span><span class="p">:</span><span class="w"> </span><span class="m">8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># è¿æ¥æ± æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´ï¼ˆä½¿ç”¨è´Ÿå€¼è¡¨ç¤ºæ²¡æœ‰é™åˆ¶ï¼‰ é»˜è®¤ -1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max-wait</span><span class="p">:</span><span class="w"> </span>-<span class="m">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># è¿æ¥æ± ä¸­çš„æœ€å¤§ç©ºé—²è¿æ¥ é»˜è®¤ 8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">max-idle</span><span class="p">:</span><span class="w"> </span><span class="m">8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c"># è¿æ¥æ± ä¸­çš„æœ€å°ç©ºé—²è¿æ¥ é»˜è®¤ 0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">min-idle</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3-åœ¨redisconfigä¸­è‡ªå®šä¹‰redistemplateè§£å†³åºåˆ—åŒ–é—®é¢˜">3. åœ¨RedisConfigä¸­è‡ªå®šä¹‰RedisTemplateè§£å†³åºåˆ—åŒ–é—®é¢˜<a hidden class="anchor" aria-hidden="true" href="#3-åœ¨redisconfigä¸­è‡ªå®šä¹‰redistemplateè§£å†³åºåˆ—åŒ–é—®é¢˜">#</a></h3>
<p><strong>è¿™é‡Œä½¿ç”¨jackonã€‚fastjsonå‡ºäº‹å¤ªå¤šäº†ï¼Œå®é™…ä¸šåŠ¡å¼€å‘ä¸­å°½é‡å°‘ç”¨ä¸ºå¦™</strong></p>
<p><a href="https://juejin.cn/post/6846687594130964488">fastjsonåˆ°åº•åšé”™äº†ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä¼šè¢«é¢‘ç¹çˆ†å‡ºæ¼æ´ï¼Ÿ</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableCaching</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="nf">template</span><span class="o">(</span><span class="n">RedisConnectionFactory</span> <span class="n">factory</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// åˆ›å»ºRedisTemplate&lt;String, Object&gt;å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">template</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RedisTemplate</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// é…ç½®è¿æ¥å·¥å‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setConnectionFactory</span><span class="o">(</span><span class="n">factory</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// redis key åºåˆ—åŒ–æ–¹å¼ä½¿ç”¨stringSerial
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setKeySerializer</span><span class="o">(</span><span class="k">new</span> <span class="n">StringRedisSerializer</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// redis value åºåˆ—åŒ–æ–¹å¼è‡ªå®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// template.setValueSerializer(new GenericFastJsonRedisSerializer());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setValueSerializer</span><span class="o">(</span><span class="n">valueSerializer</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// redis hash key åºåˆ—åŒ–æ–¹å¼ä½¿ç”¨stringSerial
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setHashKeySerializer</span><span class="o">(</span><span class="k">new</span> <span class="n">StringRedisSerializer</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// redis hash value åºåˆ—åŒ–æ–¹å¼è‡ªå®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// template.setHashValueSerializer(new GenericFastJsonRedisSerializer());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setHashValueSerializer</span><span class="o">(</span><span class="n">valueSerializer</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">template</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">RedisSerializer</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">valueSerializer</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Jackson2JsonRedisSerializer</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">jackson2JsonRedisSerializer</span> <span class="o">=</span>
</span></span><span class="line"><span class="cl">            <span class="k">new</span> <span class="n">Jackson2JsonRedisSerializer</span><span class="o">&lt;&gt;(</span><span class="n">Object</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">objectMapper</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">PropertyAccessor</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">JsonAutoDetect</span><span class="o">.</span><span class="na">Visibility</span><span class="o">.</span><span class="na">ANY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// æ­¤é¡¹å¿…é¡»é…ç½®ï¼Œå¦åˆ™å¦‚æœåºåˆ—åŒ–çš„å¯¹è±¡é‡Œè¾¹è¿˜æœ‰å¯¹è±¡ï¼Œä¼šæŠ¥å¦‚ä¸‹é”™è¯¯ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//     java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to XXX
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">objectMapper</span><span class="o">.</span><span class="na">activateDefaultTyping</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">objectMapper</span><span class="o">.</span><span class="na">getPolymorphicTypeValidator</span><span class="o">(),</span>
</span></span><span class="line"><span class="cl">            <span class="n">ObjectMapper</span><span class="o">.</span><span class="na">DefaultTyping</span><span class="o">.</span><span class="na">NON_FINAL</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">JsonTypeInfo</span><span class="o">.</span><span class="na">As</span><span class="o">.</span><span class="na">PROPERTY</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ—§ç‰ˆå†™æ³•ï¼š
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL, JsonTypeInfo.As.PROPERTY);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="n">jackson2JsonRedisSerializer</span><span class="o">.</span><span class="na">setObjectMapper</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">jackson2JsonRedisSerializer</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ä½¿ç”¨jacksonåœ¨è¿›è¡Œåºåˆ—åŒ–ååºåˆ—åŒ–æ—¶ redisæŠ¥é”™ï¼š <code>Could not read JSON: Unrecognized field â€œenabledâ€œ</code></p>
<p>å‚è€ƒé“¾æ¥ï¼šhttps://blog.csdn.net/qq_41706331/article/details/119242055</p>
<p>åŸå› ï¼šåºåˆ—åŒ–æ—¶å¤šäº†å‡ ä¸ªå­—æ®µï¼Œè¿™æ˜¯å› ä¸ºä¸ºäº†æ•´åˆspringsecurityåœ¨Userç±»ä¸­å®ç°äº†UserDetailsæ¥å£ï¼Œé‡å†™äº†è¿™äº›æ–¹æ³•</p>
<p>è§£å†³ï¼šä½¿ç”¨@JsonIgnorePropertiesæ³¨è§£ï¼Œå¯ä»¥åœ¨Userå¯¹è±¡åœ¨åºåˆ—åŒ–æ—¶å¿½ç•¥è¿™äº›å­—æ®µã€‚åœ¨Userç±»å‰æ·»åŠ ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@JsonIgnoreProperties</span><span class="o">({</span><span class="s">&#34;enabled&#34;</span><span class="o">,</span><span class="s">&#34;accountNonExpired&#34;</span><span class="o">,</span> <span class="s">&#34;accountNonLocked&#34;</span><span class="o">,</span> <span class="s">&#34;credentialsNonExpired&#34;</span><span class="o">,</span> <span class="s">&#34;authorities&#34;</span><span class="o">})</span>
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<h3 id="4-å°è£…redisutils----rediså¸¸ç”¨å‘½ä»¤å·¥å…·ç±»">4. å°è£…RedisUtils &ndash; Rediså¸¸ç”¨å‘½ä»¤å·¥å…·ç±»<a hidden class="anchor" aria-hidden="true" href="#4-å°è£…redisutils----rediså¸¸ç”¨å‘½ä»¤å·¥å…·ç±»">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"></code></pre></td></tr></table>
</div>
</div><h3 id="5redisæµ‹è¯•ä½¿ç”¨">5.Redisæµ‹è¯•ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#5redisæµ‹è¯•ä½¿ç”¨">#</a></h3>
<p><strong>åœ¨lab-adminä¸­æ‰«æcommonæ¨¡å—çš„beanï¼ˆå› ä¸ºspringbootçš„@SpringBootApplicationæ³¨è§£é»˜è®¤æ‰«æèŒƒå›´ä¸ºè‡ªå·±çš„å¯åŠ¨ç±»æ‰€åœ¨çš„åŒ…åŠå…¶å­åŒ…ï¼‰</strong></p>
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/jeason13920089655/article/details/110619214">SpringBootå¤šæ¨¡å—é¡¹ç›®ä¸­æ— æ³•æ³¨å…¥å…¶ä»–æ¨¡å—ä¸­çš„spring bean</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="c1">// è¡¨ç¤ºé€šè¿‡aopæ¡†æ¶æš´éœ²è¯¥ä»£ç†å¯¹è±¡,AopContextèƒ½å¤Ÿè®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@EnableAspectJAutoProxy</span><span class="o">(</span><span class="n">exposeProxy</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// æ‰«æcommonæ¨¡å—çš„bean
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span><span class="s">&#34;org.opengms.common&#34;</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApplicationConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">RedisUtils</span> <span class="n">redisUtils</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/helloRedis&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">helloRedis</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æµ‹è¯•å†™å…¥ä¸€ä¸ªstringç±»å‹é”®å€¼,è¿‡æœŸæ—¶é—´20S
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">redisUtils</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;key1&#34;</span><span class="o">,</span> <span class="s">&#34;Gangbb&#34;</span><span class="o">,</span> <span class="mi">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;è·å–key1å€¼&#34;</span><span class="o">+</span> <span class="n">redisUtils</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;key1&#34;</span><span class="o">,</span> <span class="s">&#34;æµ‹è¯•redis&#34;</span><span class="o">,</span> <span class="mi">20</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s">&#34;æµ‹è¯•redis&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Cacheable</span><span class="o">(</span><span class="s">&#34;cache1&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/helloRedis2&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">helloRedis2</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s">&#34;xxredis&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Cacheable</span><span class="o">(</span><span class="s">&#34;cache2&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/helloRedis3&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">JSONObject</span> <span class="nf">helloRedis3</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">getTestDetail</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">JSONObject</span> <span class="nf">getTestDetail</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">JSONObject</span> <span class="n">retJson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">retCode</span> <span class="o">=</span> <span class="s">&#34;1&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">retMsg</span> <span class="o">=</span> <span class="s">&#34;æ“ä½œå¤±è´¥ï¼&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">JSONObject</span> <span class="n">bizDataJson</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span><span class="o">.</span><span class="na">setUserId</span><span class="o">(</span><span class="mi">22L</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span><span class="o">.</span><span class="na">setUserName</span><span class="o">(</span><span class="s">&#34;bin&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">user</span><span class="o">.</span><span class="na">setEmail</span><span class="o">(</span><span class="s">&#34;78280@qq.com&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">key</span> <span class="o">=</span> <span class="s">&#34;user::&#34;</span><span class="o">+</span><span class="n">user</span><span class="o">.</span><span class="na">getUserId</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//å‘Redisä¸­ç¼“å­˜æ•°æ®ï¼Œ-1ä¸ºè®¾ç½®æ°¸ä¹…æ—¶æ•ˆ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// redisUtils.set(key, user,-1);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="n">bizDataJson</span> <span class="o">=</span> <span class="n">JSONObject</span><span class="o">.</span><span class="na">parseObject</span><span class="o">(</span><span class="n">JSON</span><span class="o">.</span><span class="na">toJSONString</span><span class="o">(</span><span class="n">user</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">retCode</span> <span class="o">=</span> <span class="s">&#34;0&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">retMsg</span> <span class="o">=</span> <span class="s">&#34;æ“ä½œæˆåŠŸï¼&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">valueOf</span><span class="o">(</span><span class="n">e</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">retJson</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;retCode&#34;</span><span class="o">,</span> <span class="n">retCode</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">retJson</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;retMsg&#34;</span><span class="o">,</span> <span class="n">retMsg</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">retJson</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;bizData&#34;</span><span class="o">,</span> <span class="n">bizDataJson</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">retJson</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/micro_hz/article/details/76599632">spring boot ç¼“å­˜@EnableCaching</a></p>
<p>ä½¿ç”¨<code>@Cacheable</code>æ—¶å­˜åˆ°redisä¸­çš„æ•°æ®æ˜¯<code>Hex</code>æ ¼å¼çš„</p>
<p>è§£å†³ï¼š<a href="https://blog.csdn.net/weixin_43849277/article/details/120058804">@EnableCachingä¸@Cacheableçš„ä½¿ç”¨æ–¹æ³•ï¼Œç»“åˆredisè¿›è¡Œè¯´æ˜</a></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableCaching</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">CacheManager</span> <span class="nf">cacheManager</span><span class="o">(</span><span class="n">RedisConnectionFactory</span> <span class="n">factory</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//Duration.ofSeconds(120)è®¾ç½®ç¼“å­˜é»˜è®¤è¿‡æœŸæ—¶é—´120ç§’
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">RedisCacheConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="n">RedisCacheConfiguration</span><span class="o">.</span><span class="na">defaultCacheConfig</span><span class="o">().</span><span class="na">entryTtl</span><span class="o">(</span><span class="n">Duration</span><span class="o">.</span><span class="na">ofSeconds</span><span class="o">(</span><span class="mi">120</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//è§£å†³ä½¿ç”¨@Cacheableï¼Œredisæ•°æ®åº“valueä¹±ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="na">serializeValuesWith</span><span class="o">(</span><span class="n">RedisSerializationContext</span><span class="o">.</span><span class="na">SerializationPair</span><span class="o">.</span><span class="na">fromSerializer</span><span class="o">(</span><span class="n">RedisSerializer</span><span class="o">.</span><span class="na">json</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">  <span class="n">RedisCacheManager</span> <span class="n">cacheManager</span> <span class="o">=</span> <span class="n">RedisCacheManager</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="n">factory</span><span class="o">).</span><span class="na">cacheDefaults</span><span class="o">(</span><span class="n">config</span><span class="o">).</span><span class="na">build</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">cacheManager</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<h3 id="6-mybatisä½¿ç”¨redisåšäºŒçº§ç¼“å­˜">6. Mybatisä½¿ç”¨RedisåšäºŒçº§ç¼“å­˜<a hidden class="anchor" aria-hidden="true" href="#6-mybatisä½¿ç”¨redisåšäºŒçº§ç¼“å­˜">#</a></h3>
<p>è¿˜æœªå®ç°</p>
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/qq_37132495/article/details/114692613">ä»é›¶æ­å»ºè‹¥ä¾(Ruoyi-Vue)ç®¡ç†ç³»ç»Ÿ(6)&ndash;æ•´åˆRedisç¼“å­˜</a></p>
</blockquote>
<h2 id="å›½é™…åŒ–æ¶ˆæ¯å¤„ç†">å›½é™…åŒ–æ¶ˆæ¯å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#å›½é™…åŒ–æ¶ˆæ¯å¤„ç†">#</a></h2>
<h3 id="1-è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç ">1. è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç <a hidden class="anchor" aria-hidden="true" href="#1-è®¾ç½®é¡¹ç›®æ–‡ä»¶ç¼–ç ">#</a></h3>
<p>éœ€è¦å°†propertiesçš„æ–‡ä»¶ç¼–ç è®¾ç½®æˆ<code>utf-8</code>ï¼Œå¦åˆ™ä¼šå‡ºç°ä¹±ç <code>????</code></p>
<p><img loading="lazy" src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348507.png" alt="image-20220824213206910"  />
</p>
<h3 id="2-æ–°å»ºä¸€ä¸ªresourse-bundle">2. æ–°å»ºä¸€ä¸ªResourse Bundle<a hidden class="anchor" aria-hidden="true" href="#2-æ–°å»ºä¸€ä¸ªresourse-bundle">#</a></h3>
<ol>
<li>åœ¨<code>lab-admin</code>çš„<code>resources</code>ç›®å½•ä¸‹æ–°å»º<code>i8n</code>æ–‡ä»¶å¤¹å‚¨å­˜æ‰€æœ‰å›½é™…åŒ–æ–‡æœ¬å±æ€§ã€‚</li>
<li>æ–°å»ºmessages <code>Resourse Bundle</code></li>
</ol>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348523.png" alt="image-20220824212732662" style="zoom:67%;" />  
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348536.png" alt="image-20220824212744713" style="zoom:80%;" /> 
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/m0_52241823/article/details/121850065">idea 2021. 2.3 ä¸­ä½¿ç”¨springboot å›½é™…åŒ– Resource Bundleä¸æ˜¾ç¤ºé—®é¢˜</a></p>
</blockquote>
<h3 id="2-å›½é™…åŒ–å·¥å…·ç±»">2. å›½é™…åŒ–å·¥å…·ç±»<a hidden class="anchor" aria-hidden="true" href="#2-å›½é™…åŒ–å·¥å…·ç±»">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MessageUtils</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ ¹æ®æ¶ˆæ¯é”®å’Œå‚æ•° è·å–æ¶ˆæ¯ å§”æ‰˜ç»™spring messageSource
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param code æ¶ˆæ¯é”®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param args å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return è·å–å›½é™…åŒ–ç¿»è¯‘å€¼
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">message</span><span class="o">(</span><span class="n">String</span> <span class="n">code</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">MessageSource</span> <span class="n">messageSource</span> <span class="o">=</span> <span class="n">SpringUtils</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">MessageSource</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">messageSource</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">args</span><span class="o">,</span> <span class="n">LocaleContextHolder</span><span class="o">.</span><span class="na">getLocale</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">code</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-æµ‹è¯•ä½¿ç”¨">4. æµ‹è¯•ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#4-æµ‹è¯•ä½¿ç”¨">#</a></h3>
<p>å‰ç«¯è¯·æ±‚æ¥å£æ—¶åœ¨è¯·æ±‚å¤´<code>Accept-Language</code>é™„å¸¦è¯­è¨€ä¿¡æ¯ï¼ˆä¸­æ–‡ï¼šzh-cnï¼›è‹±æ–‡ï¼šen-usï¼›ä¸è®¾ç½®é»˜è®¤ä¸­æ–‡ï¼‰<strong>æ³¨æ„ä¸­é—´æ˜¯ä¸€ä¸ªæ¨ªæ ä¸æ˜¯ä¸‹åˆ’çº¿ï¼Œä¸propertiesæ–‡ä»¶æœ‰åŒºåˆ«</strong></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348550.png" alt="image-20220824212936716" style="zoom:80%;" /> 
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/message&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">MessageUtils</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="s">&#34;user.login.success&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç»Ÿä¸€å¯¹è±¡è¿”å›å’Œå¼‚å¸¸å¤„ç†">ç»Ÿä¸€å¯¹è±¡è¿”å›å’Œå¼‚å¸¸å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#ç»Ÿä¸€å¯¹è±¡è¿”å›å’Œå¼‚å¸¸å¤„ç†">#</a></h2>
<h3 id="1-å®šä¹‰ç»Ÿä¸€è¿”å›å¯¹è±¡">1. å®šä¹‰ç»Ÿä¸€è¿”å›å¯¹è±¡<a hidden class="anchor" aria-hidden="true" href="#1-å®šä¹‰ç»Ÿä¸€è¿”å›å¯¹è±¡">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApiResponse</span> <span class="kd">extends</span> <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** çŠ¶æ€ç  */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">CODE_TAG</span> <span class="o">=</span> <span class="s">&#34;code&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** è¿”å›å†…å®¹ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">MSG_TAG</span> <span class="o">=</span> <span class="s">&#34;msg&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ•°æ®å¯¹è±¡ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">DATA_TAG</span> <span class="o">=</span> <span class="s">&#34;data&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆå§‹åŒ–ä¸€ä¸ªæ–°åˆ›å»ºçš„ ApiResponse å¯¹è±¡ï¼Œä½¿å…¶è¡¨ç¤ºä¸€ä¸ªç©ºæ¶ˆæ¯ã€‚
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">ApiResponse</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆå§‹åŒ–ä¸€ä¸ªæ–°åˆ›å»ºçš„ ApiResponse å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param code çŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">ApiResponse</span><span class="o">(</span><span class="kt">int</span> <span class="n">code</span><span class="o">,</span> <span class="n">String</span> <span class="n">msg</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">super</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">CODE_TAG</span><span class="o">,</span> <span class="n">code</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">super</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">MSG_TAG</span><span class="o">,</span> <span class="n">msg</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆå§‹åŒ–ä¸€ä¸ªæ–°åˆ›å»ºçš„ ApiResponse å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param code çŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param data æ•°æ®å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="nf">ApiResponse</span><span class="o">(</span><span class="kt">int</span> <span class="n">code</span><span class="o">,</span> <span class="n">String</span> <span class="n">msg</span><span class="o">,</span> <span class="n">Object</span> <span class="n">data</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">super</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">CODE_TAG</span><span class="o">,</span> <span class="n">code</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="kd">super</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">MSG_TAG</span><span class="o">,</span> <span class="n">msg</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">data</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kd">super</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">DATA_TAG</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">success</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="s">&#34;æ“ä½œæˆåŠŸ&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›æˆåŠŸæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">success</span><span class="o">(</span><span class="n">Object</span> <span class="n">data</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="s">&#34;æ“ä½œæˆåŠŸ&#34;</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">success</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="n">msg</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param data æ•°æ®å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return æˆåŠŸæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">success</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">,</span> <span class="n">Object</span> <span class="n">data</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiResponse</span><span class="o">(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">SUCCESS</span><span class="o">,</span> <span class="n">msg</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›é”™è¯¯æ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">error</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;æ“ä½œå¤±è´¥&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›é”™è¯¯æ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return è­¦å‘Šæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">error</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">msg</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›é”™è¯¯æ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param data æ•°æ®å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return è­¦å‘Šæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">error</span><span class="o">(</span><span class="n">String</span> <span class="n">msg</span><span class="o">,</span> <span class="n">Object</span> <span class="n">data</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiResponse</span><span class="o">(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">ERROR</span><span class="o">,</span> <span class="n">msg</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è¿”å›é”™è¯¯æ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param code çŠ¶æ€ç 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param msg è¿”å›å†…å®¹
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return è­¦å‘Šæ¶ˆæ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">ApiResponse</span> <span class="nf">error</span><span class="o">(</span><span class="kt">int</span> <span class="n">code</span><span class="o">,</span> <span class="n">String</span> <span class="n">msg</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiResponse</span><span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">msg</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ–¹ä¾¿é“¾å¼è°ƒç”¨
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param key é”®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param value å€¼
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return æ•°æ®å¯¹è±¡
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">put</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">super</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-è‡ªå®šä¹‰å¼‚å¸¸ç±»åŠé”™è¯¯ç è§„èŒƒ">2. è‡ªå®šä¹‰å¼‚å¸¸ç±»åŠé”™è¯¯ç è§„èŒƒ<a hidden class="anchor" aria-hidden="true" href="#2-è‡ªå®šä¹‰å¼‚å¸¸ç±»åŠé”™è¯¯ç è§„èŒƒ">#</a></h3>
<p><strong>å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰å¼‚å¸¸ç±»ï¼ŒæŠ›å‡ºæ—¶ä¼ å…¥ä¸åŒçš„çŠ¶æ€ç  ï¼Œé€šè¿‡ä¸åŒçŠ¶æ€ç ä»¥åŠ<code>messages.properties</code>ä¸­å¯¹åº”çš„é”™è¯¯ä¿¡æ¯åŒºåˆ†ä¸åŒå¼‚å¸¸ã€‚åªè¦å¯¹çŠ¶æ€ç æœ‰ä¸€ä¸ªç»Ÿä¸€å®šä¹‰è§„èŒƒå°±èƒ½æœ‰æ•ˆåŒºåˆ†ä¸åŒå¼‚å¸¸è¿›è¡Œç®¡ç†</strong></p>
<p><strong>è‡ªå®šä¹‰å¼‚å¸¸ç±»<code>ServiceException</code></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">final</span> <span class="kd">class</span> <span class="nc">ServiceException</span> <span class="kd">extends</span> <span class="n">RuntimeException</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é”™è¯¯ç 
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">code</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é”™è¯¯æç¤º
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">message</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>message.properties</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">user.email.not.valid</span><span class="o">=</span><span class="s">é‚®ç®±æ ¼å¼é”™è¯¯</span>
</span></span><span class="line"><span class="cl"><span class="na">user.mobile.phone.number.not.valid</span><span class="o">=</span><span class="s">æ‰‹æœºå·æ ¼å¼é”™è¯¯</span>
</span></span><span class="line"><span class="cl"><span class="na">user.login.success</span><span class="o">=</span><span class="s">ç™»å½•æˆåŠŸ</span>
</span></span><span class="line"><span class="cl"><span class="na">user.register.success</span><span class="o">=</span><span class="s">æ³¨å†ŒæˆåŠŸ</span>
</span></span><span class="line"><span class="cl"><span class="na">user.notfound</span><span class="o">=</span><span class="s">è¯·é‡æ–°ç™»å½•</span>
</span></span><span class="line"><span class="cl"><span class="na">user.forcelogout</span><span class="o">=</span><span class="s">ç®¡ç†å‘˜å¼ºåˆ¶é€€å‡ºï¼Œè¯·é‡æ–°ç™»å½•</span>
</span></span><span class="line"><span class="cl"><span class="na">user.unknown.error</span><span class="o">=</span><span class="s">æœªçŸ¥é”™è¯¯ï¼Œè¯·é‡æ–°ç™»å½•</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><img loading="lazy" src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348563.png" alt="image-20220824214635329"  />
</p>
<h3 id="3-å…¨å±€å¼‚å¸¸å¤„ç†">3. å…¨å±€å¼‚å¸¸å¤„ç†<a hidden class="anchor" aria-hidden="true" href="#3-å…¨å±€å¼‚å¸¸å¤„ç†">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Slf4j</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RestControllerAdvice</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä¸šåŠ¡å¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">ServiceException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleServiceException</span><span class="o">(</span><span class="n">ServiceException</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ],å‘ç”Ÿä¸šåŠ¡å¼‚å¸¸.&#34;</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Integer</span> <span class="n">code</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">code</span><span class="o">)</span> <span class="o">?</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">())</span> <span class="o">:</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ‹¦æˆªæœªçŸ¥çš„è¿è¡Œæ—¶å¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">RuntimeException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleRuntimeException</span><span class="o">(</span><span class="n">RuntimeException</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ],å‘ç”ŸæœªçŸ¥å¼‚å¸¸.&#34;</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ç³»ç»Ÿå¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleException</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ],å‘ç”Ÿç³»ç»Ÿå¼‚å¸¸.&#34;</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-å¼‚å¸¸æµ‹è¯•">4. å¼‚å¸¸æµ‹è¯•<a hidden class="anchor" aria-hidden="true" href="#4-å¼‚å¸¸æµ‹è¯•">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/exception&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">exception</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span><span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">throw</span> <span class="k">new</span> <span class="n">ServiceException</span><span class="o">(</span><span class="n">MessageUtils</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="s">&#34;service.division.byZero&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="n">a</span> <span class="o">/</span> <span class="mf">0.5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="mybatiasåˆ†é¡µæ”¯æŒ">Mybatiasåˆ†é¡µæ”¯æŒ<a hidden class="anchor" aria-hidden="true" href="#mybatiasåˆ†é¡µæ”¯æŒ">#</a></h2>
<h3 id="1-å¼•å…¥ä¾èµ–">1. å¼•å…¥ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1-å¼•å…¥ä¾èµ–">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="c">&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencies&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2-é…ç½®yml">2. é…ç½®yml<a hidden class="anchor" aria-hidden="true" href="#2-é…ç½®yml">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># PageHelperåˆ†é¡µæ’ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">pagehelper</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æŒ‡å®šåˆ†é¡µæ’ä»¶ä½¿ç”¨å“ªç§æ•°æ®åº“æ–¹è¨€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">helperDialect</span><span class="p">:</span><span class="w"> </span><span class="l">mysql</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># å½“è¯¥å‚æ•°è®¾ç½®ä¸º true æ—¶ï¼ŒpageNum&lt;=0 æ—¶ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œ pageNum&gt;pagesï¼ˆè¶…è¿‡æ€»æ•°æ—¶ï¼‰ï¼Œä¼šæŸ¥è¯¢æœ€åä¸€é¡µã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># reasonable: true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æ”¯æŒé€šè¿‡ Mapper æ¥å£å‚æ•°æ¥ä¼ é€’åˆ†é¡µå‚æ•°ï¼Œé»˜è®¤å€¼falseï¼Œåˆ†é¡µæ’ä»¶ä¼šä»æŸ¥è¯¢æ–¹æ³•çš„å‚æ•°å€¼ä¸­ï¼Œ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># è‡ªåŠ¨æ ¹æ®ä¸Šé¢ params é…ç½®çš„å­—æ®µä¸­å–å€¼ï¼ŒæŸ¥æ‰¾åˆ°åˆé€‚çš„å€¼æ—¶å°±ä¼šè‡ªåŠ¨åˆ†é¡µã€‚</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">supportMethodsArguments</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># å¢åŠ äº†è¯¥å‚æ•°æ¥é…ç½®å‚æ•°æ˜ å°„ï¼Œç”¨äºä»å¯¹è±¡ä¸­æ ¹æ®å±æ€§åå–å€¼</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">params</span><span class="p">:</span><span class="w"> </span><span class="l">count=countSql</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰€æœ‰é…ç½®é¡¹ï¼š</p>
<blockquote>
<ol>
<li><code>helperDialect</code>ï¼šåˆ†é¡µæ’ä»¶ä¼šè‡ªåŠ¨æ£€æµ‹å½“å‰çš„æ•°æ®åº“é“¾æ¥ï¼Œè‡ªåŠ¨é€‰æ‹©åˆé€‚çš„åˆ†é¡µæ–¹å¼ã€‚ ä½ å¯ä»¥é…ç½®<code>helperDialect</code>å±æ€§æ¥æŒ‡å®šåˆ†é¡µæ’ä»¶ä½¿ç”¨å“ªç§æ–¹è¨€ã€‚é…ç½®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„ç¼©å†™å€¼ï¼š
<code>oracle</code>,<code>mysql</code>,<code>mariadb</code>,<code>sqlite</code>,<code>hsqldb</code>,<code>postgresql</code>,<code>db2</code>,<code>sqlserver</code>,<code>informix</code>,<code>h2</code>,<code>sqlserver2012</code>,<code>derby</code>
**ç‰¹åˆ«æ³¨æ„ï¼š**ä½¿ç”¨ SqlServer2012 æ•°æ®åº“æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šä¸º <code>sqlserver2012</code>ï¼Œå¦åˆ™ä¼šä½¿ç”¨ SqlServer2005 çš„æ–¹å¼è¿›è¡Œåˆ†é¡µã€‚
ä½ ä¹Ÿå¯ä»¥å®ç° <code>AbstractHelperDialect</code>ï¼Œç„¶åé…ç½®è¯¥å±æ€§ä¸ºå®ç°ç±»çš„å…¨é™å®šåç§°å³å¯ä½¿ç”¨è‡ªå®šä¹‰çš„å®ç°æ–¹æ³•ã€‚</li>
<li><code>offsetAsPageNum</code>ï¼šé»˜è®¤å€¼ä¸º <code>false</code>ï¼Œè¯¥å‚æ•°å¯¹ä½¿ç”¨ <code>RowBounds</code> ä½œä¸ºåˆ†é¡µå‚æ•°æ—¶æœ‰æ•ˆã€‚ å½“è¯¥å‚æ•°è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œä¼šå°† <code>RowBounds</code> ä¸­çš„ <code>offset</code> å‚æ•°å½“æˆ <code>pageNum</code> ä½¿ç”¨ï¼Œå¯ä»¥ç”¨é¡µç å’Œé¡µé¢å¤§å°ä¸¤ä¸ªå‚æ•°è¿›è¡Œåˆ†é¡µã€‚</li>
<li><code>rowBoundsWithCount</code>ï¼šé»˜è®¤å€¼ä¸º<code>false</code>ï¼Œè¯¥å‚æ•°å¯¹ä½¿ç”¨ <code>RowBounds</code> ä½œä¸ºåˆ†é¡µå‚æ•°æ—¶æœ‰æ•ˆã€‚ å½“è¯¥å‚æ•°è®¾ç½®ä¸º<code>true</code>æ—¶ï¼Œä½¿ç”¨ <code>RowBounds</code> åˆ†é¡µä¼šè¿›è¡Œ count æŸ¥è¯¢ã€‚</li>
<li><code>pageSizeZero</code>ï¼šé»˜è®¤å€¼ä¸º <code>false</code>ï¼Œå½“è¯¥å‚æ•°è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œå¦‚æœ <code>pageSize=0</code> æˆ–è€… <code>RowBounds.limit = 0</code> å°±ä¼šæŸ¥è¯¢å‡ºå…¨éƒ¨çš„ç»“æœï¼ˆç›¸å½“äºæ²¡æœ‰æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢ï¼Œä½†æ˜¯è¿”å›ç»“æœä»ç„¶æ˜¯ <code>Page</code> ç±»å‹ï¼‰ã€‚</li>
<li><code>reasonable</code>ï¼šåˆ†é¡µåˆç†åŒ–å‚æ•°ï¼Œé»˜è®¤å€¼ä¸º<code>false</code>ã€‚å½“è¯¥å‚æ•°è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œ<code>pageNum&lt;=0</code> æ—¶ä¼šæŸ¥è¯¢ç¬¬ä¸€é¡µï¼Œ <code>pageNum&gt;pages</code>ï¼ˆè¶…è¿‡æ€»æ•°æ—¶ï¼‰ï¼Œä¼šæŸ¥è¯¢æœ€åä¸€é¡µã€‚é»˜è®¤<code>false</code> æ—¶ï¼Œç›´æ¥æ ¹æ®å‚æ•°è¿›è¡ŒæŸ¥è¯¢ã€‚</li>
<li><code>params</code>ï¼šä¸ºäº†æ”¯æŒ<code>startPage(Object params)</code>æ–¹æ³•ï¼Œå¢åŠ äº†è¯¥å‚æ•°æ¥é…ç½®å‚æ•°æ˜ å°„ï¼Œç”¨äºä»å¯¹è±¡ä¸­æ ¹æ®å±æ€§åå–å€¼ï¼Œ å¯ä»¥é…ç½® <code>pageNum,pageSize,count,pageSizeZero,reasonable</code>ï¼Œä¸é…ç½®æ˜ å°„çš„ç”¨é»˜è®¤å€¼ï¼Œ é»˜è®¤å€¼ä¸º<code>pageNum=pageNum;pageSize=pageSize;count=countSql;reasonable=reasonable;pageSizeZero=pageSizeZero</code>ã€‚</li>
<li><code>supportMethodsArguments</code>ï¼šæ”¯æŒé€šè¿‡ Mapper æ¥å£å‚æ•°æ¥ä¼ é€’åˆ†é¡µå‚æ•°ï¼Œé»˜è®¤å€¼<code>false</code>ï¼Œåˆ†é¡µæ’ä»¶ä¼šä»æŸ¥è¯¢æ–¹æ³•çš„å‚æ•°å€¼ä¸­ï¼Œè‡ªåŠ¨æ ¹æ®ä¸Šé¢ <code>params</code> é…ç½®çš„å­—æ®µä¸­å–å€¼ï¼ŒæŸ¥æ‰¾åˆ°åˆé€‚çš„å€¼æ—¶å°±ä¼šè‡ªåŠ¨åˆ†é¡µã€‚ ä½¿ç”¨æ–¹æ³•å¯ä»¥å‚è€ƒæµ‹è¯•ä»£ç ä¸­çš„ <code>com.github.pagehelper.test.basic</code> åŒ…ä¸‹çš„ <code>ArgumentsMapTest</code> å’Œ <code>ArgumentsObjTest</code>ã€‚</li>
<li><code>autoRuntimeDialect</code>ï¼šé»˜è®¤å€¼ä¸º <code>false</code>ã€‚è®¾ç½®ä¸º <code>true</code> æ—¶ï¼Œå…è®¸åœ¨è¿è¡Œæ—¶æ ¹æ®å¤šæ•°æ®æºè‡ªåŠ¨è¯†åˆ«å¯¹åº”æ–¹è¨€çš„åˆ†é¡µ ï¼ˆä¸æ”¯æŒè‡ªåŠ¨é€‰æ‹©<code>sqlserver2012</code>ï¼Œåªèƒ½ä½¿ç”¨<code>sqlserver</code>ï¼‰ï¼Œç”¨æ³•å’Œæ³¨æ„äº‹é¡¹å‚è€ƒä¸‹é¢çš„<strong>åœºæ™¯äº”</strong>ã€‚</li>
<li><code>closeConn</code>ï¼šé»˜è®¤å€¼ä¸º <code>true</code>ã€‚å½“ä½¿ç”¨è¿è¡Œæ—¶åŠ¨æ€æ•°æ®æºæˆ–æ²¡æœ‰è®¾ç½® <code>helperDialect</code> å±æ€§è‡ªåŠ¨è·å–æ•°æ®åº“ç±»å‹æ—¶ï¼Œä¼šè‡ªåŠ¨è·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œ é€šè¿‡è¯¥å±æ€§æ¥è®¾ç½®æ˜¯å¦å…³é—­è·å–çš„è¿™ä¸ªè¿æ¥ï¼Œé»˜è®¤<code>true</code>å…³é—­ï¼Œè®¾ç½®ä¸º <code>false</code> åï¼Œä¸ä¼šå…³é—­è·å–çš„è¿æ¥ï¼Œè¿™ä¸ªå‚æ•°çš„è®¾ç½®è¦æ ¹æ®è‡ªå·±é€‰æ‹©çš„æ•°æ®æºæ¥å†³å®šã€‚</li>
<li><code>aggregateFunctions</code>(5.1.5+)ï¼šé»˜è®¤ä¸ºæ‰€æœ‰å¸¸è§æ•°æ®åº“çš„èšåˆå‡½æ•°ï¼Œå…è®¸æ‰‹åŠ¨æ·»åŠ èšåˆå‡½æ•°ï¼ˆå½±å“è¡Œæ•°ï¼‰ï¼Œæ‰€æœ‰ä»¥èšåˆå‡½æ•°å¼€å¤´çš„å‡½æ•°ï¼Œåœ¨è¿›è¡Œ count è½¬æ¢æ—¶ï¼Œä¼šå¥—ä¸€å±‚ã€‚å…¶ä»–å‡½æ•°å’Œåˆ—ä¼šè¢«æ›¿æ¢ä¸º count(0)ï¼Œå…¶ä¸­countåˆ—å¯ä»¥è‡ªå·±é…ç½®ã€‚</li>
</ol>
</blockquote>
<p><strong>æ›´å¤šä¿¡æ¯å¯ä»¥å¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£ï¼š</strong></p>
<p><a href="https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md">https://github.com/pagehelper/Mybatis-PageHelper/blob/master/wikis/zh/HowToUse.md</a></p>
<h3 id="3-å°è£…åˆ†é¡µç›¸å…³å·¥å…·">3. å°è£…åˆ†é¡µç›¸å…³å·¥å…·<a hidden class="anchor" aria-hidden="true" href="#3-å°è£…åˆ†é¡µç›¸å…³å·¥å…·">#</a></h3>
<h4 id="31-basecontroller">3.1 BaseController<a hidden class="anchor" aria-hidden="true" href="#31-basecontroller">#</a></h4>
<p>è¿™æ˜¯ä¸€ä¸ªwebå±‚é€šç”¨å¤„ç†ç±»ã€‚æ ¸å¿ƒæ–¹æ³•<code>startPage()</code>è¯·æ±‚åˆ†é¡µæ•°æ®æ–¹æ³•ï¼Œä½¿ç»§æ‰¿<code>BaseController</code>çš„Controllerå¯ä»¥å¿«é€Ÿä½¿ç”¨åˆ†é¡µã€‚</p>
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/wang0907/article/details/108357696">springMVCä¹‹@InitBinderçš„ç”¨æ³•</a></p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Slf4j</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">BaseController</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// protected final Logger logger = LoggerFactory.getLogger(this.getClass());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å°†å‰å°ä¼ é€’è¿‡æ¥çš„æ—¥æœŸæ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œè‡ªåŠ¨è½¬åŒ–ä¸ºDateç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@InitBinder</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initBinder</span><span class="o">(</span><span class="n">WebDataBinder</span> <span class="n">binder</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Date ç±»å‹è½¬æ¢
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">binder</span><span class="o">.</span><span class="na">registerCustomEditor</span><span class="o">(</span><span class="n">Date</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="k">new</span> <span class="n">PropertyEditorSupport</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAsText</span><span class="o">(</span><span class="n">String</span> <span class="n">text</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">setValue</span><span class="o">(</span><span class="n">DateUtils</span><span class="o">.</span><span class="na">parseDate</span><span class="o">(</span><span class="n">text</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è®¾ç½®è¯·æ±‚åˆ†é¡µæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">startPage</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">PageUtils</span><span class="o">.</span><span class="na">startPage</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è®¾ç½®è¯·æ±‚æ’åºæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">startOrderBy</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">PageDomain</span> <span class="n">pageDomain</span> <span class="o">=</span> <span class="n">TableSupport</span><span class="o">.</span><span class="na">buildPageRequest</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotEmpty</span><span class="o">(</span><span class="n">pageDomain</span><span class="o">.</span><span class="na">getOrderBy</span><span class="o">()))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">orderBy</span> <span class="o">=</span> <span class="n">SqlUtil</span><span class="o">.</span><span class="na">escapeOrderBySql</span><span class="o">(</span><span class="n">pageDomain</span><span class="o">.</span><span class="na">getOrderBy</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">PageHelper</span><span class="o">.</span><span class="na">orderBy</span><span class="o">(</span><span class="n">orderBy</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ¸…ç†åˆ†é¡µçš„çº¿ç¨‹å˜é‡
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">clearPage</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">PageUtils</span><span class="o">.</span><span class="na">clearPage</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å“åº”è¯·æ±‚åˆ†é¡µæ•°æ®
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@SuppressWarnings</span><span class="o">({</span> <span class="s">&#34;rawtypes&#34;</span><span class="o">,</span> <span class="s">&#34;unchecked&#34;</span> <span class="o">})</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="n">TableDataInfo</span> <span class="nf">getDataTable</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">list</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">TableDataInfo</span> <span class="n">rspData</span> <span class="o">=</span> <span class="k">new</span> <span class="n">TableDataInfo</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">rspData</span><span class="o">.</span><span class="na">setCode</span><span class="o">(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">SUCCESS</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rspData</span><span class="o">.</span><span class="na">setMsg</span><span class="o">(</span><span class="s">&#34;æŸ¥è¯¢æˆåŠŸ&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rspData</span><span class="o">.</span><span class="na">setRows</span><span class="o">(</span><span class="n">list</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">rspData</span><span class="o">.</span><span class="na">setTotal</span><span class="o">(</span><span class="k">new</span> <span class="n">PageInfo</span><span class="o">(</span><span class="n">list</span><span class="o">).</span><span class="na">getTotal</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">rspData</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="32-tabledatainfo">3.2 TableDataInfo<a hidden class="anchor" aria-hidden="true" href="#32-tabledatainfo">#</a></h4>
<p>è‡ªå®šä¹‰åˆ†é¡µç»“æœ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TableDataInfo</span> <span class="kd">implements</span> <span class="n">Serializable</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="mi">1L</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ€»è®°å½•æ•° */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">long</span> <span class="n">total</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** åˆ—è¡¨æ•°æ® */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;?&gt;</span> <span class="n">rows</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ¶ˆæ¯çŠ¶æ€ç  */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">int</span> <span class="n">code</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ¶ˆæ¯å†…å®¹ */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">msg</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="33-æ•°æ®ä¼ è¾“ç±»pagedto">3.3 æ•°æ®ä¼ è¾“ç±»PageDTO<a hidden class="anchor" aria-hidden="true" href="#33-æ•°æ®ä¼ è¾“ç±»pagedto">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JAVA" data-lang="JAVA"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PageDTO</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/** å½“å‰è®°å½•èµ·å§‹ç´¢å¼• */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">pageNum</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ¯é¡µæ˜¾ç¤ºè®°å½•æ•° */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">pageSize</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ’åºåˆ— */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">orderByColumn</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ’åºçš„æ–¹å‘descæˆ–è€…asc */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">isAsc</span> <span class="o">=</span> <span class="s">&#34;asc&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** åˆ†é¡µå‚æ•°åˆç†åŒ– */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">Boolean</span> <span class="n">reasonable</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-æµ‹è¯•">4. æµ‹è¯•<a hidden class="anchor" aria-hidden="true" href="#4-æµ‹è¯•">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æŸ¥è¯¢åˆ—è¡¨ï¼Œåˆ†é¡µã€‚ è¿”å› TableDataInfo
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/page&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">TableDataInfo</span> <span class="nf">testPageHelper</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">startPage</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">SysOperLog</span><span class="o">&gt;</span> <span class="n">sysOperationLogs</span> <span class="o">=</span> <span class="n">sysOperLogService</span><span class="o">.</span><span class="na">selectAll</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">getDataTable</span><span class="o">(</span><span class="n">sysOperationLogs</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>	
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectAll&#34;</span> <span class="na">resultType=</span><span class="s">&#34;SysOperLog&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    select * from sys_oper_log
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348791.png" alt="image-20220825143144983" style="zoom:67%;" /> 
<h2 id="swaggeré›†æˆ">Swaggeré›†æˆ<a hidden class="anchor" aria-hidden="true" href="#swaggeré›†æˆ">#</a></h2>
<h3 id="1pomä¾èµ–">1.pomä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1pomä¾èµ–">#</a></h3>
<p>çˆ¶çº§pom</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;swagger.version&gt;</span>3.0.0<span class="nt">&lt;/swagger.version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- Swagger3ä¾èµ– --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>io.springfox<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>springfox-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>${swagger.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>io.swagger<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>swagger-models<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>admin pom</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!-- swagger3--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>io.springfox<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>springfox-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- é˜²æ­¢è¿›å…¥swaggeré¡µé¢æŠ¥ç±»å‹è½¬æ¢é”™è¯¯ï¼Œæ’é™¤3.0.0ä¸­çš„å¼•ç”¨ï¼Œæ‰‹åŠ¨å¢åŠ 1.6.2ç‰ˆæœ¬ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>io.swagger<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>swagger-models<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>1.6.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2swagger-config">2.swagger config<a hidden class="anchor" aria-hidden="true" href="#2swagger-config">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SwaggerConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç³»ç»ŸåŸºç¡€é…ç½® */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">LabConfig</span> <span class="n">labConfig</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ˜¯å¦å¼€å¯swagger */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Value</span><span class="o">(</span><span class="s">&#34;${swagger.enabled}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">enabled</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * åˆ›å»ºAPI
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Docket</span> <span class="nf">createRestApi</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">Docket</span><span class="o">(</span><span class="n">DocumentationType</span><span class="o">.</span><span class="na">OAS_30</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// æ˜¯å¦å¯ç”¨Swagger
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">enable</span><span class="o">(</span><span class="n">enabled</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// ç”¨æ¥åˆ›å»ºè¯¥APIçš„åŸºæœ¬ä¿¡æ¯ï¼Œå±•ç¤ºåœ¨æ–‡æ¡£çš„é¡µé¢ä¸­ï¼ˆè‡ªå®šä¹‰å±•ç¤ºçš„ä¿¡æ¯ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">apiInfo</span><span class="o">(</span><span class="n">apiInfo</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// è®¾ç½®å“ªäº›æ¥å£æš´éœ²ç»™Swaggerå±•ç¤º
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">select</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// æ‰«ææ‰€æœ‰æœ‰æ³¨è§£çš„apiï¼Œç”¨è¿™ç§æ–¹å¼æ›´çµæ´»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">apis</span><span class="o">(</span><span class="n">RequestHandlerSelectors</span><span class="o">.</span><span class="na">withMethodAnnotation</span><span class="o">(</span><span class="n">ApiOperation</span><span class="o">.</span><span class="na">class</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// æ‰«ææŒ‡å®šåŒ…ä¸­çš„swaggeræ³¨è§£
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// .apis(RequestHandlerSelectors.basePackage(&#34;com.opengms.project.tool.swagger&#34;))
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// æ‰«ææ‰€æœ‰ .apis(RequestHandlerSelectors.any())
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">paths</span><span class="o">(</span><span class="n">PathSelectors</span><span class="o">.</span><span class="na">any</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">build</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="cm">/* è®¾ç½®å®‰å…¨æ¨¡å¼ï¼Œswaggerå¯ä»¥è®¾ç½®è®¿é—®token */</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">securitySchemes</span><span class="o">(</span><span class="n">securitySchemes</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">securityContexts</span><span class="o">(</span><span class="n">securityContexts</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å®‰å…¨æ¨¡å¼ï¼Œè¿™é‡ŒæŒ‡å®štokené€šè¿‡Authorizationå¤´è¯·æ±‚å¤´ä¼ é€’
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SecurityScheme</span><span class="o">&gt;</span> <span class="nf">securitySchemes</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">SecurityScheme</span><span class="o">&gt;</span> <span class="n">apiKeyList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">SecurityScheme</span><span class="o">&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">apiKeyList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">ApiKey</span><span class="o">(</span><span class="s">&#34;Authorization&#34;</span><span class="o">,</span> <span class="s">&#34;Authorization&#34;</span><span class="o">,</span> <span class="n">In</span><span class="o">.</span><span class="na">HEADER</span><span class="o">.</span><span class="na">toValue</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">apiKeyList</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å®‰å…¨ä¸Šä¸‹æ–‡
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SecurityContext</span><span class="o">&gt;</span> <span class="nf">securityContexts</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">SecurityContext</span><span class="o">&gt;</span> <span class="n">securityContexts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">securityContexts</span><span class="o">.</span><span class="na">add</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="n">SecurityContext</span><span class="o">.</span><span class="na">builder</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="na">securityReferences</span><span class="o">(</span><span class="n">defaultAuth</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="na">operationSelector</span><span class="o">(</span><span class="n">o</span> <span class="o">-&gt;</span> <span class="n">o</span><span class="o">.</span><span class="na">requestMappingPattern</span><span class="o">().</span><span class="na">matches</span><span class="o">(</span><span class="s">&#34;/.*&#34;</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">                        <span class="o">.</span><span class="na">build</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">securityContexts</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é»˜è®¤çš„å®‰å…¨ä¸Šå¼•ç”¨
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">SecurityReference</span><span class="o">&gt;</span> <span class="nf">defaultAuth</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">AuthorizationScope</span> <span class="n">authorizationScope</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AuthorizationScope</span><span class="o">(</span><span class="s">&#34;global&#34;</span><span class="o">,</span> <span class="s">&#34;accessEverything&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">AuthorizationScope</span><span class="o">[]</span> <span class="n">authorizationScopes</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AuthorizationScope</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span>
</span></span><span class="line"><span class="cl">        <span class="n">authorizationScopes</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">=</span> <span class="n">authorizationScope</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">SecurityReference</span><span class="o">&gt;</span> <span class="n">securityReferences</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="n">securityReferences</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="k">new</span> <span class="n">SecurityReference</span><span class="o">(</span><span class="s">&#34;Authorization&#34;</span><span class="o">,</span> <span class="n">authorizationScopes</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">securityReferences</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ·»åŠ æ‘˜è¦ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">ApiInfo</span> <span class="nf">apiInfo</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ç”¨ApiInfoBuilderè¿›è¡Œå®šåˆ¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">ApiInfoBuilder</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// è®¾ç½®æ ‡é¢˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">title</span><span class="o">(</span><span class="s">&#34;OPENGMS LABæ¥å£æ–‡æ¡£&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// æè¿°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// .description(&#34;æ¥å£æ–‡æ¡£ description&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// ä½œè€…ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">contact</span><span class="o">(</span><span class="k">new</span> <span class="n">Contact</span><span class="o">(</span><span class="n">labConfig</span><span class="o">.</span><span class="na">getName</span><span class="o">(),</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// ç‰ˆæœ¬
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">version</span><span class="o">(</span><span class="s">&#34;ç‰ˆæœ¬å·:&#34;</span> <span class="o">+</span> <span class="n">labConfig</span><span class="o">.</span><span class="na">getVersion</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addResourceHandlers</span><span class="o">(</span><span class="n">ResourceHandlerRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="cm">/** swaggeré…ç½® */</span>
</span></span><span class="line"><span class="cl">        <span class="n">registry</span><span class="o">.</span><span class="na">addResourceHandler</span><span class="o">(</span><span class="s">&#34;/swagger-ui/**&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">.</span><span class="na">addResourceLocations</span><span class="o">(</span><span class="s">&#34;classpath:/META-INF/resources/webjars/springfox-swagger-ui/&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// registry.addResourceHandler(&#34;/**&#34;).addResourceLocations(&#34;classpath:/static/&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// // è§£å†³swaggeræ— æ³•è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// registry.addResourceHandler(&#34;/swagger-ui.html&#34;).addResourceLocations(&#34;classpath:/META-INF/resources/&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// // è§£å†³swaggerçš„jsæ–‡ä»¶æ— æ³•è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// registry.addResourceHandler(&#34;/webjars/**&#34;).addResourceLocations(&#34;classpath:/META-INF/resources/webjars/&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="3ä½¿ç”¨">3.ä½¿ç”¨<a hidden class="anchor" aria-hidden="true" href="#3ä½¿ç”¨">#</a></h3>
<blockquote>
<p>swagger2çš„3.0ç‰ˆæœ¬çš„è®¿é—®åœ°å€/swagger-ui/index.html 2.xä¹‹å‰è®¿é—®åœ°å€/swagger-ui.html</p>
</blockquote>
<p>è®¿é—®<code>http://localhost:8888/swagger-ui/index.html</code></p>
<p>ä½¿ç”¨<code>Swagger Tools</code>æ’ä»¶è‡ªåŠ¨ç”Ÿæˆæ¥å£æ–‡æ¡£æ³¨è§£ï¼š<code>Alt + Ins</code></p>
<img src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348805.png" alt="image-20220902153650357" style="zoom:80%;" /> 
<h3 id="4é›†æˆknife4j">4.é›†æˆKnife4j<a hidden class="anchor" aria-hidden="true" href="#4é›†æˆknife4j">#</a></h3>
<p>æ·»åŠ pom</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!-- knife4j --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;groupId&gt;</span>com.github.xiaoymin<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;artifactId&gt;</span>knife4j-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;version&gt;</span>3.0.3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è®¿é—®åœ°å€</p>
<p><code>http://localhost:8888/doc.html</code></p>
<h2 id="å‚æ•°é…ç½®">å‚æ•°é…ç½®<a hidden class="anchor" aria-hidden="true" href="#å‚æ•°é…ç½®">#</a></h2>
<h3 id="1åˆ›å»ºæ•°æ®åº“è¡¨">1.åˆ›å»ºæ•°æ®åº“è¡¨<a hidden class="anchor" aria-hidden="true" href="#1åˆ›å»ºæ•°æ®åº“è¡¨">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- å‚æ•°é…ç½®è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_config</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_config</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">config_id</span><span class="w">         </span><span class="nb">int</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w">          </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="w">    </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å‚æ•°ä¸»é”®&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">config_name</span><span class="w">       </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å‚æ•°åç§°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">config_key</span><span class="w">        </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å‚æ•°é”®å&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">config_value</span><span class="w">      </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å‚æ•°é”®å€¼&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">config_type</span><span class="w">       </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;N&#39;</span><span class="w">                </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç³»ç»Ÿå†…ç½®ï¼ˆYæ˜¯ Nå¦ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_by</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºè€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_time</span><span class="w">       </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºæ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_by</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°è€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_time</span><span class="w">       </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°æ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">remark</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="k">null</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å¤‡æ³¨&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">config_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="n">auto_increment</span><span class="o">=</span><span class="mi">100</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;å‚æ•°é…ç½®è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">sys_config</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ä¸»æ¡†æ¶é¡µ-é»˜è®¤çš®è‚¤æ ·å¼åç§°&#39;</span><span class="p">,</span><span class="w">     </span><span class="s1">&#39;sys.index.skinName&#39;</span><span class="p">,</span><span class="w">            </span><span class="s1">&#39;skin-blue&#39;</span><span class="p">,</span><span class="w">     </span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sysdate</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;è“è‰² skin-blueã€ç»¿è‰² skin-greenã€ç´«è‰² skin-purpleã€çº¢è‰² skin-redã€é»„è‰² skin-yellow&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">sys_config</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·ç®¡ç†-è´¦å·åˆå§‹å¯†ç &#39;</span><span class="p">,</span><span class="w">         </span><span class="s1">&#39;sys.user.initPassword&#39;</span><span class="p">,</span><span class="w">         </span><span class="s1">&#39;123456&#39;</span><span class="p">,</span><span class="w">        </span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sysdate</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;åˆå§‹åŒ–å¯†ç  123456&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">sys_config</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ä¸»æ¡†æ¶é¡µ-ä¾§è¾¹æ ä¸»é¢˜&#39;</span><span class="p">,</span><span class="w">           </span><span class="s1">&#39;sys.index.sideTheme&#39;</span><span class="p">,</span><span class="w">           </span><span class="s1">&#39;theme-dark&#39;</span><span class="p">,</span><span class="w">    </span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sysdate</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;æ·±è‰²ä¸»é¢˜theme-darkï¼Œæµ…è‰²ä¸»é¢˜theme-light&#39;</span><span class="w"> </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">sys_config</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;è´¦å·è‡ªåŠ©-éªŒè¯ç å¼€å…³&#39;</span><span class="p">,</span><span class="w">           </span><span class="s1">&#39;sys.account.captchaEnabled&#39;</span><span class="p">,</span><span class="w">    </span><span class="s1">&#39;true&#39;</span><span class="p">,</span><span class="w">          </span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sysdate</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;æ˜¯å¦å¼€å¯éªŒè¯ç åŠŸèƒ½ï¼ˆtrueå¼€å¯ï¼Œfalseå…³é—­ï¼‰&#39;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">insert</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">sys_config</span><span class="w"> </span><span class="k">values</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;è´¦å·è‡ªåŠ©-æ˜¯å¦å¼€å¯ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;sys.account.registerUser&#39;</span><span class="p">,</span><span class="w">      </span><span class="s1">&#39;false&#39;</span><span class="p">,</span><span class="w">         </span><span class="s1">&#39;Y&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;admin&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sysdate</span><span class="p">(),</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">null</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;æ˜¯å¦å¼€å¯æ³¨å†Œç”¨æˆ·åŠŸèƒ½ï¼ˆtrueå¼€å¯ï¼Œfalseå…³é—­ï¼‰&#39;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2åˆå§‹åŒ–å‚æ•°">2.åˆå§‹åŒ–å‚æ•°<a hidden class="anchor" aria-hidden="true" href="#2åˆå§‹åŒ–å‚æ•°">#</a></h3>
<p><code>SysConfigServiceImpl</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * é¡¹ç›®å¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–å‚æ•°åˆ°ç¼“å­˜
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@PostConstruct</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">init</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">loadingConfigCache</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="ç™»å½•å’Œæˆæƒ">ç™»å½•å’Œæˆæƒ<a hidden class="anchor" aria-hidden="true" href="#ç™»å½•å’Œæˆæƒ">#</a></h2>
<h3 id="ç™»å½•å®ç°">ç™»å½•å®ç°<a hidden class="anchor" aria-hidden="true" href="#ç™»å½•å®ç°">#</a></h3>
<h4 id="1å¼•å…¥-spring-security-æ¨¡å—">1.å¼•å…¥ Spring Security æ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#1å¼•å…¥-spring-security-æ¨¡å—">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-security<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¼•å…¥ä¾èµ–åæˆ‘ä»¬åœ¨å°è¯•å»è®¿é—®ä¹‹å‰çš„æ¥å£å°±ä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸€ä¸ªSpringSecurityçš„é»˜è®¤ç™»é™†é¡µé¢ï¼Œé»˜è®¤ç”¨æˆ·åæ˜¯user,å¯†ç ä¼šè¾“å‡ºåœ¨æ§åˆ¶å°ã€‚ å¿…é¡»ç™»é™†ä¹‹åæ‰èƒ½å¯¹æ¥å£è¿›è¡Œè®¿é—®ã€‚</p>
<h4 id="2ç¼–å†™-spring-security-é…ç½®ç±»">2.ç¼–å†™ Spring Security é…ç½®ç±»<a hidden class="anchor" aria-hidden="true" href="#2ç¼–å†™-spring-security-é…ç½®ç±»">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@EnableGlobalMethodSecurity</span><span class="o">(</span><span class="n">prePostEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">securedEnabled</span> <span class="o">=</span> <span class="kc">true</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SecurityConfig</span> <span class="kd">extends</span> <span class="n">WebSecurityConfigurerAdapter</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯é€»è¾‘
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">UserDetailsService</span> <span class="n">userDetailsService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è®¤è¯å¤±è´¥å¤„ç†ç±»
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">AuthenticationEntryPointImpl</span> <span class="n">unauthorizedHandler</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é€€å‡ºå¤„ç†ç±»
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">LogoutSuccessHandlerImpl</span> <span class="n">logoutSuccessHandler</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * tokenè®¤è¯è¿‡æ»¤å™¨
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">JwtAuthenticationTokenFilter</span> <span class="n">authenticationTokenFilter</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è·¨åŸŸè¿‡æ»¤å™¨
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">CorsFilter</span> <span class="n">corsFilter</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å…è®¸åŒ¿åè®¿é—®çš„åœ°å€
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">PermitAllUrlProperties</span> <span class="n">permitAllUrl</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è§£å†³ æ— æ³•ç›´æ¥æ³¨å…¥ AuthenticationManager
</span></span></span><span class="line"><span class="cl"><span class="cm">     *
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @throws Exception
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">AuthenticationManager</span> <span class="nf">authenticationManagerBean</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">authenticationManagerBean</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * anyRequest          |   åŒ¹é…æ‰€æœ‰è¯·æ±‚è·¯å¾„
</span></span></span><span class="line"><span class="cl"><span class="cm">     * access              |   SpringElè¡¨è¾¾å¼ç»“æœä¸ºtrueæ—¶å¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * anonymous           |   åŒ¿åå¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * denyAll             |   ç”¨æˆ·ä¸èƒ½è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * fullyAuthenticated  |   ç”¨æˆ·å®Œå…¨è®¤è¯å¯ä»¥è®¿é—®ï¼ˆéremember-meä¸‹è‡ªåŠ¨ç™»å½•ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="cm">     * hasAnyAuthority     |   å¦‚æœæœ‰å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºæƒé™ï¼Œåˆ™å…¶ä¸­ä»»ä½•ä¸€ä¸ªæƒé™å¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * hasAnyRole          |   å¦‚æœæœ‰å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºè§’è‰²ï¼Œåˆ™å…¶ä¸­ä»»ä½•ä¸€ä¸ªè§’è‰²å¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * hasAuthority        |   å¦‚æœæœ‰å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºæƒé™ï¼Œåˆ™å…¶æƒé™å¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * hasIpAddress        |   å¦‚æœæœ‰å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºIPåœ°å€ï¼Œå¦‚æœç”¨æˆ·IPå’Œå‚æ•°åŒ¹é…ï¼Œåˆ™å¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * hasRole             |   å¦‚æœæœ‰å‚æ•°ï¼Œå‚æ•°è¡¨ç¤ºè§’è‰²ï¼Œåˆ™å…¶è§’è‰²å¯ä»¥è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * permitAll           |   ç”¨æˆ·å¯ä»¥ä»»æ„è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * rememberMe          |   å…è®¸é€šè¿‡remember-meç™»å½•çš„ç”¨æˆ·è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     * authenticated       |   ç”¨æˆ·ç™»å½•åå¯è®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">HttpSecurity</span> <span class="n">httpSecurity</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ³¨è§£æ ‡è®°å…è®¸åŒ¿åè®¿é—®çš„url
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ExpressionUrlAuthorizationConfigurer</span><span class="o">&lt;</span><span class="n">HttpSecurity</span><span class="o">&gt;.</span><span class="na">ExpressionInterceptUrlRegistry</span> <span class="n">registry</span> <span class="o">=</span> <span class="n">httpSecurity</span><span class="o">.</span><span class="na">authorizeRequests</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">permitAllUrl</span><span class="o">.</span><span class="na">getUrls</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">url</span> <span class="o">-&gt;</span> <span class="n">registry</span><span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="n">url</span><span class="o">).</span><span class="na">permitAll</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">httpSecurity</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// CSRFç¦ç”¨ï¼Œå› ä¸ºä¸ä½¿ç”¨session
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="c1">// å…³é—­csrfåŠŸèƒ½:è·¨ç«™è¯·æ±‚ä¼ªé€ ,é»˜è®¤åªèƒ½é€šè¿‡postæ–¹å¼æäº¤logoutè¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">csrf</span><span class="o">().</span><span class="na">disable</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// è®¤è¯å¤±è´¥å¤„ç†ç±»
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">exceptionHandling</span><span class="o">().</span><span class="na">authenticationEntryPoint</span><span class="o">(</span><span class="n">unauthorizedHandler</span><span class="o">).</span><span class="na">and</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// åŸºäºtokenï¼Œæ‰€ä»¥ä¸éœ€è¦session
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">sessionManagement</span><span class="o">().</span><span class="na">sessionCreationPolicy</span><span class="o">(</span><span class="n">SessionCreationPolicy</span><span class="o">.</span><span class="na">STATELESS</span><span class="o">).</span><span class="na">and</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// è¿‡æ»¤è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">authorizeRequests</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// å¯¹äºç™»å½•login æ³¨å†Œregister éªŒè¯ç captchaImage å…è®¸åŒ¿åè®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">&#34;/login&#34;</span><span class="o">,</span> <span class="s">&#34;/register&#34;</span><span class="o">,</span> <span class="s">&#34;/captchaImage&#34;</span><span class="o">).</span><span class="na">anonymous</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// é™æ€èµ„æºï¼Œå¯åŒ¿åè®¿é—®
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="n">HttpMethod</span><span class="o">.</span><span class="na">GET</span><span class="o">,</span> <span class="s">&#34;/&#34;</span><span class="o">,</span> <span class="s">&#34;/*.html&#34;</span><span class="o">,</span> <span class="s">&#34;/**/*.html&#34;</span><span class="o">,</span> <span class="s">&#34;/**/*.css&#34;</span><span class="o">,</span> <span class="s">&#34;/**/*.js&#34;</span><span class="o">,</span> <span class="s">&#34;/profile/**&#34;</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">antMatchers</span><span class="o">(</span><span class="s">&#34;/swagger-ui.html&#34;</span><span class="o">,</span> <span class="s">&#34;/swagger-resources/**&#34;</span><span class="o">,</span> <span class="s">&#34;/webjars/**&#34;</span><span class="o">,</span> <span class="s">&#34;/*/api-docs&#34;</span><span class="o">,</span> <span class="s">&#34;/druid/**&#34;</span><span class="o">).</span><span class="na">permitAll</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="c1">// é™¤ä¸Šé¢å¤–çš„æ‰€æœ‰è¯·æ±‚å…¨éƒ¨éœ€è¦é‰´æƒè®¤è¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="o">.</span><span class="na">anyRequest</span><span class="o">().</span><span class="na">authenticated</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">and</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">headers</span><span class="o">().</span><span class="na">frameOptions</span><span class="o">().</span><span class="na">disable</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ·»åŠ Logout filter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">httpSecurity</span><span class="o">.</span><span class="na">logout</span><span class="o">().</span><span class="na">logoutUrl</span><span class="o">(</span><span class="s">&#34;/logout&#34;</span><span class="o">).</span><span class="na">logoutSuccessHandler</span><span class="o">(</span><span class="n">logoutSuccessHandler</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ·»åŠ JWT filter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">httpSecurity</span><span class="o">.</span><span class="na">addFilterBefore</span><span class="o">(</span><span class="n">authenticationTokenFilter</span><span class="o">,</span> <span class="n">UsernamePasswordAuthenticationFilter</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ·»åŠ CORS filter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">httpSecurity</span><span class="o">.</span><span class="na">addFilterBefore</span><span class="o">(</span><span class="n">corsFilter</span><span class="o">,</span> <span class="n">JwtAuthenticationTokenFilter</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">httpSecurity</span><span class="o">.</span><span class="na">addFilterBefore</span><span class="o">(</span><span class="n">corsFilter</span><span class="o">,</span> <span class="n">LogoutFilter</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// å¼€å¯è‡ªåŠ¨é…ç½®çš„ç™»å½•åŠŸèƒ½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// http.formLogin()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//     .loginPage(&#34;/toLogin&#34;)  //è‡ªå®šä¹‰ç™»å½•é¡µ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//     .loginProcessingUrl(&#34;/loginRequest&#34;)  // ç™»é™†è¡¨å•æäº¤çš„è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//     .passwordParameter(&#34;password&#34;);  // è¡¨å•ä¸­passwordéœ€ä¸è¯¥å¤„å¯¹åº”ã€‚é»˜è®¤æ˜¯password
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// http.formLogin();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="c1">// å¼€å¯è‡ªåŠ¨é…ç½®çš„æ³¨é”€çš„åŠŸèƒ½
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// http.logout().logoutSuccessUrl(&#34;/&#34;); // æ³¨é”€æˆåŠŸæ¥åˆ°é¦–é¡µ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®°ä½æˆ‘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// http.rememberMe();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// http.rememberMe().
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//     rememberMeParameter(&#34;remember&#34;); // å®šåˆ¶è®°ä½æˆ‘çš„å‚æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * å¼ºæ•£åˆ—å“ˆå¸ŒåŠ å¯†å®ç°
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">BCryptPasswordEncoder</span> <span class="nf">bCryptPasswordEncoder</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">BCryptPasswordEncoder</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * èº«ä»½è®¤è¯æ¥å£
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="o">(</span><span class="n">AuthenticationManagerBuilder</span> <span class="n">auth</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ•°æ®åº“éªŒè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// Spring Security æä¾›äº†BCryptPasswordEncoderç±»,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// å®ç°Springçš„PasswordEncoderæ¥å£ä½¿ç”¨BCryptå¼ºå“ˆå¸Œæ–¹æ³•æ¥åŠ å¯†å¯†ç 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">auth</span><span class="o">.</span><span class="na">userDetailsService</span><span class="o">(</span><span class="n">userDetailsService</span><span class="o">).</span><span class="na">passwordEncoder</span><span class="o">(</span><span class="n">bCryptPasswordEncoder</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3é…ç½®ç±»ç›¸å…³æ¨¡å—">3.é…ç½®ç±»ç›¸å…³æ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#3é…ç½®ç±»ç›¸å…³æ¨¡å—">#</a></h4>
<p><code>UserDetailsService</code> è‡ªå®šä¹‰ç”¨æˆ·è®¤è¯é€»è¾‘</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDetailsServiceImpl</span> <span class="kd">implements</span> <span class="n">UserDetailsService</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Logger</span> <span class="n">log</span> <span class="o">=</span> <span class="n">LoggerFactory</span><span class="o">.</span><span class="na">getLogger</span><span class="o">(</span><span class="n">UserDetailsServiceImpl</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">ISysUserService</span> <span class="n">userService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">SysPasswordService</span> <span class="n">passwordService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">SysPermissionService</span> <span class="n">permissionService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">UserDetails</span> <span class="nf">loadUserByUsername</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">UsernameNotFoundException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SysUser</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">selectUserByUserName</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="n">user</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;ç™»å½•ç”¨æˆ·ï¼š{} ä¸å­˜åœ¨.&#34;</span><span class="o">,</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">ServiceException</span><span class="o">(</span><span class="s">&#34;ç™»å½•ç”¨æˆ·ï¼š&#34;</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">&#34; ä¸å­˜åœ¨&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">UserStatus</span><span class="o">.</span><span class="na">DELETED</span><span class="o">.</span><span class="na">getCode</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getDelFlag</span><span class="o">()))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;ç™»å½•ç”¨æˆ·ï¼š{} å·²è¢«åˆ é™¤.&#34;</span><span class="o">,</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">ServiceException</span><span class="o">(</span><span class="s">&#34;å¯¹ä¸èµ·ï¼Œæ‚¨çš„è´¦å·ï¼š&#34;</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">&#34; å·²è¢«åˆ é™¤&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">UserStatus</span><span class="o">.</span><span class="na">DISABLE</span><span class="o">.</span><span class="na">getCode</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getStatus</span><span class="o">()))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">log</span><span class="o">.</span><span class="na">info</span><span class="o">(</span><span class="s">&#34;ç™»å½•ç”¨æˆ·ï¼š{} å·²è¢«åœç”¨.&#34;</span><span class="o">,</span> <span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">throw</span> <span class="k">new</span> <span class="n">ServiceException</span><span class="o">(</span><span class="s">&#34;å¯¹ä¸èµ·ï¼Œæ‚¨çš„è´¦å·ï¼š&#34;</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">&#34; å·²åœç”¨&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">passwordService</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">createLoginUser</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">UserDetails</span> <span class="nf">createLoginUser</span><span class="o">(</span><span class="n">SysUser</span> <span class="n">user</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">LoginUser</span><span class="o">(</span><span class="n">user</span><span class="o">.</span><span class="na">getUserId</span><span class="o">(),</span> <span class="n">user</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code> AuthenticationEntryPointImpl</code> è®¤è¯å¤±è´¥å¤„ç†ç±» è¿”å›æœªæˆæƒ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AuthenticationEntryPointImpl</span> <span class="kd">implements</span> <span class="n">AuthenticationEntryPoint</span><span class="o">,</span> <span class="n">Serializable</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">long</span> <span class="n">serialVersionUID</span> <span class="o">=</span> <span class="o">-</span><span class="mi">8970718410437077606L</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">commence</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">AuthenticationException</span> <span class="n">e</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="kd">throws</span> <span class="n">IOException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">code</span> <span class="o">=</span> <span class="n">HttpStatus</span><span class="o">.</span><span class="na">UNAUTHORIZED</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚è®¿é—®ï¼š{}ï¼Œè®¤è¯å¤±è´¥ï¼Œæ— æ³•è®¿é—®ç³»ç»Ÿèµ„æº&#34;</span><span class="o">,</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">ServletUtils</span><span class="o">.</span><span class="na">renderString</span><span class="o">(</span><span class="n">response</span><span class="o">,</span> <span class="n">JSON</span><span class="o">.</span><span class="na">toJSONString</span><span class="o">(</span><span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">msg</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>LogoutSuccessHandlerImpl</code> è‡ªå®šä¹‰é€€å‡ºå¤„ç†ç±» è¿”å›æˆåŠŸ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LogoutSuccessHandlerImpl</span> <span class="kd">implements</span> <span class="n">LogoutSuccessHandler</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">TokenService</span> <span class="n">tokenService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">IAsyncService</span> <span class="n">asyncService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é€€å‡ºå¤„ç†
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onLogoutSuccess</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Authentication</span> <span class="n">authentication</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoginUser</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="n">tokenService</span><span class="o">.</span><span class="na">getLoginUser</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">loginUser</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">userName</span> <span class="o">=</span> <span class="n">loginUser</span><span class="o">.</span><span class="na">getUsername</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// åˆ é™¤ç”¨æˆ·ç¼“å­˜è®°å½•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">tokenService</span><span class="o">.</span><span class="na">delLoginUser</span><span class="o">(</span><span class="n">loginUser</span><span class="o">.</span><span class="na">getToken</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// è®°å½•ç”¨æˆ·é€€å‡ºæ—¥å¿—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">asyncService</span><span class="o">.</span><span class="na">recordLogininfor</span><span class="o">(</span><span class="n">userName</span><span class="o">,</span> <span class="n">Constants</span><span class="o">.</span><span class="na">LOGOUT</span><span class="o">,</span> <span class="s">&#34;é€€å‡ºæˆåŠŸ&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">ServletUtils</span><span class="o">.</span><span class="na">renderString</span><span class="o">(</span><span class="n">response</span><span class="o">,</span> <span class="n">JSON</span><span class="o">.</span><span class="na">toJSONString</span><span class="o">(</span><span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">SUCCESS</span><span class="o">,</span> <span class="s">&#34;é€€å‡ºæˆåŠŸ&#34;</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>JwtAuthenticationTokenFiltertoken</code> tokenè¿‡æ»¤å™¨ éªŒè¯tokenæœ‰æ•ˆæ€§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtAuthenticationTokenFilter</span> <span class="kd">extends</span> <span class="n">OncePerRequestFilter</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">TokenService</span> <span class="n">tokenService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">FilterChain</span> <span class="n">chain</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoginUser</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="n">tokenService</span><span class="o">.</span><span class="na">getLoginUser</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">loginUser</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="n">SecurityUtils</span><span class="o">.</span><span class="na">getAuthentication</span><span class="o">()))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">tokenService</span><span class="o">.</span><span class="na">verifyToken</span><span class="o">(</span><span class="n">loginUser</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// è·å–æƒé™ä¿¡æ¯å°è£…åˆ°Authenticationä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">UsernamePasswordAuthenticationToken</span> <span class="n">authenticationToken</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">loginUser</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">loginUser</span><span class="o">.</span><span class="na">getAuthorities</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">authenticationToken</span><span class="o">.</span><span class="na">setDetails</span><span class="o">(</span><span class="k">new</span> <span class="n">WebAuthenticationDetailsSource</span><span class="o">().</span><span class="na">buildDetails</span><span class="o">(</span><span class="n">request</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// å­˜å…¥SecurityContextHolder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">setAuthentication</span><span class="o">(</span><span class="n">authenticationToken</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>ResourcesConfig</code> è·¨åŸŸè¿‡æ»¤å™¨</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ResourcesConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * è·¨åŸŸé…ç½®
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">CorsFilter</span> <span class="nf">corsFilter</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">CorsConfiguration</span> <span class="n">config</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CorsConfiguration</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">config</span><span class="o">.</span><span class="na">setAllowCredentials</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®è®¿é—®æºåœ°å€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">config</span><span class="o">.</span><span class="na">addAllowedOriginPattern</span><span class="o">(</span><span class="s">&#34;*&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®è®¿é—®æºè¯·æ±‚å¤´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">config</span><span class="o">.</span><span class="na">addAllowedHeader</span><span class="o">(</span><span class="s">&#34;*&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®è®¿é—®æºè¯·æ±‚æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">config</span><span class="o">.</span><span class="na">addAllowedMethod</span><span class="o">(</span><span class="s">&#34;*&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æœ‰æ•ˆæœŸ 1800ç§’
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">config</span><span class="o">.</span><span class="na">setMaxAge</span><span class="o">(</span><span class="mi">1800L</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// æ·»åŠ æ˜ å°„è·¯å¾„ï¼Œæ‹¦æˆªä¸€åˆ‡è¯·æ±‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">UrlBasedCorsConfigurationSource</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UrlBasedCorsConfigurationSource</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">source</span><span class="o">.</span><span class="na">registerCorsConfiguration</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">,</span> <span class="n">config</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è¿”å›æ–°çš„CorsFilter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="k">new</span> <span class="n">CorsFilter</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>PermitAllUrlProperties</code> è®¾ç½®Anonymousæ³¨è§£å…è®¸åŒ¿åè®¿é—®çš„url</p>
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/CSDN877425287/article/details/115499665">ApplicationContextAwareæ¥å£çš„ä½œç”¨</a></p>
<p>è¿™ä¸ªæ¥å£å…¶å®å°±æ˜¯è·å–Springå®¹å™¨çš„Beanï¼Œåœ¨æˆ‘ä»¬å†™ä¸€äº›æ¡†æ¶ä»£ç æ—¶ï¼Œæˆ–è€…æ˜¯çœ‹ä¸€äº›æ¡†æ¶æºç æ—¶ç»å¸¸ä¼šçœ‹åˆ°è¿™ä¸ªæ¥å£ApplicationContextAware çš„ä½¿ç”¨ï¼ŒSpringå®¹å™¨ä¼šæ£€æµ‹å®¹å™¨ä¸­çš„æ‰€æœ‰Beanï¼Œå¦‚æœå‘ç°æŸä¸ªBeanå®ç°äº†ApplicationContextAwareæ¥å£ï¼ŒSpringå®¹å™¨ä¼šåœ¨åˆ›å»ºè¯¥Beanä¹‹åï¼Œè‡ªåŠ¨è°ƒç”¨è¯¥Beançš„setApplicationContextAware()æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•æ—¶ï¼Œä¼šå°†å®¹å™¨æœ¬èº«ä½œä¸ºå‚æ•°ä¼ ç»™è¯¥æ–¹æ³•â€”â€”è¯¥æ–¹æ³•ä¸­çš„å®ç°éƒ¨åˆ†å°†Springä¼ å…¥çš„å‚æ•°ï¼ˆå®¹å™¨æœ¬èº«ï¼‰èµ‹ç»™è¯¥ç±»å¯¹è±¡çš„applicationContextå®ä¾‹å˜é‡ï¼Œå› æ­¤æ¥ä¸‹æ¥å¯ä»¥é€šè¿‡è¯¥applicationContextå®ä¾‹å˜é‡æ¥è®¿é—®å®¹å™¨æœ¬èº«</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span> 
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PermitAllUrlProperties</span> <span class="kd">implements</span> <span class="n">InitializingBean</span><span class="o">,</span> <span class="n">ApplicationContextAware</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Pattern</span> <span class="n">PATTERN</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="s">&#34;\\{(.*?)\\}&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">ApplicationContext</span> <span class="n">applicationContext</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">urls</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="n">ASTERISK</span> <span class="o">=</span> <span class="s">&#34;*&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">afterPropertiesSet</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">RequestMappingHandlerMapping</span> <span class="n">mapping</span> <span class="o">=</span> <span class="n">applicationContext</span><span class="o">.</span><span class="na">getBean</span><span class="o">(</span><span class="n">RequestMappingHandlerMapping</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Map</span><span class="o">&lt;</span><span class="n">RequestMappingInfo</span><span class="o">,</span> <span class="n">HandlerMethod</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="na">getHandlerMethods</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">map</span><span class="o">.</span><span class="na">keySet</span><span class="o">().</span><span class="na">forEach</span><span class="o">(</span><span class="n">info</span> <span class="o">-&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">HandlerMethod</span> <span class="n">handlerMethod</span> <span class="o">=</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">info</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// è·å–æ–¹æ³•ä¸Šè¾¹çš„æ³¨è§£ æ›¿ä»£path variable ä¸º *
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Anonymous</span> <span class="n">method</span> <span class="o">=</span> <span class="n">AnnotationUtils</span><span class="o">.</span><span class="na">findAnnotation</span><span class="o">(</span><span class="n">handlerMethod</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(),</span> <span class="n">Anonymous</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">method</span><span class="o">).</span><span class="na">ifPresent</span><span class="o">(</span><span class="n">anonymous</span> <span class="o">-&gt;</span> <span class="n">info</span><span class="o">.</span><span class="na">getPatternsCondition</span><span class="o">().</span><span class="na">getPatterns</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">url</span> <span class="o">-&gt;</span> <span class="n">urls</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">RegExUtils</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">PATTERN</span><span class="o">,</span> <span class="n">ASTERISK</span><span class="o">))));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">// è·å–ç±»ä¸Šè¾¹çš„æ³¨è§£, æ›¿ä»£path variable ä¸º *
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Anonymous</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">AnnotationUtils</span><span class="o">.</span><span class="na">findAnnotation</span><span class="o">(</span><span class="n">handlerMethod</span><span class="o">.</span><span class="na">getBeanType</span><span class="o">(),</span> <span class="n">Anonymous</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">Optional</span><span class="o">.</span><span class="na">ofNullable</span><span class="o">(</span><span class="n">controller</span><span class="o">).</span><span class="na">ifPresent</span><span class="o">(</span><span class="n">anonymous</span> <span class="o">-&gt;</span> <span class="n">info</span><span class="o">.</span><span class="na">getPatternsCondition</span><span class="o">().</span><span class="na">getPatterns</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                    <span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">url</span> <span class="o">-&gt;</span> <span class="n">urls</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">RegExUtils</span><span class="o">.</span><span class="na">replaceAll</span><span class="o">(</span><span class="n">url</span><span class="o">,</span> <span class="n">PATTERN</span><span class="o">,</span> <span class="n">ASTERISK</span><span class="o">))));</span>
</span></span><span class="line"><span class="cl">        <span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setApplicationContext</span><span class="o">(</span><span class="n">ApplicationContext</span> <span class="n">context</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">BeansException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">applicationContext</span> <span class="o">=</span> <span class="n">context</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getUrls</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">urls</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUrls</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">urls</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">urls</span> <span class="o">=</span> <span class="n">urls</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="4ç™»å½•æ¨¡å—">4.ç™»å½•æ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#4ç™»å½•æ¨¡å—">#</a></h4>
<p><code>authenticationManager.authenticate</code> ä¼šè°ƒç”¨ <code>UserDetailsServiceImpl.loadUserByUsername</code> è¿›è¡Œèº«ä»½è®¤è¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">login</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">,</span> <span class="n">String</span> <span class="n">password</span><span class="o">,</span> <span class="n">String</span> <span class="n">code</span><span class="o">,</span> <span class="n">String</span> <span class="n">uuid</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// boolean captchaEnabled = configService.selectCaptchaEnabled();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">// éªŒè¯ç å¼€å…³
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span> <span class="o">(</span><span class="kc">false</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// validateCaptcha(username, code, uuid);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ç”¨æˆ·éªŒè¯
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Authentication</span> <span class="n">authentication</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">try</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">UsernamePasswordAuthenticationToken</span> <span class="n">authenticationToken</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">password</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">AuthenticationContextHolder</span><span class="o">.</span><span class="na">setContext</span><span class="o">(</span><span class="n">authenticationToken</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// è¯¥æ–¹æ³•ä¼šå»è°ƒç”¨UserDetailsServiceImpl.loadUserByUsername
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">authentication</span> <span class="o">=</span> <span class="n">authenticationManager</span><span class="o">.</span><span class="na">authenticate</span><span class="o">(</span><span class="n">authenticationToken</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">e</span> <span class="k">instanceof</span> <span class="n">BadCredentialsException</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">MessageUtils</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="s">&#34;user.password.not.match&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">asyncService</span><span class="o">.</span><span class="na">recordLogininfor</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">Constants</span><span class="o">.</span><span class="na">LOGIN_FAIL</span><span class="o">,</span> <span class="n">message</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">throw</span> <span class="k">new</span> <span class="n">ServiceException</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span>
</span></span><span class="line"><span class="cl">            <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">asyncService</span><span class="o">.</span><span class="na">recordLogininfor</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">Constants</span><span class="o">.</span><span class="na">LOGIN_FAIL</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">                <span class="k">throw</span> <span class="k">new</span> <span class="n">ServiceException</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">asyncService</span><span class="o">.</span><span class="na">recordLogininfor</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">Constants</span><span class="o">.</span><span class="na">LOGIN_SUCCESS</span><span class="o">,</span> <span class="n">MessageUtils</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="s">&#34;user.login.success&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoginUser</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="o">(</span><span class="n">LoginUser</span><span class="o">)</span> <span class="n">authentication</span><span class="o">.</span><span class="na">getPrincipal</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">recordLoginInfo</span><span class="o">(</span><span class="n">loginUser</span><span class="o">.</span><span class="na">getUserId</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ç”Ÿæˆtoken
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">return</span> <span class="n">tokenService</span><span class="o">.</span><span class="na">createToken</span><span class="o">(</span><span class="n">loginUser</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="5ç™»å‡ºæ¨¡å—">5.ç™»å‡ºæ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#5ç™»å‡ºæ¨¡å—">#</a></h4>
<p><code>SecurityConfig</code>ä¸­æ·»åŠ ç™»å‡ºè¿‡æ»¤é“¾</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// æ·»åŠ Logout filter
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">httpSecurity</span><span class="o">.</span><span class="na">logout</span><span class="o">().</span><span class="na">logoutUrl</span><span class="o">(</span><span class="s">&#34;/logout&#34;</span><span class="o">).</span><span class="na">logoutSuccessHandler</span><span class="o">(</span><span class="n">logoutSuccessHandler</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>LogoutSuccessHandlerImpl</code>è‡ªå®šä¹‰é€€å‡ºå¤„ç†ç±» è¿”å›æˆåŠŸ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">LogoutSuccessHandlerImpl</span> <span class="kd">implements</span> <span class="n">LogoutSuccessHandler</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">TokenService</span> <span class="n">tokenService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">IAsyncService</span> <span class="n">asyncService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * é€€å‡ºå¤„ç†
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onLogoutSuccess</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">Authentication</span> <span class="n">authentication</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="kd">throws</span> <span class="n">IOException</span><span class="o">,</span> <span class="n">ServletException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoginUser</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="n">tokenService</span><span class="o">.</span><span class="na">getLoginUser</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">loginUser</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">userName</span> <span class="o">=</span> <span class="n">loginUser</span><span class="o">.</span><span class="na">getUsername</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// åˆ é™¤ç”¨æˆ·ç¼“å­˜è®°å½•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">tokenService</span><span class="o">.</span><span class="na">delLoginUser</span><span class="o">(</span><span class="n">loginUser</span><span class="o">.</span><span class="na">getToken</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// è®°å½•ç”¨æˆ·é€€å‡ºæ—¥å¿—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">asyncService</span><span class="o">.</span><span class="na">recordLogininfor</span><span class="o">(</span><span class="n">userName</span><span class="o">,</span> <span class="n">Constants</span><span class="o">.</span><span class="na">LOGOUT</span><span class="o">,</span> <span class="s">&#34;é€€å‡ºæˆåŠŸ&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">ServletUtils</span><span class="o">.</span><span class="na">renderString</span><span class="o">(</span><span class="n">response</span><span class="o">,</span> <span class="n">JSON</span><span class="o">.</span><span class="na">toJSONString</span><span class="o">(</span><span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">HttpStatus</span><span class="o">.</span><span class="na">SUCCESS</span><span class="o">,</span> <span class="s">&#34;é€€å‡ºæˆåŠŸ&#34;</span><span class="o">)));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="6æ³¨å†Œæ¨¡å—">6.æ³¨å†Œæ¨¡å—<a hidden class="anchor" aria-hidden="true" href="#6æ³¨å†Œæ¨¡å—">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">register</span><span class="o">(</span><span class="n">RegisterDTO</span> <span class="n">registerBody</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">,</span> <span class="n">username</span> <span class="o">=</span> <span class="n">registerBody</span><span class="o">.</span><span class="na">getUsername</span><span class="o">(),</span> <span class="n">password</span> <span class="o">=</span> <span class="n">registerBody</span><span class="o">.</span><span class="na">getPassword</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">boolean</span> <span class="n">captchaEnabled</span> <span class="o">=</span> <span class="n">configService</span><span class="o">.</span><span class="na">selectCaptchaEnabled</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// éªŒè¯ç å¼€å…³
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">if</span> <span class="o">(</span><span class="n">captchaEnabled</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// validateCaptcha(username, registerBody.getCode(), registerBody.getUuid());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">username</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;ç”¨æˆ·åä¸èƒ½ä¸ºç©º&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">password</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;ç”¨æˆ·å¯†ç ä¸èƒ½ä¸ºç©º&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">username</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">UserConstants</span><span class="o">.</span><span class="na">USERNAME_MIN_LENGTH</span>
</span></span><span class="line"><span class="cl">        <span class="o">||</span> <span class="n">username</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">UserConstants</span><span class="o">.</span><span class="na">USERNAME_MAX_LENGTH</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;è´¦æˆ·é•¿åº¦å¿…é¡»åœ¨2åˆ°20ä¸ªå­—ç¬¦ä¹‹é—´&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">password</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="n">UserConstants</span><span class="o">.</span><span class="na">PASSWORD_MIN_LENGTH</span>
</span></span><span class="line"><span class="cl">        <span class="o">||</span> <span class="n">password</span><span class="o">.</span><span class="na">length</span><span class="o">()</span> <span class="o">&gt;</span> <span class="n">UserConstants</span><span class="o">.</span><span class="na">PASSWORD_MAX_LENGTH</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;å¯†ç é•¿åº¦å¿…é¡»åœ¨5åˆ°20ä¸ªå­—ç¬¦ä¹‹é—´&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span> <span class="k">if</span> <span class="o">(</span><span class="n">UserConstants</span><span class="o">.</span><span class="na">NOT_UNIQUE</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">userService</span><span class="o">.</span><span class="na">checkUserNameUnique</span><span class="o">(</span><span class="n">username</span><span class="o">)))</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;ä¿å­˜ç”¨æˆ·&#39;&#34;</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s">&#34;&#39;å¤±è´¥ï¼Œæ³¨å†Œè´¦å·å·²å­˜åœ¨&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SysUser</span> <span class="n">sysUser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SysUser</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">sysUser</span><span class="o">.</span><span class="na">setUserName</span><span class="o">(</span><span class="n">username</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">sysUser</span><span class="o">.</span><span class="na">setPassword</span><span class="o">(</span><span class="n">SecurityUtils</span><span class="o">.</span><span class="na">encryptPassword</span><span class="o">(</span><span class="n">registerBody</span><span class="o">.</span><span class="na">getPassword</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">        <span class="kt">boolean</span> <span class="n">regFlag</span> <span class="o">=</span> <span class="n">userService</span><span class="o">.</span><span class="na">registerUser</span><span class="o">(</span><span class="n">sysUser</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(!</span><span class="n">regFlag</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">msg</span> <span class="o">=</span> <span class="s">&#34;æ³¨å†Œå¤±è´¥,è¯·è”ç³»ç³»ç»Ÿç®¡ç†äººå‘˜&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">asyncService</span><span class="o">.</span><span class="na">recordLogininfor</span><span class="o">(</span><span class="n">username</span><span class="o">,</span> <span class="n">Constants</span><span class="o">.</span><span class="na">REGISTER</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">MessageUtils</span><span class="o">.</span><span class="na">message</span><span class="o">(</span><span class="s">&#34;user.register.success&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">msg</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æˆæƒå®ç°">æˆæƒå®ç°<a hidden class="anchor" aria-hidden="true" href="#æˆæƒå®ç°">#</a></h3>
<h4 id="1åˆ›å»ºæ•°æ®åº“è¡¨-1">1.åˆ›å»ºæ•°æ®åº“è¡¨<a hidden class="anchor" aria-hidden="true" href="#1åˆ›å»ºæ•°æ®åº“è¡¨-1">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- è§’è‰²ä¿¡æ¯è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_role</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_role</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">role_id</span><span class="w">              </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">      </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="w">    </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è§’è‰²ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">role_name</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span><span class="w">     </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è§’è‰²åç§°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">role_key</span><span class="w">             </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è§’è‰²æƒé™å­—ç¬¦ä¸²&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">role_sort</span><span class="w">            </span><span class="nb">int</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">          </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ˜¾ç¤ºé¡ºåº&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">data_scope</span><span class="w">           </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;1&#39;</span><span class="w">                </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ•°æ®èŒƒå›´ï¼ˆ1ï¼šå…¨éƒ¨æ•°æ®æƒé™ 2ï¼šè‡ªå®šæ•°æ®æƒé™ 3ï¼šæœ¬éƒ¨é—¨æ•°æ®æƒé™ 4ï¼šæœ¬éƒ¨é—¨åŠä»¥ä¸‹æ•°æ®æƒé™ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">menu_check_strictly</span><span class="w">  </span><span class="n">tinyint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="k">default</span><span class="w"> </span><span class="mi">1</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•æ ‘é€‰æ‹©é¡¹æ˜¯å¦å…³è”æ˜¾ç¤º&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">dept_check_strictly</span><span class="w">  </span><span class="n">tinyint</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="k">default</span><span class="w"> </span><span class="mi">1</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;éƒ¨é—¨æ ‘é€‰æ‹©é¡¹æ˜¯å¦å…³è”æ˜¾ç¤º&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">status</span><span class="w">               </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è§’è‰²çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">del_flag</span><span class="w">             </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="w">                </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ é™¤æ ‡å¿—ï¼ˆ0ä»£è¡¨å­˜åœ¨ 2ä»£è¡¨åˆ é™¤ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_by</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºè€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_time</span><span class="w">          </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºæ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_by</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°è€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_time</span><span class="w">          </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°æ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">remark</span><span class="w">               </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="k">null</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å¤‡æ³¨&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">role_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="n">auto_increment</span><span class="o">=</span><span class="mi">100</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;è§’è‰²ä¿¡æ¯è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- èœå•æƒé™è¡¨
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_menu</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_menu</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">menu_id</span><span class="w">           </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">      </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="n">auto_increment</span><span class="w">    </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">menu_name</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="w">     </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w">                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•åç§°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">parent_id</span><span class="w">         </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w">      </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;çˆ¶èœå•ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">order_num</span><span class="w">         </span><span class="nb">int</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w">          </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ˜¾ç¤ºé¡ºåº&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">path</span><span class="w">              </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è·¯ç”±åœ°å€&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">component</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="k">null</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç»„ä»¶è·¯å¾„&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">query</span><span class="w">             </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="k">null</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è·¯ç”±å‚æ•°&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">is_frame</span><span class="w">          </span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">          </span><span class="k">default</span><span class="w"> </span><span class="mi">1</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ˜¯å¦ä¸ºå¤–é“¾ï¼ˆ0æ˜¯ 1å¦ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">is_cache</span><span class="w">          </span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">          </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ˜¯å¦ç¼“å­˜ï¼ˆ0ç¼“å­˜ 1ä¸ç¼“å­˜ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">menu_type</span><span class="w">         </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•ç±»å‹ï¼ˆMç›®å½• Cèœå• FæŒ‰é’®ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">visible</span><span class="w">           </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•çŠ¶æ€ï¼ˆ0æ˜¾ç¤º 1éšè—ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">status</span><span class="w">            </span><span class="nb">char</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">         </span><span class="k">default</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•çŠ¶æ€ï¼ˆ0æ­£å¸¸ 1åœç”¨ï¼‰&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">perms</span><span class="w">             </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="k">null</span><span class="w">               </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æƒé™æ ‡è¯†&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">icon</span><span class="w">              </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;#&#39;</span><span class="w">                </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•å›¾æ ‡&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_by</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºè€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">create_time</span><span class="w">       </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;åˆ›å»ºæ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_by</span><span class="w">         </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="w">     </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°è€…&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">update_time</span><span class="w">       </span><span class="n">datetime</span><span class="w">                                   </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;æ›´æ–°æ—¶é—´&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">remark</span><span class="w">            </span><span class="nb">varchar</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="w">    </span><span class="k">default</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">                 </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;å¤‡æ³¨&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="w"> </span><span class="p">(</span><span class="n">menu_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="n">auto_increment</span><span class="o">=</span><span class="mi">2000</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;èœå•æƒé™è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- è§’è‰²å’Œèœå•å…³è”è¡¨  è§’è‰²1-Nèœå•
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_role_menu</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_role_menu</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">role_id</span><span class="w">   </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è§’è‰²ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">menu_id</span><span class="w">   </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;èœå•ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">(</span><span class="n">role_id</span><span class="p">,</span><span class="w"> </span><span class="n">menu_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;è§’è‰²å’Œèœå•å…³è”è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ç”¨æˆ·å’Œè§’è‰²å…³è”è¡¨  ç”¨æˆ·N-1è§’è‰²
</span></span></span><span class="line"><span class="cl"><span class="c1">-- ----------------------------
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">drop</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="n">sys_user_role</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">create</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">sys_user_role</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">   </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">role_id</span><span class="w">   </span><span class="nb">bigint</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="k">null</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="s1">&#39;è§’è‰²ID&#39;</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">primary</span><span class="w"> </span><span class="k">key</span><span class="p">(</span><span class="n">user_id</span><span class="p">,</span><span class="w"> </span><span class="n">role_id</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">)</span><span class="w"> </span><span class="n">engine</span><span class="o">=</span><span class="n">innodb</span><span class="w"> </span><span class="k">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ç”¨æˆ·å’Œè§’è‰²å…³è”è¡¨&#39;</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="2æƒé™è¿‡æ»¤å™¨">2.æƒé™è¿‡æ»¤å™¨<a hidden class="anchor" aria-hidden="true" href="#2æƒé™è¿‡æ»¤å™¨">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">JwtAuthenticationTokenFilter</span> <span class="kd">extends</span> <span class="n">OncePerRequestFilter</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">TokenService</span> <span class="n">tokenService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">doFilterInternal</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">,</span> <span class="n">FilterChain</span> <span class="n">chain</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">            <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoginUser</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="n">tokenService</span><span class="o">.</span><span class="na">getLoginUser</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">loginUser</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="n">SecurityUtils</span><span class="o">.</span><span class="na">getAuthentication</span><span class="o">()))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">tokenService</span><span class="o">.</span><span class="na">verifyToken</span><span class="o">(</span><span class="n">loginUser</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// è·å–æƒé™ä¿¡æ¯å°è£…åˆ°Authenticationä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">UsernamePasswordAuthenticationToken</span> <span class="n">authenticationToken</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UsernamePasswordAuthenticationToken</span><span class="o">(</span><span class="n">loginUser</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">loginUser</span><span class="o">.</span><span class="na">getAuthorities</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">authenticationToken</span><span class="o">.</span><span class="na">setDetails</span><span class="o">(</span><span class="k">new</span> <span class="n">WebAuthenticationDetailsSource</span><span class="o">().</span><span class="na">buildDetails</span><span class="o">(</span><span class="n">request</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// å­˜å…¥SecurityContextHolder
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">SecurityContextHolder</span><span class="o">.</span><span class="na">getContext</span><span class="o">().</span><span class="na">setAuthentication</span><span class="o">(</span><span class="n">authenticationToken</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">chain</span><span class="o">.</span><span class="na">doFilter</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="3ç™»å½•æ—¶æƒé™èµ‹å€¼">3.ç™»å½•æ—¶æƒé™èµ‹å€¼<a hidden class="anchor" aria-hidden="true" href="#3ç™»å½•æ—¶æƒé™èµ‹å€¼">#</a></h4>
<p>åœ¨ <code>UserDetailsServiceImpl</code> çš„ <code>loadUserByUsername</code> ä¸­ä¸ºuserèµ‹ä¸Šæƒé™</p>
<p><img loading="lazy" src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348819.png" alt="image-20220901230449453"  />
</p>
<h4 id="4æƒé™æŸ¥è¯¢mapper">4.æƒé™æŸ¥è¯¢Mapper<a hidden class="anchor" aria-hidden="true" href="#4æƒé™æŸ¥è¯¢mapper">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;selectMenuListByUserId&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;SysMenu&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;SysMenuResult&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">   select distinct m.menu_id, m.parent_id, m.menu_name, m.path, m.component, m.`query`, m.visible, m.status, ifnull(m.perms,&#39;&#39;) as perms, m.is_frame, m.is_cache, m.menu_type, m.icon, m.order_num, m.create_time
</span></span><span class="line"><span class="cl">   from sys_menu m
</span></span><span class="line"><span class="cl">   left join sys_role_menu rm on m.menu_id = rm.menu_id
</span></span><span class="line"><span class="cl">   left join sys_user_role ur on rm.role_id = ur.role_id
</span></span><span class="line"><span class="cl">   left join sys_role ro on ur.role_id = ro.role_id
</span></span><span class="line"><span class="cl">   where ur.user_id = #{params.userId}
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;menuName != null and menuName != &#39;&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">           AND m.menu_name like concat(&#39;%&#39;, #{menuName}, &#39;%&#39;)
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;visible != null and visible != &#39;&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">           AND m.visible = #{visible}
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;status != null and status != &#39;&#39;&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">           AND m.status = #{status}
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;/if&gt;</span>
</span></span><span class="line"><span class="cl">   order by m.parent_id, m.order_num
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="5è‡ªå®šä¹‰æƒé™æ–¹æ³•">5.è‡ªå®šä¹‰æƒé™æ–¹æ³•<a hidden class="anchor" aria-hidden="true" href="#5è‡ªå®šä¹‰æƒé™æ–¹æ³•">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="o">(</span><span class="s">&#34;ss&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">PermissionService</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/** æ‰€æœ‰æƒé™æ ‡è¯† */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ALL_PERMISSION</span> <span class="o">=</span> <span class="s">&#34;*:*:*&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/** ç®¡ç†å‘˜è§’è‰²æƒé™æ ‡è¯† */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">SUPER_ADMIN</span> <span class="o">=</span> <span class="s">&#34;admin&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">ROLE_DELIMETER</span> <span class="o">=</span> <span class="s">&#34;,&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">PERMISSION_DELIMETER</span> <span class="o">=</span> <span class="s">&#34;,&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * éªŒè¯ç”¨æˆ·æ˜¯å¦å…·å¤‡æŸæƒé™
</span></span></span><span class="line"><span class="cl"><span class="cm">     * 
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @param permission æƒé™å­—ç¬¦ä¸²
</span></span></span><span class="line"><span class="cl"><span class="cm">     * @return ç”¨æˆ·æ˜¯å¦å…·å¤‡æŸæƒé™
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasPermi</span><span class="o">(</span><span class="n">String</span> <span class="n">permission</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">permission</span><span class="o">))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">LoginUser</span> <span class="n">loginUser</span> <span class="o">=</span> <span class="n">SecurityUtils</span><span class="o">.</span><span class="na">getLoginUser</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isNull</span><span class="o">(</span><span class="n">loginUser</span><span class="o">)</span> <span class="o">||</span> <span class="n">CollectionUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">loginUser</span><span class="o">.</span><span class="na">getPermissions</span><span class="o">()))</span>
</span></span><span class="line"><span class="cl">        <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">hasPermissions</span><span class="o">(</span><span class="n">loginUser</span><span class="o">.</span><span class="na">getPermissions</span><span class="o">(),</span> <span class="n">permission</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="6æ¥å£å®ç°">6.æ¥å£å®ç°<a hidden class="anchor" aria-hidden="true" href="#6æ¥å£å®ç°">#</a></h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * è·å–èœå•åˆ—è¡¨
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@PreAuthorize</span><span class="o">(</span><span class="s">&#34;@ss.hasPermi(&#39;system:menu:list&#39;)&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/list&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">AjaxResult</span> <span class="nf">list</span><span class="o">(</span><span class="n">SysMenu</span> <span class="n">menu</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">List</span><span class="o">&lt;</span><span class="n">SysMenu</span><span class="o">&gt;</span> <span class="n">menus</span> <span class="o">=</span> <span class="n">menuService</span><span class="o">.</span><span class="na">selectMenuList</span><span class="o">(</span><span class="n">menu</span><span class="o">,</span> <span class="n">getUserId</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">AjaxResult</span><span class="o">.</span><span class="na">success</span><span class="o">(</span><span class="n">menus</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="å‚æ•°æ ¡éªŒ">å‚æ•°æ ¡éªŒ<a hidden class="anchor" aria-hidden="true" href="#å‚æ•°æ ¡éªŒ">#</a></h2>
<blockquote>
<p>å‚è€ƒé“¾æ¥ï¼š</p>
<p><a href="https://blog.csdn.net/qq_37132495/article/details/118804544">https://blog.csdn.net/qq_37132495/article/details/118804544</a></p>
<p><a href="https://blog.csdn.net/qq_45151158/article/details/103126907">å‚æ•°æ£€éªŒä¹‹&mdash;&mdash;&ndash;BindingResultæ€»ç»“</a></p>
</blockquote>
<h3 id="å‚æ•°æ³¨è§£è¯´æ˜">å‚æ•°æ³¨è§£è¯´æ˜<a hidden class="anchor" aria-hidden="true" href="#å‚æ•°æ³¨è§£è¯´æ˜">#</a></h3>
<table>
<thead>
<tr>
<th>æ³¨è§£åç§°</th>
<th>åŠŸèƒ½</th>
</tr>
</thead>
<tbody>
<tr>
<td>@Xss</td>
<td>æ£€æŸ¥è¯¥å­—æ®µæ˜¯å¦å­˜åœ¨è·¨ç«™è„šæœ¬å·¥å…·</td>
</tr>
<tr>
<td>@Null</td>
<td>æ£€æŸ¥è¯¥å­—æ®µä¸ºç©º</td>
</tr>
<tr>
<td>@NotNull</td>
<td>ä¸èƒ½ä¸ºnull</td>
</tr>
<tr>
<td>@NotBlank</td>
<td>ä¸èƒ½ä¸ºç©ºï¼Œå¸¸ç”¨äºæ£€æŸ¥ç©ºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>@NotEmpty</td>
<td>ä¸èƒ½ä¸ºç©ºï¼Œå¤šç”¨äºæ£€æµ‹listæ˜¯å¦sizeæ˜¯0</td>
</tr>
<tr>
<td>@Max</td>
<td>è¯¥å­—æ®µçš„å€¼åªèƒ½å°äºæˆ–ç­‰äºè¯¥å€¼</td>
</tr>
<tr>
<td>@Min</td>
<td>è¯¥å­—æ®µçš„å€¼åªèƒ½å¤§äºæˆ–ç­‰äºè¯¥å€¼</td>
</tr>
<tr>
<td>@Past</td>
<td>æ£€æŸ¥è¯¥å­—æ®µçš„æ—¥æœŸæ˜¯åœ¨è¿‡å»</td>
</tr>
<tr>
<td>@Future</td>
<td>æ£€æŸ¥è¯¥å­—æ®µçš„æ—¥æœŸæ˜¯å¦æ˜¯å±äºå°†æ¥çš„æ—¥æœŸ</td>
</tr>
<tr>
<td>@Email</td>
<td>æ£€æŸ¥æ˜¯å¦æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„emailåœ°å€</td>
</tr>
<tr>
<td>@Pattern(regex=,flag=)</td>
<td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td>
</tr>
<tr>
<td>@Range(min=,max=,message=)</td>
<td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»åœ¨åˆé€‚çš„èŒƒå›´å†…</td>
</tr>
<tr>
<td>@Size(min=, max=)</td>
<td>æ£€æŸ¥è¯¥å­—æ®µçš„sizeæ˜¯å¦åœ¨minå’Œmaxä¹‹é—´ï¼Œå¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æ•°ç»„ã€é›†åˆã€Mapç­‰</td>
</tr>
<tr>
<td>@Length(min=,max=)</td>
<td>æ£€æŸ¥æ‰€å±çš„å­—æ®µçš„é•¿åº¦æ˜¯å¦åœ¨minå’Œmaxä¹‹é—´,åªèƒ½ç”¨äºå­—ç¬¦ä¸²</td>
</tr>
<tr>
<td>@AssertTrue</td>
<td>ç”¨äºbooleanå­—æ®µï¼Œè¯¥å­—æ®µåªèƒ½ä¸ºtrue</td>
</tr>
<tr>
<td>@AssertFalse</td>
<td>è¯¥å­—æ®µçš„å€¼åªèƒ½ä¸ºfalse</td>
</tr>
</tbody>
</table>
<h3 id="1pomxml">1.pom.xml<a hidden class="anchor" aria-hidden="true" href="#1pomxml">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!-- è‡ªå®šä¹‰éªŒè¯æ³¨è§£ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-validation<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="2æ ¡éªŒæ³¨è§£">2.æ ¡éªŒæ³¨è§£<a hidden class="anchor" aria-hidden="true" href="#2æ ¡éªŒæ³¨è§£">#</a></h3>
<p>1.åœ¨<code>controller</code>ä¸Šå£°æ˜<code>@Validated</code>éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/args&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">argsTest</span><span class="o">(</span><span class="nd">@Validated</span> <span class="nd">@RequestBody</span> <span class="n">SysUser</span> <span class="n">sysUser</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s">&#34;success&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2.åœ¨å¯¹åº”å­—æ®µ<code>Getæ–¹æ³•</code>åŠ ä¸Šå‚æ•°æ ¡éªŒæ³¨è§£ï¼Œå¦‚æœä¸ç¬¦åˆéªŒè¯è¦æ±‚ï¼Œåˆ™ä¼šä»¥<code>message</code>çš„ä¿¡æ¯ä¸ºå‡†ï¼Œè¿”å›ç»™å‰ç«¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SysUser</span> <span class="kd">extends</span> <span class="n">BaseEntity</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="o">...</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// @Xss(message = &#34;ç”¨æˆ·è´¦å·ä¸èƒ½åŒ…å«è„šæœ¬å­—ç¬¦&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@NotBlank</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">&#34;ç”¨æˆ·è´¦å·ä¸èƒ½ä¸ºç©º&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">30</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;ç”¨æˆ·è´¦å·é•¿åº¦ä¸èƒ½è¶…è¿‡30ä¸ªå­—ç¬¦&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getUserName</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">userName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUserName</span><span class="o">(</span><span class="n">String</span> <span class="n">userName</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">userName</span> <span class="o">=</span> <span class="n">userName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Email</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">&#34;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">50</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;é‚®ç®±é•¿åº¦ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getEmail</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">email</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmail</span><span class="o">(</span><span class="n">String</span> <span class="n">email</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">email</span> <span class="o">=</span> <span class="n">email</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">11</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;æ‰‹æœºå·ç é•¿åº¦ä¸èƒ½è¶…è¿‡11ä¸ªå­—ç¬¦&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPhonenumber</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">phonenumber</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>ä¹Ÿå¯ä»¥ç›´æ¥æ”¾åœ¨å­—æ®µä¸Šé¢å£°æ˜ã€‚</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">30</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;ç”¨æˆ·æ˜µç§°é•¿åº¦ä¸èƒ½è¶…è¿‡30ä¸ªå­—ç¬¦&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="n">nickName</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></blockquote>
<h3 id="3å¼‚å¸¸æ•è·">3.å¼‚å¸¸æ•è·<a hidden class="anchor" aria-hidden="true" href="#3å¼‚å¸¸æ•è·">#</a></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * è‡ªå®šä¹‰éªŒè¯å¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">BindException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleBindException</span><span class="o">(</span><span class="n">BindException</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// log.error(e.getMessage(), e);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// String message = e.getAllErrors().get(0).getDefaultMessage();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// return ApiResponse.error(message);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">ApiResponse</span> <span class="n">apiResponse</span> <span class="o">=</span> <span class="n">handleBindingResult</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ], å‘ç”Ÿå‚æ•°æ ¡éªŒå¼‚å¸¸ &#39;BindException&#39; : {}&#34;</span><span class="o">,</span> <span class="n">requestURI</span> <span class="o">,</span> <span class="n">apiResponse</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">apiResponse</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * è‡ªå®šä¹‰éªŒè¯å¼‚å¸¸ å‚æ•°æ ¡éªŒå¼‚å¸¸å¤„ç†
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">MethodArgumentNotValidException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Object</span> <span class="nf">handleMethodArgumentNotValidException</span><span class="o">(</span><span class="n">MethodArgumentNotValidException</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// log.error(e.getMessage(), e);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// String message = e.getBindingResult().getFieldError().getDefaultMessage();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// return ApiResponse.error(message);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">ApiResponse</span> <span class="n">apiResponse</span> <span class="o">=</span> <span class="n">handleBindingResult</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getBindingResult</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ], å‘ç”Ÿå‚æ•°æ ¡éªŒå¼‚å¸¸ &#39;MethodArgumentNotValidException&#39; : {}&#34;</span><span class="o">,</span> <span class="n">requestURI</span> <span class="o">,</span> <span class="n">apiResponse</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">apiResponse</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * å¤„ç†å‚æ•°æ ¡éªŒå¼‚å¸¸ä¿¡æ¯
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param result
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @return
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">ApiResponse</span> <span class="nf">handleBindingResult</span><span class="o">(</span><span class="n">BindingResult</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">errorList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">hasErrors</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">FieldError</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="na">getFieldErrors</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="n">FieldError</span> <span class="n">error</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;&lt;&#34;</span><span class="o">+</span> <span class="n">error</span><span class="o">.</span><span class="na">getField</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;&gt;æ ¡éªŒä¸é€šè¿‡ï¼š&#34;</span> <span class="o">+</span> <span class="n">error</span><span class="o">.</span><span class="na">getDefaultMessage</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">errorList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(</span><span class="n">errorList</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// A0002-å‚æ•°æ ¡éªŒå¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">getObjectName</span><span class="o">()+</span> <span class="s">&#34;:&#34;</span> <span class="o">+</span> <span class="n">errorList</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è‡ªå®šä¹‰æ³¨è§£æ ¡éªŒ">è‡ªå®šä¹‰æ³¨è§£æ ¡éªŒ<a hidden class="anchor" aria-hidden="true" href="#è‡ªå®šä¹‰æ³¨è§£æ ¡éªŒ">#</a></h3>
<p>1ã€æ–°å¢<code>Xss</code>æ³¨è§£ï¼Œè®¾ç½®è‡ªå®šä¹‰æ ¡éªŒå™¨<code>XssValidator.class</code></p>
<p>å…¶ä¸­çš„validatedByå±æ€§æŒ‡å®šäº†éœ€è¦è¿›è¡Œæ ¡éªŒçš„ç­–ç•¥ç±»é›†åˆï¼Œè¿™æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚XssValidator.classæ˜¯è‡ªå®šä¹‰çš„æ ¡éªŒå™¨ï¼Œå…·ä½“çš„é€»è¾‘ç”±è¿™ä¸ªæ ¡éªŒå™¨æ¥å®Œæˆã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * è‡ªå®šä¹‰xssæ ¡éªŒæ³¨è§£
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Retention</span><span class="o">(</span><span class="n">RetentionPolicy</span><span class="o">.</span><span class="na">RUNTIME</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Target</span><span class="o">(</span><span class="n">value</span> <span class="o">=</span> <span class="o">{</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">METHOD</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">FIELD</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">CONSTRUCTOR</span><span class="o">,</span> <span class="n">ElementType</span><span class="o">.</span><span class="na">PARAMETER</span> <span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Constraint</span><span class="o">(</span><span class="n">validatedBy</span> <span class="o">=</span> <span class="o">{</span> <span class="n">XssValidator</span><span class="o">.</span><span class="na">class</span> <span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nd">@interface</span> <span class="n">Xss</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="nf">message</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">default</span> <span class="s">&#34;ä¸å…è®¸ä»»ä½•è„šæœ¬è¿è¡Œ&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">groups</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Payload</span><span class="o">&gt;[]</span> <span class="nf">payload</span><span class="o">()</span> <span class="k">default</span> <span class="o">{};</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>2ã€è‡ªå®šä¹‰<code>Xss</code>æ ¡éªŒå™¨ï¼Œå®ç°<code>ConstraintValidator</code>æ¥å£ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * è‡ªå®šä¹‰xssæ ¡éªŒæ³¨è§£å®ç°
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XssValidator</span> <span class="kd">implements</span> <span class="n">ConstraintValidator</span><span class="o">&lt;</span><span class="n">Xss</span><span class="o">,</span> <span class="n">String</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">HTML_PATTERN</span> <span class="o">=</span> <span class="s">&#34;&lt;(\\S*?)[^&gt;]*&gt;.*?|&lt;.*? /&gt;&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isValid</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">,</span> <span class="n">ConstraintValidatorContext</span> <span class="n">constraintValidatorContext</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">!</span><span class="n">containsHtml</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">containsHtml</span><span class="o">(</span><span class="n">String</span> <span class="n">value</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Pattern</span> <span class="n">pattern</span> <span class="o">=</span> <span class="n">Pattern</span><span class="o">.</span><span class="na">compile</span><span class="o">(</span><span class="n">HTML_PATTERN</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Matcher</span> <span class="n">matcher</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="na">matcher</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">matcher</span><span class="o">.</span><span class="na">matches</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>3ã€å®ä½“ç±»ä½¿ç”¨è‡ªå®šä¹‰çš„<code>@Xss</code>æ³¨è§£</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Xss</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">&#34;ç™»å½•è´¦å·ä¸èƒ½åŒ…å«è„šæœ¬å­—ç¬¦&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@NotBlank</span><span class="o">(</span><span class="n">message</span> <span class="o">=</span> <span class="s">&#34;ç™»å½•è´¦å·ä¸èƒ½ä¸ºç©º&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Size</span><span class="o">(</span><span class="n">min</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">max</span> <span class="o">=</span> <span class="mi">30</span><span class="o">,</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&#34;ç™»å½•è´¦å·é•¿åº¦ä¸èƒ½è¶…è¿‡30ä¸ªå­—ç¬¦&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">getLoginName</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="n">loginName</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤æ—¶åœ¨å»ä¿å­˜ä¼šè¿›è¡ŒéªŒè¯ï¼Œå¦‚æœä¸ç¬¦åˆè§„åˆ™çš„å­—ç¬¦ï¼ˆä¾‹å¦‚<code>&lt;script&gt;alert(1);&lt;/script&gt;</code>ï¼‰ä¼šæç¤º<code>ç™»å½•è´¦å·ä¸èƒ½åŒ…å«è„šæœ¬å­—ç¬¦</code>ï¼Œä»£è¡¨é™åˆ¶æˆåŠŸã€‚</p>
<p>4ã€xssè¿‡æ»¤å™¨ ==TODO==</p>
<h3 id="é˜²é‡å¤æäº¤">é˜²é‡å¤æäº¤<a hidden class="anchor" aria-hidden="true" href="#é˜²é‡å¤æäº¤">#</a></h3>
<p><code>@RepeatSubmit</code></p>
<h2 id="èœå•æ§åˆ¶">èœå•æ§åˆ¶<a hidden class="anchor" aria-hidden="true" href="#èœå•æ§åˆ¶">#</a></h2>
<h3 id="æ•°æ®åº“">æ•°æ®åº“<a hidden class="anchor" aria-hidden="true" href="#æ•°æ®åº“">#</a></h3>
<h1 id="å¾®æœåŠ¡">å¾®æœåŠ¡<a hidden class="anchor" aria-hidden="true" href="#å¾®æœåŠ¡">#</a></h1>
<blockquote>
<p>å‚è€ƒè¿æ¥</p>
<p><a href="https://blog.csdn.net/weixin_38023579/article/details/81328524">springcloudæ•™ç¨‹ &ndash; 1.å¿«é€Ÿæ­å»ºå…¥é—¨çº§demo,çœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†</a></p>
</blockquote>
<p><strong>åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ç¨‹<code>lab-drive</code></strong></p>
<h2 id="1æ·»åŠ ä¾èµ–">1.æ·»åŠ ä¾èµ–<a hidden class="anchor" aria-hidden="true" href="#1æ·»åŠ ä¾èµ–">#</a></h2>
<p>çˆ¶çº§pomæ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;modules&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;module&gt;</span>lab-admin<span class="nt">&lt;/module&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;module&gt;</span>lab-common<span class="nt">&lt;/module&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;module&gt;</span>lab-drive<span class="nt">&lt;/module&gt;</span>    +++++
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/modules&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å­çº§pomæ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-logging<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- SpringBoot Webå®¹å™¨ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--ä»¥ä¸‹æ˜¯æ’é™¤çš„ç»„ä»¶--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--æ’é™¤é»˜è®¤è‡ªå¸¦çš„logç»„ä»¶--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-logging<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--log4j2æ—¥å¿—ç›¸å…³ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-log4j2<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- SpringBoot ymlé…ç½®æ–‡ä»¶ç¼–å†™æ™ºèƒ½æç¤º --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-boot-configuration-processor<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- pagehelper åˆ†é¡µæ’ä»¶ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>pagehelper-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--mysqlé©±åŠ¨ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- swagger3--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>io.springfox<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>springfox-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- é˜²æ­¢è¿›å…¥swaggeré¡µé¢æŠ¥ç±»å‹è½¬æ¢é”™è¯¯ï¼Œæ’é™¤3.0.0ä¸­çš„å¼•ç”¨ï¼Œæ‰‹åŠ¨å¢åŠ 1.6.2ç‰ˆæœ¬ --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>io.swagger<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>swagger-models<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>1.6.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!-- knife4j --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>com.github.xiaoymin<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>knife4j-spring-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>3.0.3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--é¡¹ç›®commoné€šç”¨å·¥å…·ç±» --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.opengms<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>lab-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>1.0.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--nacosæ³¨å†Œä¸­å¿ƒ--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-bootstrap<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--&lt;version&gt;3.1.0&lt;/version&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>2.1.1.RELEASE<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;fork&gt;</span>true<span class="nt">&lt;/fork&gt;</span> <span class="c">&lt;!-- å¦‚æœæ²¡æœ‰è¯¥é…ç½®ï¼Œdevtoolsä¸ä¼šç”Ÿæ•ˆ --&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;executions&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;execution&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="c">&lt;!--æ‰“æˆå¯æ‰§è¡Œçš„è¿è¡ŒåŒ…ï¼ˆ.jar .warï¼‰--&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;goals&gt;</span>
</span></span><span class="line"><span class="cl">                        <span class="nt">&lt;goal&gt;</span>repackage<span class="nt">&lt;/goal&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;/goals&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/execution&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/executions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>maven-war-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>3.1.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;failOnMissingWebXml&gt;</span>false<span class="nt">&lt;/failOnMissingWebXml&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;warName&gt;</span>${project.artifactId}<span class="nt">&lt;/warName&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;finalName&gt;</span>${project.artifactId}<span class="nt">&lt;/finalName&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/build&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>yaml</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># é¡¹ç›®ç›¸å…³é…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">container</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># åç§°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">OpenGMS-Lab-Container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># ç‰ˆæœ¬</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="m">1.0.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># ç‰ˆæƒå¹´ä»½</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">copyrightYear</span><span class="p">:</span><span class="w"> </span><span class="m">2022</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æ–‡ä»¶è·¯å¾„ ç¤ºä¾‹ï¼ˆ Windowsé…ç½®E:/opengms-lab/uploadPathï¼ŒLinuxé…ç½® /home/opengms-lab/uploadPathï¼‰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#  profile: E:/opengms-lab/uploadPath</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># å¼€å‘ç¯å¢ƒé…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æœåŠ¡å™¨çš„HTTPç«¯å£ï¼Œé»˜è®¤ä¸º8080(8888æ˜¯jupyteré»˜è®¤ç«¯å£)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8810</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">servlet</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">context-path</span><span class="p">:</span><span class="w"> </span><span class="l">/container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="l">dev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">datasource</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">lab_datasource</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">jdbc:mysql://127.0.0.1:3306/opengms_container?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true&amp;useSSL=false&amp;serverTimezone=Asia/Shanghai</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">driver-class-name</span><span class="p">:</span><span class="w"> </span><span class="l">com.mysql.cj.jdbc.Driver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="m">123456</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">nacos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">server-addr</span><span class="p">:</span><span class="w"> </span><span class="l">localhost:8848</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">discovery</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">application</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">lab-container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># Springboot2.6ä»¥åå°†SpringMVC é»˜è®¤è·¯å¾„åŒ¹é…ç­–ç•¥ä»AntPathMatcher æ›´æ”¹ä¸ºPathPatternParserï¼Œå¯¼è‡´å‡ºé”™</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mvc</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">pathmatch</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">matching-strategy</span><span class="p">:</span><span class="w"> </span><span class="l">ant_path_matcher</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># MyBatisé…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">mybatis</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æœç´¢æŒ‡å®šåŒ…åˆ«å</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">typeAliasesPackage</span><span class="p">:</span><span class="w"> </span><span class="l">org.opengms.**.entity.po</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># é…ç½®mapperçš„æ‰«æï¼Œæ‰¾åˆ°æ‰€æœ‰çš„mapper.xmlæ˜ å°„æ–‡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mapperLocations</span><span class="p">:</span><span class="w"> </span><span class="l">classpath*:mapper/**/*Mapper.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># åŠ è½½å…¨å±€çš„é…ç½®æ–‡ä»¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">configLocation</span><span class="p">:</span><span class="w"> </span><span class="l">classpath:mybatis/mybatis-config.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c"># Swaggeré…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">swagger</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># æ˜¯å¦å¼€å¯swagger</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># è¯·æ±‚å‰ç¼€</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pathMapping</span><span class="p">:</span><span class="w"> </span><span class="l">/container</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c">#socketé…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">socket</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="m">127.0.0.1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">6001</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="2é¡¹ç›®é…ç½®">2.é¡¹ç›®é…ç½®<a hidden class="anchor" aria-hidden="true" href="#2é¡¹ç›®é…ç½®">#</a></h2>
<h3 id="æ‹·è´é¡¹ç›®åŸºç¡€æ¡†æ¶æ–‡ä»¶åŠæ–‡ä»¶å¤¹">æ‹·è´é¡¹ç›®åŸºç¡€æ¡†æ¶æ–‡ä»¶åŠæ–‡ä»¶å¤¹<a hidden class="anchor" aria-hidden="true" href="#æ‹·è´é¡¹ç›®åŸºç¡€æ¡†æ¶æ–‡ä»¶åŠæ–‡ä»¶å¤¹">#</a></h3>
<p><code>entity</code>æ–‡ä»¶å¤¹ä¸­çš„<code>ApiResponse</code></p>
<p><code>constant</code>æ–‡ä»¶å¤¹</p>
<p><code>config</code>æ–‡ä»¶å¤¹ä¸­çš„<code>AppConfig</code></p>
<p><code>LabApplication</code></p>
<p><code>lombok.config</code></p>
<h3 id="çº¿ç¨‹è·¨åŸŸå…¨å±€å¼‚å¸¸é…ç½®">çº¿ç¨‹ã€è·¨åŸŸã€å…¨å±€å¼‚å¸¸é…ç½®<a hidden class="anchor" aria-hidden="true" href="#çº¿ç¨‹è·¨åŸŸå…¨å±€å¼‚å¸¸é…ç½®">#</a></h3>
<p><strong>çº¿ç¨‹é…ç½®</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableScheduling</span>  <span class="c1">//åŒæ­¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nd">@EnableAsync</span>  <span class="c1">//å¼‚æ­¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ScheduleConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">TaskExecutor</span> <span class="nf">taskExecutor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ThreadPoolTaskExecutor</span> <span class="n">executor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadPoolTaskExecutor</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®æ ¸å¿ƒçº¿ç¨‹æ•° æ ¸å¿ƒçº¿ç¨‹æ•°çº¿ç¨‹æ•°å®šä¹‰äº†æœ€å°å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setCorePoolSize</span><span class="o">(</span><span class="mi">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®æœ€å¤§çº¿ç¨‹æ•° å½“é˜Ÿåˆ—ä¸­å­˜æ”¾çš„ä»»åŠ¡è¾¾åˆ°é˜Ÿåˆ—å®¹é‡çš„æ—¶å€™ï¼Œå½“å‰å¯ä»¥åŒæ—¶è¿è¡Œçš„çº¿ç¨‹æ•°é‡å˜ä¸ºæœ€å¤§çº¿ç¨‹æ•°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setMaxPoolSize</span><span class="o">(</span><span class="mi">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®é˜Ÿåˆ—å®¹é‡ å½“æ–°ä»»åŠ¡æ¥çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­å½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°é‡æ˜¯å¦è¾¾åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œå¦‚æœè¾¾åˆ°çš„è¯ï¼Œä¿¡ä»»å°±ä¼šè¢«å­˜æ”¾åœ¨é˜Ÿåˆ—ä¸­
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setQueueCapacity</span><span class="o">(</span><span class="mi">200</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®çº¿ç¨‹æ´»è·ƒæ—¶é—´ï¼ˆç§’ï¼‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setKeepAliveSeconds</span><span class="o">(</span><span class="mi">60</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®é»˜è®¤çº¿ç¨‹åç§°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setThreadNamePrefix</span><span class="o">(</span><span class="s">&#34;AsyncThread-&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// è®¾ç½®æ‹’ç»ç­–ç•¥ å½“æœ€å¤§æ± è¢«å¡«æ»¡æ—¶ï¼Œæ­¤ç­–ç•¥ä¸ºæˆ‘ä»¬æä¾›å¯ä¼¸ç¼©é˜Ÿåˆ—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setRejectedExecutionHandler</span><span class="o">(</span><span class="k">new</span> <span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="na">CallerRunsPolicy</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ç­‰å¾…æ‰€æœ‰ä»»åŠ¡ç»“æŸåå†å…³é—­çº¿ç¨‹æ± 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">executor</span><span class="o">.</span><span class="na">setWaitForTasksToCompleteOnShutdown</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">executor</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>è·¨åŸŸé…ç½®</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WebConfig</span> <span class="kd">implements</span> <span class="n">WebMvcConfigurer</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//è§£å†³è·¨åŸŸé—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addCorsMappings</span><span class="o">(</span><span class="n">CorsRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">registry</span><span class="o">.</span><span class="na">addMapping</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">);</span> <span class="c1">//å…è®¸è¿œç«¯è®¿é—®çš„åŸŸå
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// .allowedOrigins(&#34;http://localhost:8099&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//å…è®¸è¯·æ±‚çš„æ–¹æ³•(&#34;POST&#34;, &#34;GET&#34;, &#34;PUT&#34;, &#34;OPTIONS&#34;, &#34;DELETE&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// .allowedMethods(&#34;*&#34;)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">//å…è®¸è¯·æ±‚å¤´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="c1">// .allowedHeaders(&#34;*&#34;);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//ç™»å½•è¯·æ±‚é—®é¢˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addInterceptors</span><span class="o">(</span><span class="n">InterceptorRegistry</span> <span class="n">registry</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * kn4j åœ¨æƒ³æ–‡æ¡£ç›¸å…³çš„èµ„æº  éœ€è¦æ”¾å¼€
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span><span class="o">[]</span>  <span class="n">swaggerPatterns</span> <span class="o">=</span>  <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/swagger-resources/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/webjars/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/v2/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/swagger-ui.html/**&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="s">&#34;/doc.html/**&#34;</span> <span class="o">};</span>
</span></span><span class="line"><span class="cl">        <span class="n">registry</span><span class="o">.</span><span class="na">addInterceptor</span><span class="o">(</span><span class="n">authenticationInterceptor</span><span class="o">())</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">excludePathPatterns</span><span class="o">(</span><span class="n">swaggerPatterns</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">                <span class="o">.</span><span class="na">addPathPatterns</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">);</span>    <span class="c1">// æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œé€šè¿‡åˆ¤æ–­æ˜¯å¦æœ‰ @LoginRequired æ³¨è§£ å†³å®šæ˜¯å¦éœ€è¦ç™»å½•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">AuthenticationInterceptor</span> <span class="nf">authenticationInterceptor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">AuthenticationInterceptor</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>å…¨å±€å¼‚å¸¸é…ç½®</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Slf4j</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RestControllerAdvice</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalExceptionHandler</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ä¸šåŠ¡å¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">ServiceException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleServiceException</span><span class="o">(</span><span class="n">ServiceException</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ],å‘ç”Ÿä¸šåŠ¡å¼‚å¸¸.&#34;</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Integer</span> <span class="n">code</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="na">getCode</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">StringUtils</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">(</span><span class="n">code</span><span class="o">)</span> <span class="o">?</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">code</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">())</span> <span class="o">:</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * æ‹¦æˆªæœªçŸ¥çš„è¿è¡Œæ—¶å¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">RuntimeException</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleRuntimeException</span><span class="o">(</span><span class="n">RuntimeException</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ],å‘ç”ŸæœªçŸ¥å¼‚å¸¸.&#34;</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">     * ç³»ç»Ÿå¼‚å¸¸
</span></span></span><span class="line"><span class="cl"><span class="cm">     */</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@ExceptionHandler</span><span class="o">(</span><span class="n">Exception</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">ApiResponse</span> <span class="nf">handleException</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">,</span> <span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">requestURI</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="na">getRequestURI</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">log</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="s">&#34;è¯·æ±‚åœ°å€[ {} ],å‘ç”Ÿç³»ç»Ÿå¼‚å¸¸.&#34;</span><span class="o">,</span> <span class="n">requestURI</span><span class="o">,</span> <span class="n">e</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">ApiResponse</span><span class="o">.</span><span class="na">error</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="æ—¥å¿—é…ç½®">æ—¥å¿—é…ç½®<a hidden class="anchor" aria-hidden="true" href="#æ—¥å¿—é…ç½®">#</a></h3>
<p>[è·³è½¬](#5. log4j2çš„é…ç½®æ–‡ä»¶)</p>
<h3 id="æ•´åˆmybatis">æ•´åˆmybatis<a hidden class="anchor" aria-hidden="true" href="#æ•´åˆmybatis">#</a></h3>
<p>[è·³è½¬](# 3. æ•´åˆmybatisç­‰åˆå§‹åŒ–é…ç½®)</p>
<h3 id="swaggeré›†æˆ-1">Swaggeré›†æˆ<a hidden class="anchor" aria-hidden="true" href="#swaggeré›†æˆ-1">#</a></h3>
<p>[Swagger](# Swaggeré›†æˆ)</p>
<p><a href="#4.%E9%9B%86%E6%88%90Knife4j">Knife4j</a></p>
<h2 id="3ä½¿ç”¨nacos">3.ä½¿ç”¨nacos<a hidden class="anchor" aria-hidden="true" href="#3ä½¿ç”¨nacos">#</a></h2>
<blockquote>
<p>ä½¿ç”¨springcloudçš„æ—¶å€™ç‰ˆæœ¬è¦å’Œspringbootç‰ˆæœ¬å…¼å®¹</p>
<p><a href="https://spring.io/projects/spring-cloud#overview">https://spring.io/projects/spring-cloud#overview</a></p>
<p><a href="https://blog.csdn.net/qq_38637558/article/details/114448690">https://blog.csdn.net/qq_38637558/article/details/114448690</a></p>
</blockquote>
<p><strong>springboot2.5.x é«˜ç‰ˆæœ¬æ•´åˆnacosæŠ¥é”™</strong></p>
<blockquote>
<p>2022-11-18 18:50:20.449 ERROR 37996 &mdash; [           main] o.s.b.SpringApplication                  : Application run failed</p>
<p>org.springframework.beans.factory.BeanCreationException: Error creating bean with name &lsquo;configurationPropertiesBeans&rsquo; defined in class path resource [org/springframework/cloud/autoconfigure/ConfigurationPropertiesRebinderAutoConfiguration.class]: Post-processing of merged bean definition failed; nested exception is java.lang.IllegalStateException: Failed to introspect Class [org.springframework.cloud.context.properties.ConfigurationPropertiesBeans] from ClassLoader [sun.misc.Launcher$AppClassLoader@18b4aac2]</p>
</blockquote>
<blockquote>
<p>å‚è€ƒé“¾æ¥</p>
<p><a href="https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E">https://github.com/alibaba/spring-cloud-alibaba/wiki/%E7%89%88%E6%9C%AC%E8%AF%B4%E6%98%8E</a></p>
</blockquote>
<p><strong>å®‰è£…nacoså¹¶å¯åŠ¨</strong></p>
<p><img loading="lazy" src="https://blog-images-1301988137.cos.ap-nanjing.myqcloud.com/blog/2207/202307252348833.png" alt="image-20221118184945756"  />
</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-powershell" data-lang="powershell"><span class="line"><span class="cl"><span class="n">startup</span><span class="p">.</span><span class="py">cmd</span> <span class="n">-m</span> <span class="n">standalone</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>é¡¹ç›®é…ç½®nacos</strong></p>
<p>åœ¨çˆ¶å·¥ç¨‹çš„pomæ–‡ä»¶ä¸­çš„<code>&lt;dependencyManagement&gt;</code>ä¸­å¼•å…¥SpringCloudAlibabaçš„ä¾èµ–ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;spring-boot.version&gt;</span>2.6.7<span class="nt">&lt;/spring-boot.version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;spring-cloud.version&gt;</span>2021.0.4<span class="nt">&lt;/spring-cloud.version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;spring-cloud-alibaba.version&gt;</span>2021.0.4.0<span class="nt">&lt;/spring-cloud-alibaba.version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- ä¾èµ–å£°æ˜ --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- SpringBootçš„ä¾èµ–é…ç½®--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="c">&lt;!--&lt;version&gt;2.5.14&lt;/version&gt;--&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>${spring-boot.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!-- springCloud --&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>${spring-cloud.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="c">&lt;!--nacosæ³¨å†Œä¸­å¿ƒ--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-alibaba-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>${spring-cloud-alibaba.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencyManagement&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶ååœ¨å„å¾®æœåŠ¡çš„pomæ–‡ä»¶ä¸­å¼•å…¥nacos-discoveryä¾èµ–ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å„å¾®æœåŠ¡ymlé…ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">nacos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">server-addr</span><span class="p">:</span><span class="w"> </span><span class="l">localhost:8848</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">application</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">lab-drive</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨ï¼šå¦‚æœä¸æƒ³ä½¿ç”¨nacosä½œä¸ºæœåŠ¡æ³¨å†Œå’Œå‘ç°çš„è¯ï¼Œè®¾ç½® <code>spring.cloud.nacos.discovery.enabled</code> ä¸ºfalse</p>
</blockquote>
<h2 id="4ä½¿ç”¨feign">4.ä½¿ç”¨feign<a hidden class="anchor" aria-hidden="true" href="#4ä½¿ç”¨feign">#</a></h2>
<p>æ·»åŠ pomä¾èµ–</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="c">&lt;!--feignè¿œç¨‹è°ƒç”¨--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--httpClientçš„ä¾èµ– --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>io.github.openfeign<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>feign-httpclient<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--é˜²æ­¢å‡ºç°æ‰¾ä¸åˆ°hostnameçš„å¼‚å¸¸--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>spring-cloud-loadbalancer<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--ä½¿ç”¨é«˜ç‰ˆæœ¬çš„speingcloudä¹‹åï¼Œspringæƒ³è¦ç”¨loadBalanceræ›¿æ¢æ‰ribbon,å¯åŠ¨çš„æ—¶å€™ä¼šæœ‰è­¦å‘Š--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.github.ben-manes.caffeine<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>caffeine<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>2.8.8<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p><a href="https://blog.csdn.net/JGMa_TiMo/article/details/121971430">https://blog.csdn.net/JGMa_TiMo/article/details/121971430</a></p>
</blockquote>
<p>é…ç½®yml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c">#feigné…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">feign</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">client</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="c"># defaultå…¨å±€çš„é…ç½®</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">loggerLevel</span><span class="p">:</span><span class="w"> </span><span class="l">BASIC</span><span class="w"> </span><span class="c"># æ—¥å¿—çº§åˆ«ï¼ŒBASICå°±æ˜¯åŸºæœ¬çš„è¯·æ±‚å’Œå“åº”ä¿¡æ¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">httpclient</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c"># å¼€å¯feignå¯¹HttpClientçš„æ”¯æŒ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">max-connections</span><span class="p">:</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="c"># æœ€å¤§çš„è¿æ¥æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">max-connections-per-route</span><span class="p">:</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="c"># æ¯ä¸ªè·¯å¾„çš„æœ€å¤§è¿æ¥æ•°</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æ·»åŠ <code>@EnableFeignClients</code>æ³¨è§£</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableFeignClients</span><span class="o">(</span><span class="n">basePackages</span> <span class="o">=</span> <span class="s">&#34;org.opengms.admin.clients&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ApplicationConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç¼–å†™client</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@FeignClient</span><span class="o">(</span><span class="s">&#34;lab-container&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ContainerClient</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">CONTEXT_PATH</span> <span class="o">=</span> <span class="s">&#34;/container&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">CONTEXT_PATH</span> <span class="o">+</span> <span class="s">&#34;/container/list/image&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ApiResponse</span> <span class="nf">listImages</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¸é€šè¿‡æ³¨å†Œä¸­å¿ƒä½¿ç”¨feign</strong></p>
<p>è®¾ç½®yml</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">discovery</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>client</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@FeignClient</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#34;lab-container&#34;</span><span class="o">,</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&#34;localhost:8810/container&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">ContainerClient</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">CONTEXT_PATH</span> <span class="o">=</span> <span class="s">&#34;&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@GetMapping</span><span class="o">(</span><span class="n">CONTEXT_PATH</span> <span class="o">+</span> <span class="s">&#34;/container/list/image&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">ApiResponse</span> <span class="nf">listImages</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>nameï¼šæœåŠ¡åç§° ï¼ˆæ³¨ï¼šè‹¥ä½¿ç”¨æ³¨å†Œä¸­å¿ƒï¼Œæ­¤å¤„åº”è¯¥å†™ç”Ÿäº§è€…æœåŠ¡åç§°ï¼‰
urlï¼šç”Ÿäº§è€…çš„urlåœ°å€</p>
</blockquote>


  </div>

  <footer class="post-footer">
    
<nav class="paginav">
  <a class="prev" href="https://chance7bin.github.io/posts/note/linux%E6%89%8B%E5%86%8C/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>Linuxæ‰‹å†Œ</span>
  </a>
  <a class="next" href="https://chance7bin.github.io/posts/note/%E8%BD%AF%E8%80%83-%E7%A8%8B%E5%BA%8F%E5%91%98/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>è½¯è€ƒ ç¨‹åºå‘˜</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://chance7bin.github.io/">Binb&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'å¤åˆ¶';

        function copyingDone() {
            copybutton.innerHTML = 'å·²å¤åˆ¶ï¼';
            setTimeout(() => {
                copybutton.innerHTML = 'å¤åˆ¶';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
